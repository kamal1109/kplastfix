(window.webpackJsonp=window.webpackJsonp||[]).push([[291],{"+NLP":function(e,t,r){e.exports=r.p+"b13ec7aca79fd7f2b726ad816d885801.svg"},"/KDZ":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var o=r("q1tI");class i extends o.PureComponent{constructor(e){super(e),this._handleChange=()=>{this.forceUpdate()},this.state={query:window.matchMedia(this.props.rule)}}componentDidMount(){this._subscribe(this.state.query)}componentDidUpdate(e,t){this.state.query!==t.query&&(this._unsubscribe(t.query),this._subscribe(this.state.query))}componentWillUnmount(){this._unsubscribe(this.state.query)}render(){return this.props.children(this.state.query.matches)}static getDerivedStateFromProps(e,t){return e.rule!==t.query.media?{query:window.matchMedia(e.rule)}:null}_subscribe(e){e.addListener(this._handleChange)}_unsubscribe(e){e.removeListener(this._handleChange)}}},"/nxI":function(e,t,r){e.exports=r.p+"b7bc76dad53df6ae375bf6ac8c169de8.svg"},"/tfs":function(e,t,r){e.exports=r.p+"e07fd740fef3bb6924d5bb3e3f707d66.svg"},"0BCs":function(e,t,r){e.exports=r.p+"af770f2b86bdea4723c94b7f1c2fb7ce.svg"},"1+PV":function(e,t,r){e.exports=r.p+"ed16dcf33944c296e902b1a74215758b.svg"},"1O6C":function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var o=r("q1tI"),i=r("TSYQ"),s=r("+EG+"),n=r("jAh7"),a=r("ijHL"),c=r("aYmi");class l extends o.PureComponent{constructor(){super(...arguments),this._manager=new n.OverlapManager,this._handleSlot=e=>{this._manager.setContainer(e)}}render(){const{rounded:e=!0,shadowed:t=!0,fullscreen:r=!1,darker:n=!1,className:l,backdrop:u}=this.props,d=i(l,c.dialog,e&&c.rounded,t&&c.shadowed,r&&c.fullscreen,n&&c.darker),p=Object(a.b)(this.props),h=this.props.style?Object.assign(Object.assign({},this._createStyles()),this.props.style):this._createStyles();return o.createElement(o.Fragment,null,o.createElement(s.b.Provider,{value:this._manager},u&&o.createElement("div",{onClick:this.props.onClickBackdrop,className:c.backdrop}),o.createElement("div",Object.assign({},p,{className:d,style:h,ref:this.props.reference,onFocus:this.props.onFocus,onMouseDown:this.props.onMouseDown,onMouseUp:this.props.onMouseUp,onClick:this.props.onClick,onKeyDown:this.props.onKeyDown,tabIndex:-1}),this.props.children)),o.createElement(s.a,{reference:this._handleSlot}))}_createStyles(){const{bottom:e,left:t,width:r,right:o,top:i,zIndex:s,height:n}=this.props;return{bottom:e,left:t,right:o,top:i,zIndex:s,maxWidth:r,height:n}}}},"1rjR":function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));r("HbRj");var o=r("YFKU"),i=r("VBos");const s={get(){return this},open:e=>Object(i.a)({title:Object(o.t)("Cancel order"),text:Object(o.t)("Are you sure you want to cancel order {orderId}?").replace("{orderId}",e),mainButtonIntent:"primary"}),multiple(e,t,r){let s=e;if(void 0!==t){s=`${s} ${1===t?Object(o.t)("BUY"):Object(o.t)("SELL")}`}return Object(i.a)({title:Object(o.t)("Cancel order"),text:Object(o.t)("Are you sure you want to cancel {qty} {side} orders?").replace("{qty}",String(r)).replace("{side}",s),mainButtonIntent:"primary"})}}},
"3tcu":function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var o=r("YFKU"),i=r("fZEr");const s={show(e){Object(i.showWarning)({title:Object(o.t)("{name} maintenance").replace("{name}",e),text:Object(o.t)("We are doing some brief daily maintenance. {name} will be back really soon, thanks for your patience!").replace("{name}",e)})}}},"4qhP":function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"e",(function(){return a})),r.d(t,"b",(function(){return u})),r.d(t,"h",(function(){return p})),r.d(t,"d",(function(){return h})),r.d(t,"c",(function(){return b})),r.d(t,"i",(function(){return f})),r.d(t,"g",(function(){return m})),r.d(t,"j",(function(){return g})),r.d(t,"k",(function(){return _})),r.d(t,"f",(function(){return k}));var o=r("Eyy1"),i=r("7KDR"),s=r("0W4x");r.d(t,"l",(function(){return s.orderStatusToText}));const n="js-bottom-trading-tab";function a(e){const t=[],r=e.filter(e=>e.brokerPlan&&!e.brokerPlan.hidden&&e.brokerPlan.slug_name),o=l(r);return t.push(...r.map(e=>e.brokerPlan&&e.brokerPlan.slug_name).filter(e=>void 0!==e)),t.splice(o+1,0,...c),t}const c=["Paper"];function l(e){return e.findIndex(e=>e.brokerPlan&&!e.brokerPlan.hidden&&e.brokerPlan.flags&&e.brokerPlan.flags.includes("featured"))}function u(e,t){const r=e.map(e=>e.id),o=t.map(e=>e.slug_name),i=t.filter(e=>r.includes(e.slug_name)).map(t=>({metainfo:d(e,t.slug_name),brokerPlan:t})),s=e.filter(e=>!o.includes(e.id)&&!c.includes(e.id)).map(e=>({metainfo:e})),n=l(i),a=c.map(t=>({metainfo:d(e,t)}));return a.length>0&&i.splice(n+1,0,...a),[...i,...s]}function d(e,t){return Object(o.ensureDefined)(e.find(e=>e.id.toLowerCase()===t.toLowerCase()))}function p(e){return void 0!==e&&["oauth","oauth2-implicit-flow","oauth2-code-flow"].includes(e)}function h(e,t){const r=Object(s.sideToText)(e.side)+" "+e.qty+" @ "+t.format(e.price);return r.substr(0,1).toUpperCase()+r.substr(1).toLowerCase()}function b(e){return e?e.map(e=>"-"===e.text||e.separator?new i.Separator:new i.Action({name:e.name,checkable:e.checkable,checked:e.checked,disabled:void 0!==e.enabled&&!e.enabled,shortcut:e.shortcut,label:e.text,statName:e.statName,icon:e.icon,onExecute:t=>{e.action({checkable:t.isCheckable(),checked:t.isChecked(),enabled:!t.isDisabled(),text:t.getLabel().toString()})}})):[]}function f(e){return 6===e||3===e}function m(e,t){if(void 0!==t&&t.length>0){const r=t.find(t=>"default"in t&&(void 0===t.supportedOrderTypes||t.supportedOrderTypes.includes(e)))||t.find(t=>t.supportedOrderTypes&&t.supportedOrderTypes.includes(e));return r?{type:r.value}:void 0}}function g(e){return(e+"-brokers-side-maintenance").toLowerCase()}function _(e){return(e+"-maintenance").toLowerCase()}function k(e,t,r){if("crypto"===e.type)return e.currency||"";return!r&&t.currencySign||t.currency||e.currency||""}},"5det":function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var o=r("YFKU"),i=r("8Lsi"),s=r("cJM1");async function n(e,t,n,a,c){const l=new s.a,u=Object(i.a)(t);if(c&&void 0!==u&&l.has(u))return!0
;const{ConfirmDialogRenderer:d}=await Promise.all([r.e("vendors"),r.e(0),r.e(2),r.e(6),r.e(7),r.e(9),r.e(11),r.e(12),r.e(13),r.e(15),r.e(22),r.e(28),r.e(71),r.e(216),r.e(286),r.e(416),r.e(531),r.e(8),r.e(10),r.e(188),r.e(330),r.e("create-confirm-dialog")]).then(r.bind(null,"4Qqi")),p=new d(l),h={title:e,message:t,closeButton:null!=a?a:Object(o.t)("No"),confirmButton:null!=n?n:Object(o.t)("Yes"),showDisableConfirmationsCheckbox:c};return(await p.open(h)).status}},"66eg":function(e,t,r){e.exports=r.p+"eb51bb645b91d33e6eb1f37c7b20cc94.svg"},"6KyJ":function(e,t,r){"use strict";var o,i=r("q1tI"),s=r("TSYQ"),n=r("K9GE"),a=r("YZ9j");r("O7m7");!function(e){e[e.Initial=0]="Initial",e[e.Appear=1]="Appear",e[e.Active=2]="Active"}(o||(o={}));class c extends i.PureComponent{constructor(e){super(e),this._stateChangeTimeout=null,this.state={state:o.Initial}}render(){const{className:e,color:t="black"}=this.props,r=s(a.item,{[a[t]]:Boolean(t)});return i.createElement("span",{className:s(a.loader,e,this._getStateClass())},i.createElement("span",{className:r}),i.createElement("span",{className:r}),i.createElement("span",{className:r}))}componentDidMount(){this.setState({state:o.Appear}),this._stateChangeTimeout=setTimeout(()=>{this.setState({state:o.Active})},2*n.c)}componentWillUnmount(){this._stateChangeTimeout&&(clearTimeout(this._stateChangeTimeout),this._stateChangeTimeout=null)}_getStateClass(){switch(this.state.state){case o.Initial:return a["loader-initial"];case o.Appear:return a["loader-appear"];default:return""}}}r.d(t,"a",(function(){return c}))},"7iEp":function(e,t,r){e.exports=r.p+"0716de85ffaf9a87610e3cb704fb03ea.svg"},"8ESU":function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return d}));var o=r("wVAQ"),i=r("CLNU"),s=r("txPx"),n=r("5kf6"),a=r("+GxX");const c=Object(s.getLogger)("Trading.AccountVerifier");function l(e,t){return e.hasOwnProperty(t)&&e[t].hasOwnProperty("message")?e[t].message:""}async function u(e,t){let r,s=!1;if(0===Object.keys(t).length)return c.logWarn("Realtime data check skipped: credentials not supplied."),!1;const u={broker_id:e,version:2,params:t,new_broker_verifier:Object(a.isFeatureEnabled)("new-broker-verifier")},d={headers:{"Content-Type":"application/json"},method:"POST",credentials:"include",body:JSON.stringify(u)};try{const e=await Object(n.a)(Object(o.fetch)("/trading/check-realtime/",d),3e4,"Timeout during check realtime has occurred."),t=await e.json();let i="fail",u="";const p=t.hasOwnProperty("get_permissions")?t.get_permissions.status:"fail";let h=l(t,"check_credentials"),b=l(t,"get_permissions");if(r=t.hasOwnProperty("new_broker_verifier")?t.new_broker_verifier:Object(a.isFeatureEnabled)("new-broker-verifier"),t.hasOwnProperty("check_credentials")&&(i=t.check_credentials.status,u=void 0!==t.check_credentials.exchanges?"Exchanges: "+t.check_credentials.exchanges.join(", "):""),"ok"===i)s=!0,h="realtime data is enabled for the user. "+u;else if("no_exchanges"===i)s=!1,h="failed to enable realtime data for the user - exchange list is empty.";else{
if("skip"!==i)throw new Error(h);h="skip enable realtime data for the user - was already enabled."}c.logInfo("Realtime data check: "+h),"ok"===p&&(s=!0,b="permissions applied for the user."),c.logInfo("Get user permissions: "+b)}catch(h){c.logError("Realtime data check failed: "+Object(i.clean)(Object(i.stripTags)(h.message))),void 0===r&&(r=Object(a.isFeatureEnabled)("new-broker-verifier"))}const p=`For Check Realtime was used a ${r?"new":"old"} broker verifier.`;return c.logInfo(p),s}async function d(e){const t=e.metainfo().id;try{const r=e.getVerifyLiveAccountParams();if(0===Object.keys(r).length)throw new Error("Credentials not supplied");if(r.hasOwnProperty("broker_id"))throw new Error("Parameters should not contain broker identifier");const i=Object.assign({broker_id:t},r),s={method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)},a=await Object(n.a)(Object(o.fetch)("/api/v1/brokers/verify-account/",s),3e4,"Timeout during verifying account.");if(!a.ok)throw new Error("Response is not ok");const l=await a.json();if("ok"!==l.status)throw new Error(l.detail);c.logInfo("Account verified: "+JSON.stringify(l))}catch(r){throw c.logError(`Account verification for broker ${t} failed: ${Object(i.clean)(Object(i.stripTags)("object"==typeof r?r.message:r))}`),r}}},"8Lsi":function(e,t,r){"use strict";function o(e){return"string"==typeof e?e:Array.isArray(e)?e.join(""):void 0}r.d(t,"a",(function(){return o}))},"8Ycc":function(e,t,r){e.exports=r.p+"fcfaf359494de88fbe94ebbec4249db9.svg"},"8wgr":function(e,t,r){"use strict";r.r(t),r.d(t,"settingsKeys",(function(){return o}));const o={ACTIVE_BROKER:"trading.active_broker",FILTER_BROKER:"trading.filter_brokers_by_locale",PROPERTIES:"trading.chart.proterty",QTY:"trading.qty.",BROKERS_QTY:"trading.brokers.qty",PROFIT_VIEW_TYPE:"trading.dom.profitViewType",ORDER_WIDGET_MODE:"trading.orderWidgetMode.",TAKE_PROFIT:"trading.takeprofit.",STOP_LOSS:"trading.stoploss.",ORDER_DURATION:"trading.orderDuration.",DOM_DURATION:"trading.domDuration.",TRADING_PANEL_OPENED:"trading.tradingPanelOpened",TRADING_PANEL_ACTIVE_PAGE:"trading.tradingPanelActivePage",PANEL_WIDTH:"trading.panelWidth",PANEL_HEIGHT:"trading.panelHeight",ORDER_PANEL_SETTINGS:"trading.orderPanelSettings",FAVORITE_BROKERS:"trading.panelFavorite",REVIEW_DIALOG_WAS_SHOWED:"trading.reviewDialogShowedOnLogin",SHOW_TOOLTIP_FOR_SELECT_BROKER:"trading.showTooltipForSelectBroker",LOGIN_COUNTER:"trading.brokerLogInCounter",LOGOUT_COUNTER:"trading.brokerLogOutCounter",DISABLED_CONFIRMATIONS:"trading.disabledConfirmations"}},ASyk:function(e,t,r){e.exports={"tablet-normal-breakpoint":"screen and (max-width: 768px)","small-height-breakpoint":"screen and (max-height: 360px)","tablet-small-breakpoint":"screen and (max-width: 428px)"}},BR3a:function(e,t,r){e.exports=r.p+"9b2ba8a4ff3270bd58cd8f3d750ccb0a.svg"},C1Ba:function(e,t,r){e.exports=r.p+"f0f62df706d1b385148eebbfb4661228.svg"},C8sB:function(e,t,r){e.exports=r.p+"ad431aa793bb9b03ddbc298d3355d18f.svg"},C9TK:function(e,t,r){"use strict"
;r.d(t,"a",(function(){return s}));var o=r("YFKU"),i=r("VBos");async function s(e,t,r,s){if(!(await Object(i.a)({title:Object(o.t)("Reverse {positionId} position?").replace("{positionId}",e),text:Object(o.t)("Are you sure you want to reverse {positionId} position?").replace("{positionId}",e)+(s?" "+Object(o.t)("This will also close all active orders."):""),mainButtonText:Object(o.t)("Reverse position"),mainButtonIntent:"primary",cancelButtonText:Object(o.t)("Cancel")})))return!1;try{return await r()}catch(n){return t(Object(o.t)("Failed to reverse position"),function(e){let t="";null!==e&&"object"==typeof e&&e.message?t=e.message:"string"==typeof e&&(t=e);return t}(n)),!1}}},CMPx:function(e,t,r){e.exports=r.p+"e07fd740fef3bb6924d5bb3e3f707d66.svg"},E2A4:function(e,t,r){e.exports=r.p+"4b5c9cf914b84d65831f6e1094587c1d.svg"},E9hm:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return i}));const o={isSuspended:!1,supportDemoLiveSwitcher:!0,supportEditAmount:!0,supportMarketBrackets:!0,supportMarketOrders:!0,supportStopOrders:!0,supportLimitOrders:!0,supportStopLimitOrders:!1,supportPositions:!0,supportDOM:!0,supportModifyOrder:!0,supportModifyTrailingStop:!0,supportAddBracketsToExistingOrder:!0,supportVerifyLiveAccount:!0,supportReversePosition:!0,showNotificationsLog:!0,supportPLUpdate:!0,supportTwoFactorAuthorization:!1,supportDisplayBrokerNameInSymbolSearch:!0};function i(e){return Object.assign({},o,e)}},"Ed+0":function(e,t,r){e.exports=r.p+"5a7c3d536691f9fc1734739f0b34a75b.svg"},G40f:function(e,t,r){e.exports=r.p+"843b09bb5d9cd03ee69cc3fdba4e0c12.svg"},GomP:function(e,t,r){e.exports=r.p+"287cfd4e43daa72a2e48e35bfd6df2d9.svg"},HPYC:function(e,t,r){e.exports=r.p+"a96feec86c36f4de4094ff24c8e34e1f.svg"},HPdd:function(e,t,r){e.exports=r.p+"ad84bccf7328789ef316a3b49746f2a4.svg"},Hgre:function(e,t,r){"use strict";var o=r("3tcu"),i=r("+GxX"),s=r("iWVE"),n=r("YFKU"),a=r("Kxc7"),c=r("ogJP"),l=r("aIyQ"),u=r.n(l),d=r("Eyy1");class p{constructor(e){this._objects={},this._started=!1,this._isObjectsRequestActual=!1,this._ordersPromise=null,this._getter=e,this.updateDelegate=new u.a,this.partialUpdateDelegate=new u.a}start(){this._started||(this._started=!0,this._ordersPromise=this._requestObjects())}stop(){this._objects={},this._started=!1,this._ordersPromise=null,this._isObjectsRequestActual=!1}update(e,t){this._started&&(this._isObjectsRequestActual?this._isObjectsRequestActual=!1:(this._objects[e.id]=e,this._onObjectUpdated(e,t)))}partialUpdate(e,t){if(!this._started)return;if(this._isObjectsRequestActual)return void(this._isObjectsRequestActual=!1);let r,o;Object(c.isObject)(e)?(r=e.id,o=e):(r=e,o=Object(d.ensure)(t));const i=this._objects[r];i&&(Object.assign(i,o),this.partialUpdateDelegate.fire(i,o))}fullUpdate(){this._started&&(this._isObjectsRequestActual?this._isObjectsRequestActual=!1:this._ordersPromise=this._requestObjects())}getObjects(){return this._ordersPromise||Promise.resolve(Object.values(this._objects))}_onObjectUpdated(e,t){this.updateDelegate.fire(e,t)}
_onAllObjectsUpdated(){this._objectsCache().forEach(e=>this.updateDelegate.fire(e,!0))}_objectsCache(){return Object.values(this._objects)}async _requestObjects(){let e=[];do{this._isObjectsRequestActual=!0,e=await this._getter()}while(!this._isObjectsRequestActual);var t;return this._objects=(t="id",e.reduce((e,r)=>(e[r[t]]=r,e),{})),this._ordersPromise=null,this._isObjectsRequestActual=!1,this._onAllObjectsUpdated(),e}}var h=r("txPx"),b=r("5kf6");class f extends p{constructor(e,t){super(e),this._brokerConfigGetter=t}_onObjectUpdated(e,t){this._patchTrades(this._objectsCache().filter(t=>t.symbol===e.symbol&&0!==t.qty),e,t),super._onObjectUpdated(e,t)}_onAllObjectsUpdated(){this._patchTrades(this._objectsCache().filter(e=>0!==e.qty)),super._onAllObjectsUpdated()}_patchTrades(e,t,r){const o=this._brokerConfigGetter();let i;i=o.requiresFIFOCloseTrades?o.fifoOnlyForSameQty?_:g:m;const s=i(e);for(const n of s)t!==n&&super._onObjectUpdated(n,r)}}function m(e){const t=[];for(const r of e)r.canBeClosed||(r.canBeClosed=!0,t.push(r));return t}function g(e){const t={};for(const o of e){let e=t[o.symbol];void 0===e&&(e={oldest:null,all:[]},t[o.symbol]=e),(null===e.oldest||e.oldest.date>o.date)&&(e.oldest=o),e.all.push(o)}const r=[];for(const o of Object.keys(t)){const e=Object(d.ensureDefined)(t[o]);for(const t of e.all){const o=e.oldest===t,i=o!==t.canBeClosed;t.canBeClosed=o,i&&r.push(t)}}return r}function _(e){const t={};for(const o of e){let e=t[o.symbol];void 0===e&&(e={},t[o.symbol]=e);let r=e[o.qty];void 0===r&&(r={oldest:null,all:[]},e[o.qty]=r),(null===r.oldest||r.oldest.date>o.date)&&(r.oldest=o),r.all.push(o)}const r=[];for(const o of Object.keys(t)){const e=Object(d.ensureDefined)(t[o]);for(const t of Object.keys(e)){const o=Object(d.ensureDefined)(e[t]);for(const e of o.all){const t=o.oldest===e,i=t!==e.canBeClosed;e.canBeClosed=t,i&&r.push(e)}}}return r}const k=Object(h.getLogger)("Trading.Migrations");var O=r("0W4x"),v=r("25b6"),y=r("dOnf"),S=r("4qhP");function P(e,t){return{symbol:t.symbol,type:2,side:1===t.side?-1:1,qty:Math.abs(e),seenPrice:null,isClose:!0}}var C=r("/udZ");const w=Object(h.getLogger)("Trading.BrokerConnectionAdapter");function T(e){Object(d.assert)("object"!=typeof e,"Expected not an object")}function j(e,t){return e.type===t.type&&e.qty===t.qty&&e.limitPrice===t.limitPrice&&e.stopPrice===t.stopPrice&&e.takeProfit===t.takeProfit&&e.stopLoss===t.stopLoss&&e.trailingStopPips===t.trailingStopPips}class M{constructor(e,t,r,o,i,s){this.connectionStatusUpdate=new u.a,this.executionUpdate=new u.a,this.tradingOperationFinished=new u.a,this.currentAccountUpdate=new u.a,this._brokerPlan=null,this._subscriptions={},this._lastFireResult={},this._fakeDomeSubscriptions={},this._formattersCache={},this._spreadFormattersCache={},this._quantityFormattersCache={},this._tradesCache=null,this._fakePositionUpdateDelegate=null,this._realtimeSubscriptionState=[],this._loggedInManually=!1,this._pendingSubscriptions=[],this.config=Object.assign({},e.configFlags),this._brokerMetainfo=this._patchMetainfo(e),
this._brokerPlan=s||null,this._brokerConnection=t,this._host=r,this._tradingStat=i,this._brokerLogger=Object(h.getLogger)("Trading."+this._brokerMetainfo.id+".Connection"),r.setBrokerConnectionAdapter(this),this._initializeConnectProtection(),this._positionsCache=t.positions?new p(()=>t.positions?t.positions():Promise.resolve([])):null,this._tradesCache=t.trades?new f(()=>t.trades?t.trades():Promise.resolve([]),()=>this.config):null,this._ordersCache=new p(()=>t.orders());const n=e=>{1===e?(null!==this._positionsCache&&this._positionsCache.start(),this._ordersCache.start(),this._tradesCache&&this._tradesCache.start()):(null!==this._positionsCache&&this._positionsCache.stop(),this._ordersCache.stop(),this._tradesCache&&this._tradesCache.stop())};this.connectionStatusUpdate.subscribe(null,n),n(this.connectionStatus()),this._originalDOMESubscriptionMethods={subscribeDOME:t.subscribeDOME,unsubscribeDOME:t.unsubscribeDOME},this._patchBrokerSubscribeUnsubscribeDOMEMethods(),this.connectionStatusUpdate.subscribe(null,e=>{1===e&&this._patchBrokerSubscribeUnsubscribeDOMEMethods()}),e.configFlags.supportPositions||(this._fakePositionUpdateDelegate=new u.a),this._brokerRealtimeAdapter=o}tryRestoreSession(){if(this._brokerConnection.tryRestoreSession)return this._brokerConnection.tryRestoreSession()}get orderUpdate(){return this._ordersCache.updateDelegate}get positionUpdate(){return null===this._fakePositionUpdateDelegate?Object(d.ensure)(this._positionsCache).updateDelegate:this._fakePositionUpdateDelegate}get tradeUpdate(){return Object(d.ensure)(this._tradesCache).updateDelegate}get orderPartialUpdate(){return this._ordersCache.partialUpdateDelegate}get positionPartialUpdate(){return null===this._fakePositionUpdateDelegate?Object(d.ensure)(this._positionsCache).partialUpdateDelegate:this._fakePositionUpdateDelegate}get tradePartialUpdate(){return Object(d.ensure)(this._tradesCache).partialUpdateDelegate}onOrderUpdate(e){this._ordersCache.update(e)}onOrderPartialUpdate(e,t){this._ordersCache.partialUpdate(e,t)}onPositionUpdate(e,t){if(Object(d.assert)(!!this.config.supportPositions,"Broker doesn`t support positions"),0===e.qty){const t=this._lastFireResult[e.symbol];t&&delete t.PL}Object(d.ensure)(this._positionsCache).update(e,t)}onPositionPartialUpdate(e,t){Object(d.assert)(!!this.config.supportPositions,"Broker doesn`t support positions"),Object(d.ensure)(this._positionsCache).partialUpdate(e,t)}onTradeUpdate(e,t){if(Object(d.assert)(!!this.config.supportTrades,"Broker doesn`t support trades"),0===e.qty){const t=this._lastFireResult[e.symbol];t&&delete t.TradePL}Object(d.ensure)(this._tradesCache).update(e,t)}onTradePartialUpdate(e,t){Object(d.ensure)(this._tradesCache).partialUpdate(e,t)}onCurrentAccountChanged(){null!==this._positionsCache&&this._positionsCache.fullUpdate(),this._ordersCache.fullUpdate(),this._tradesCache&&this._tradesCache.fullUpdate();const e=this.currentAccount();this.currentAccountUpdate.fire(e)}patchConfig(e){var t
;!(t=e).hasOwnProperty("supportBrackets")||t.hasOwnProperty("supportOrderBrackets")||t.hasOwnProperty("supportPositionBrackets")||(k.logWarn("supportBrackets is deprecated. Use supportOrderBrackets and supportPositionBrackets instead."),t.supportOrderBrackets=t.supportBrackets,t.supportPositionBrackets=t.supportBrackets),Object.assign(this.config,e),Object.assign(this._brokerMetainfo.configFlags,e),this._brokerMetainfo=this._patchMetainfo(this._brokerMetainfo)}async getOrderDialogOptions(e){return void 0!==this._brokerConnection.getOrderDialogOptions?this._brokerConnection.getOrderDialogOptions(e):void 0}getPositionDialogOptions(){return void 0!==this._brokerConnection.getPositionDialogOptions?this._brokerConnection.getPositionDialogOptions():void 0}getValidationRules(e){return void 0!==this._brokerConnection.getValidationRules?this._brokerConnection.getValidationRules(e):void 0}chartContextMenuActions(e,t){return this._brokerConnection.chartContextMenuActions(e,t)}buttonDropdownActions(){return this._host.buttonDropdownActions()}connectionStatus(){return this._brokerConnection.connectionStatus()}isConnected(){return 1===this._brokerConnection.connectionStatus()}signIn(e,t,r,o){return this._brokerLogger.logNormal("Try to login with username: "+e),this._loggedInManually=!0,this._brokerConnection.signIn(e,t,r,o)}loggedInManually(){return this._loggedInManually}disconnect(e=!1){try{return this._brokerConnection.disconnect(e)}catch(t){w.logWarn("Failed to disconnect")}}currentAccount(){return this._brokerConnection.currentAccount?this._brokerConnection.currentAccount():""}currentAccountType(){return this._brokerConnection.currentAccountType?this._brokerConnection.currentAccountType():void 0}metainfo(){return this._brokerMetainfo}brokerPlan(){return this._brokerPlan}bro(){return this._brokerConnection}fireSubscription(e,t,r,o){if(void 0===this._lastFireResult[t]&&(this._lastFireResult[t]={Realtime:null,PL:null,Equity:null,DOME:null,TradePL:null,PipValue:null,MarginAvailable:null,CryptoBalance:null}),Object(d.ensure)(this._lastFireResult[t])[e]={data:r,time:Date.now()},void 0===this._subscriptions[t])return;const i=Object(d.ensure)(this._subscriptions[t]);Object(d.ensure)(i[e]).forEach(e=>e(t,r,o))}positions(e){return this.config.supportPositions?(this._makeSureBrokerIsConnected(),this._positions().then(t=>t.filter(t=>void 0===e||t.symbol===e))):Promise.resolve([])}disconnectWarningMessage(){return this._brokerConnection.disconnectWarningMessage?this._brokerConnection.disconnectWarningMessage():null}trades(e){return this._makeSureBrokerIsConnected(),Object(d.assert)(!!this.config.supportTrades,"Broker doesn`t support trades"),this._trades().then(t=>t.filter(t=>void 0===e||t.symbol===e))}positionById(e){return this._brokerConnection.positionById?this._brokerConnection.positionById(e):this.positions().then(t=>t.find(t=>t.id===e)).then(e=>e)}tradeById(e){return Object(d.assert)(!!this.config.supportTrades,"Broker doesn`t support trades"),this.trades().then(t=>t.find(t=>t.id===e))}orders(e){
return this._makeSureBrokerIsConnected(),this._orders().then(t=>t.filter(t=>void 0===e||t.symbol===e))}ordersHistory(){return this._makeSureBrokerIsConnected(),this.config.supportOrdersHistory&&this._brokerConnection.ordersHistory?this._brokerConnection.ordersHistory():Promise.resolve([])}async executions(e){return this.config.supportExecutions?(this._makeSureBrokerIsConnected(),this._brokerConnection.executions(e)):[]}orderById(e){return this._makeSureBrokerIsConnected(),this._brokerConnection.orders().then(t=>t.find(t=>t.id===e))}accountManagerInfo(){return this._brokerConnection.accountManagerInfo()}isTradable(e){return this._makeSureBrokerIsConnected(),this._brokerConnection.isTradable(e).then(t=>("object"!=typeof t&&(t={tradable:t}),t.tradable||void 0!==t.reason||(t.reason=Object(O.makeNonTradableSymbolText)(Object(v.htmlEscape)(e),this._brokerMetainfo.title)),t))}formatter(e,t=!0){return this._makeSureBrokerIsConnected(),this._formattersCache[e]||(this._formattersCache[e]=this._brokerConnection.formatter&&this._brokerConnection.formatter(e,t)||this._host.defaultFormatter(e,t)),Object(b.a)(this._formattersCache[e],1e4,"formatter not received")}spreadFormatter(e){return this._makeSureBrokerIsConnected(),this._spreadFormattersCache[e]||(this._spreadFormattersCache[e]=this._brokerConnection.spreadFormatter&&this._brokerConnection.spreadFormatter(e)||this._host.defaultFormatter(e,!1)),Object(b.a)(this._spreadFormattersCache[e],1e4,"spreadFormatter not received")}quantityFormatter(e){return this._makeSureBrokerIsConnected(),this._quantityFormattersCache[e]||(this._quantityFormattersCache[e]=this._brokerConnection.quantityFormatter&&this._brokerConnection.quantityFormatter(e)||this._host.quantityFormatter()),Object(b.a)(this._quantityFormattersCache[e],1e4,"quantityFormatter not received")}placeOrder(e,t){return this._isMaintenance()?(o.a.show(this._brokerMetainfo.title),Promise.resolve(!1)):this._isBrokerSideMaintenance()?(s.a.show(this._brokerMetainfo.title),Promise.resolve(!1)):(this._makeSureBrokerIsConnected(),this.processErrors(this._brokerConnection.placeOrder(e,t),!0,Object(n.t)("Order rejected"),()=>{Object(d.ensureNotNull)(this._tradingStat).trackOrderPlaced(e),this._host.trackEvent("","SilentMode",this._host.silentOrdersPlacement().value()?"On":"Off")}))}previewOrder(e){if(!this._brokerConnection.previewOrder)throw new Error("Order preview is not supported");return this._brokerConnection.previewOrder(e)}modifyOrder(e,t){return this._isMaintenance()?(o.a.show(this._brokerMetainfo.title),Promise.resolve(!1)):this._isBrokerSideMaintenance()?(s.a.show(this._brokerMetainfo.title),Promise.resolve(!1)):(this._makeSureBrokerIsConnected(),this.processErrors(this._brokerConnection.modifyOrder(e,t),!0,Object(n.t)("Failed to modify order")).then(t=>t&&this._waitForOrderModification(e)))}cancelOrder(e){return this._isMaintenance()?(o.a.show(this._brokerMetainfo.title),Promise.resolve(!1)):this._isBrokerSideMaintenance()?(s.a.show(this._brokerMetainfo.title),Promise.resolve(!1)):(T(e),this._makeSureBrokerIsConnected(),
this.processErrors(this._brokerConnection.cancelOrder(e),!0,Object(n.t)("Failed to cancel order")))}cancelOrders(e,t,r){return this._isMaintenance()?(o.a.show(this._brokerMetainfo.title),Promise.resolve(!1)):this._isBrokerSideMaintenance()?(s.a.show(this._brokerMetainfo.title),Promise.resolve(!1)):(this._makeSureBrokerIsConnected(),this.processErrors(this._brokerConnection.cancelOrders(e,t,r),!0,Object(n.t)("Failed to cancel one or more orders")))}async closePosition(e,t){if(this._isMaintenance())return o.a.show(this._brokerMetainfo.title),!1;if(this._isBrokerSideMaintenance())return s.a.show(this._brokerMetainfo.title),!1;T(e),this._makeSureBrokerIsConnected(),Object(d.assert)(void 0===t||!!this.config.supportPartialClosePosition,"Broker doesn`t support partial position closing");const r=Object(d.ensureDefined)(await this.positionById(e));if(0===r.qty)return this._host.showNotification(Object(n.t)("Failed to close the position"),Object(n.t)("The position you are trying to close has been already closed."),0),!1;if(void 0===t||t<=Math.abs(r.qty)){const o=P(null!=t?t:Math.abs(r.qty),r);return this.config.supportClosePosition&&this._brokerConnection.closePosition?this.processErrors(this._brokerConnection.closePosition(e,t),!0,Object(n.t)("Failed to close position"),()=>Object(d.ensureNotNull)(this._tradingStat).trackOrderPlaced(o)):this.processErrors(this._brokerConnection.placeOrder(o),!0,Object(n.t)("Failed to close position"),()=>Object(d.ensureNotNull)(this._tradingStat).trackOrderPlaced(o))}return this._host.showNotification(Object(n.t)("Failed to close the position"),Object(n.t)("The position you are trying to close has been changed."),0),!1}async closeTrade(e,t){var r;if(this._isMaintenance())return o.a.show(this._brokerMetainfo.title),Promise.resolve(!1);if(this._isBrokerSideMaintenance())return s.a.show(this._brokerMetainfo.title),Promise.resolve(!1);T(e),this._makeSureBrokerIsConnected(),Object(d.assert)(!!this.config.supportTrades,"Broker doesn`t support trades"),Object(d.assert)(void 0===t||null!==(r=this.config.supportPartialCloseTrade)&&void 0!==r&&r,"Broker doesn`t support partial position closing");const i=Object(d.ensureDefined)(await this.tradeById(e));if(0===i.qty)return this._host.showNotification(Object(n.t)("Failed to close the position"),Object(n.t)("The position you are trying to close has been already closed."),0),!1;if(void 0===t||t<=Math.abs(i.qty)){if(this._brokerConnection.closeTrade){const r=P(null!=t?t:Math.abs(i.qty),i);return this.processErrors(this._brokerConnection.closeTrade(e,t),!0,Object(n.t)("Failed to close position"),()=>Object(d.ensureNotNull)(this._tradingStat).trackOrderPlaced(r))}throw new Error("Method closeTrade is not implemented")}return this._host.showNotification(Object(n.t)("Failed to close the position"),Object(n.t)("The position you are trying to close has been changed."),0),!1}reversePosition(e){if(this._isMaintenance())return o.a.show(this._brokerMetainfo.title),Promise.resolve(!1);if(this._isBrokerSideMaintenance())return s.a.show(this._brokerMetainfo.title),
Promise.resolve(!1);if(T(e),this._makeSureBrokerIsConnected(),this.config.supportMultiposition&&!this.config.supportNativeReversePosition)throw new Error("Cannot reverse position on multiposition account");let t;const r=new Promise(r=>{var o;null===(o=this._positionsCache)||void 0===o||o.getObjects().then(o=>{var i;const s=Object.assign({},o.find(t=>t.id===e));if(0===Object.keys(s).length||0===s.qty)return this._brokerLogger.logError("Failed to reverse position: Position not found"),void r(!1);t=e=>{var o;e.symbol===s.symbol&&e.side!==s.side&&(null===(o=this._positionsCache)||void 0===o||o.updateDelegate.unsubscribe(this,t),r(!0))},null===(i=this._positionsCache)||void 0===i||i.updateDelegate.subscribe(this,t),this._reversePosition(e).then(e=>{var o;e||(null===(o=this._positionsCache)||void 0===o||o.updateDelegate.unsubscribe(this,t),r(!1))})})});return Object(b.a)(r,3e4,"Timeout").catch(e=>{var r;return this._brokerLogger.logError("Failed to reverse position: "+Object(C.c)(e)),null===(r=this._positionsCache)||void 0===r||r.updateDelegate.unsubscribe(this,t),!1})}editPositionBrackets(e,t,r){if(this._isMaintenance())return o.a.show(this._brokerMetainfo.title),Promise.resolve(!1);if(this._isBrokerSideMaintenance())return s.a.show(this._brokerMetainfo.title),Promise.resolve(!1);if(this._makeSureBrokerIsConnected(),this._brokerConnection.editPositionBrackets)return this.processErrors(this._brokerConnection.editPositionBrackets(e,t,r),!0,Object(n.t)("Failed to modify Stop Loss / Take Profit"));throw new Error("Method editPositionBrackets is not implemented")}editTradeBrackets(e,t){if(this._isMaintenance())return o.a.show(this._brokerMetainfo.title),Promise.resolve(!1);if(this._isBrokerSideMaintenance())return s.a.show(this._brokerMetainfo.title),Promise.resolve(!1);if(this._makeSureBrokerIsConnected(),Object(d.assert)(!!this.config.supportTradeBrackets,"Broker doesn`t support brackets on trades"),this._brokerConnection.editTradeBrackets)return this.processErrors(this._brokerConnection.editTradeBrackets(e,t),!0,Object(n.t)("Failed to modify Stop Loss / Take Profit"));throw new Error("Method editTradeBrackets is not implemented")}async subscribeRealtime(e,t){this._makeSureBrokerIsConnected();const r={symbol:e,listener:t,provider:0};this._realtimeSubscriptionState.push(r);const o=await this.symbolInfo(e),i=this._realtimeSubscriptionState.findIndex(r=>r.symbol===e&&r.listener===t);if(-1!==i)return void 0!==o.hasQuotes&&!1===o.hasQuotes?(this._realtimeSubscriptionState[i].provider=1,Object(d.ensure)(this._brokerRealtimeAdapter).subscribeRealtime(e,t)):(this._realtimeSubscriptionState[i].provider=2,this._addSubscription("Realtime",e,t))}quotesSnapshot(e){let t=null;return Object(b.a)(new Promise(r=>{const o=(e,i)=>{t=i,i&&(i.ask||i.bid)&&(this.unsubscribeRealtime(e,o),r(i))};this.subscribeRealtime(e,o)}),1e4,"quotesSnapshot not received").catch(e=>{if(null!==t)return t;throw e})}subscribeDOME(e,t){return this._makeSureBrokerIsConnected(),this._addSubscription("DOME",e,t)}subscribePipValue(e,t){
return this._makeSureBrokerIsConnected(),this._addSubscription("PipValue",e,t)}subscribePL(e,t){this._makeSureBrokerIsConnected(),this._addSubscription("PL",e,t)}subscribeTradePL(e,t){return this._makeSureBrokerIsConnected(),this._addSubscription("TradePL",e,t)}subscribeCryptoBalance(e,t){return this._makeSureBrokerIsConnected(),this._addSubscription("CryptoBalance",e,t)}subscribeEquity(e){return this._makeSureBrokerIsConnected(),this._addSubscription("Equity","Equity",e)}subscribeMarginAvailable(e){return this._makeSureBrokerIsConnected(),this._addSubscription("MarginAvailable","MarginAvailable",e)}unsubscribeRealtime(e,t){const r=this._realtimeSubscriptionState.findIndex(r=>r.symbol===e&&r.listener===t);-1!==r&&(1===this._realtimeSubscriptionState[r].provider?Object(d.ensure)(this._brokerRealtimeAdapter).unsubscribeRealtime(e,t):this._removeSubscription("Realtime",e,t),this._realtimeSubscriptionState.splice(r,1))}unsubscribeDOME(e,t){this._removeSubscription("DOME",e,t)}unsubscribePipValue(e,t){this._removeSubscription("PipValue",e,t)}unsubscribePL(e,t){this._removeSubscription("PL",e,t)}unsubscribeTradePL(e,t){this._removeSubscription("TradePL",e,t)}unsubscribeCryptoBalance(e,t){this._removeSubscription("CryptoBalance",e,t)}unsubscribeEquity(e){this._removeSubscription("Equity","Equity",e)}unsubscribeMarginAvailable(e){this._removeSubscription("MarginAvailable","MarginAvailable",e)}async accountMetainfo(){const e=await this.accountsMetainfo(),t=this.currentAccount(),r=e.find(e=>e.id===t);if(void 0===r)throw new Error("accountMetainfo not received");return r}accountsMetainfo(){return Object(b.a)(this._brokerConnection.accountsMetainfo(),1e4,"accountsMetainfo not received")}setCurrentAccount(e){if(void 0===this._brokerConnection.setCurrentAccount)throw new Error(this._brokerMetainfo.title+" doesn't support sub-accounts");this._brokerConnection.setCurrentAccount(e)}symbolInfo(e){return Object(b.a)(this._brokerConnection.symbolInfo(e),1e4,"symbolInfo not received")}async getPositionCurrency(e){try{const t=await this._brokerConnection.symbolInfo(e);if(this._brokerMetainfo.configFlags.positionPLInInstrumentCurrency&&void 0!==t.currency)return t.currency;const r=await this.accountMetainfo();return Object(S.f)(t,r,!0)}catch(t){return void w.logError(t)}}bugReportInfo(){function e(e){return JSON.parse(JSON.stringify(e))}function t(e){if("object"!=typeof e)return e;if(Object(c.isArray)(e))return e.map(t);const r={};for(const t in e)"object"!=typeof e[t]&&(r[t]=e[t]);return r}return Promise.all([this.orders(),this.positions(),this.config.supportTrades?this.trades():Promise.resolve([])]).then(r=>({activeBroker:this.metainfo().title,orders:t(e(r[0])),positions:t(e(r[1])),trades:t(e(r[2])),silentOrdersPlacement:this._host.silentOrdersPlacement().value(),floatingPanel:Object(d.ensureNotNull)(this._host.sellBuyButtonsVisibility()).value(),account:this.currentAccount(),accountType:this.currentAccountType(),lastUpdates:this._lastFireResult,time:Date.now(),
brokerSpecific:this._brokerConnection.bugReportInfo?this._brokerConnection.bugReportInfo():null}))}processErrors(e,t,r,o){if(!Object(c.isPromise)(e))throw new Error("Broker incorrectly implements API, should return Promise");return e.then(o).then(e=>"boolean"!=typeof e||e).catch(e=>{let o="";return"string"==typeof e?o=e:"object"==typeof e&&"string"==typeof e.message&&(o=Object(v.removeTags)(e.message)),t&&a.enabled("trading_notifications")?(0!==o.length&&("."!==o.slice(-1)&&(o+="."),o+=" "),o+=Object(n.t)("To learn more, please contact your broker."),this._host.showNotification(r||"",o,0)):w.logWarn(e),Promise.resolve(!1)}).then(e=>(this.tradingOperationFinished.fire(e),e))}setDurations(e){this._brokerMetainfo.durations=e.slice()}setSymbolSearchId(e){this._brokerMetainfo.backendBrokerName=e}getRealtimeDataCheckParams(){return this._brokerConnection.getRealtimeDataCheckParams?this._brokerConnection.getRealtimeDataCheckParams():{}}getVerifyLiveAccountParams(){if(void 0===this._brokerConnection.getVerifyLiveAccountParams)throw new Error(`Method getVerifyLiveAccountParams for broker ${this._brokerMetainfo.id} is not implemented`);return this._brokerConnection.getVerifyLiveAccountParams()}unhideSymbolSearchGroups(){return this._brokerConnection.unhideSymbolSearchGroups?this._brokerConnection.unhideSymbolSearchGroups():[]}destroy(){void 0!==this._brokerConnection.destroy&&this._brokerConnection.destroy()}currentBroker(){return this._brokerMetainfo.id}_initializeConnectProtection(){let e=null;this.connectionStatusUpdate.subscribe(null,t=>{if(e&&(clearTimeout(e),e=null),2===t){const t=Object(S.h)(this.config.authorizationType)?18e4:6e4;e=setTimeout(()=>{this._host.selectBroker(),this._host.showNotification(Object(n.t)("Authorization Error"),Object(n.t)("The connection attempt failed. Please try again later."))},t)}})}_fakeSubscribeDOME(e){this._fakeDomeSubscriptions[e]=(e,t)=>{const r=t.ask||t.trade,o=t.bid||t.trade,i={snapshot:!0,asks:r?[{price:r,volume:t.ask_size||1/0}]:[],bids:o?[{price:o,volume:t.bid_size||1/0}]:[]};this._host.domeUpdate(e,i)},this.subscribeRealtime(e,this._fakeDomeSubscriptions[e])}_fakeUnsubscribeDOME(e){this.unsubscribeRealtime(e,this._fakeDomeSubscriptions[e])}_isMaintenance(){return Object(i.isFeatureEnabled)(Object(S.k)(this._brokerMetainfo.id))}_isBrokerSideMaintenance(){return Object(i.isFeatureEnabled)(Object(S.j)(this._brokerMetainfo.id))}_patchBrokerSubscribeUnsubscribeDOMEMethods(){const e=!this._brokerMetainfo.configFlags.supportLevel2Data;this._brokerConnection.subscribeDOME=e?e=>{this._fakeSubscribeDOME(e)}:this._originalDOMESubscriptionMethods.subscribeDOME,this._brokerConnection.unsubscribeDOME=e?e=>{this._fakeUnsubscribeDOME(e)}:this._originalDOMESubscriptionMethods.unsubscribeDOME}_patchMetainfo(e){const t=Object(y.deepCopy)(e);return t.configFlags.supportNativeReversePosition=!this.config.supportMultiposition||this.config.supportNativeReversePosition,t.configFlags.supportClosePosition=!0,t.configFlags.supportPLUpdate=!0,t}_addSubscription(e,t,r){this._pendingSubscriptions.push({
brokerMethodName:e,symbol:t,listener:r});const o=this._lastFireResult[t];if(void 0!==o&&void 0!==o[e]&&null!==o[e]&&r(t,o[e].data),!this._removePendingSubscription({brokerMethodName:e,symbol:t,listener:r}))return;void 0===this._subscriptions[t]&&(this._subscriptions[t]={Realtime:[],PL:[],Equity:[],DOME:[],TradePL:[],PipValue:[],MarginAvailable:[],CryptoBalance:[]});const i=Object(d.ensure)(this._subscriptions[t]),s=i[e].length>0;if(i[e].push(r),!s&&(i[e].length>0||"CryptoBalance"===e)){const r="subscribe"+e;this._brokerConnection[r]&&this._brokerConnection[r](t)}}_removePendingSubscription(e){const t=this._pendingSubscriptions.findIndex(t=>t.symbol===e.symbol&&t.brokerMethodName===e.brokerMethodName&&t.listener===e.listener);return-1!==t&&(this._pendingSubscriptions.splice(t,1),!0)}_removeSubscription(e,t,r){if(this._removePendingSubscription({brokerMethodName:e,symbol:t,listener:r}))return;if(void 0===this._subscriptions[t])return;const o=Object(d.ensure)(this._subscriptions[t]),i=o[e].indexOf(r);if(i>-1&&o[e].splice(i,1),0===o[e].length){const r="unsubscribe"+e;this._brokerConnection[r]&&this._brokerConnection[r](t)}}_positions(){return this._positionsCache?this._positionsCache.getObjects():Promise.resolve([])}_trades(){return this._tradesCache?this._tradesCache.getObjects():Promise.resolve([])}_orders(){return this._ordersCache.getObjects()}_makeSureBrokerIsConnected(){Object(d.assert)(1===this.connectionStatus(),"Broker is not connected")}_placeReversePositionOrder(e){const t=P(2*e.qty,e);return this.placeOrder(t)}_reversePosition(e){return this.config.supportNativeReversePosition&&this._brokerConnection.reversePosition?this.processErrors(this._brokerConnection.reversePosition(e),!0,window.t("Failed to reverse position")):this.positionById(e).then(e=>{const t=Object(d.ensureDefined)(e);return this.processErrors(this._placeReversePositionOrder(t),!0,Object(n.t)("Failed to reverse position"),()=>Object(d.ensureNotNull)(this._tradingStat).trackOrderPlaced())})}async _waitForOrderModification(e){const t=await this.orderById(e.id);return!!j(e,Object(d.ensureDefined)(t))||new Promise(t=>{const r=()=>this.orderUpdate.unsubscribe(this,o),o=o=>{(e.id===o.id||j(e,o))&&(t(!0),r(),clearTimeout(i))};this.orderUpdate.subscribe(this,o);const i=setTimeout(()=>{t(!1),this._brokerLogger.logError("Failed to modify order: timeout waiting for new order"),r()},3e4)})}}var E=r("nc0P"),A=r("Vdly"),I=r.n(A),B=r("hY0g"),D=r.n(B),F=r("jCNj"),x=r("zXvd"),U=r("cUJV"),L=r("IWXC"),R=r("S1s9"),N=r("aR9K");class q{constructor(e,t){this._localStorageProvider=null,this._sessionStorageProvider=null,this._brokerId=e.toLowerCase(),this._rememberCredentials=t}save(e,t){this._currentStorageProvider().setItem(`${this._brokerId}.${e}`,t)}load(e,t){return this._currentStorageProvider().getItem(`${this._brokerId}.${e}`,t)}clear(e){this._currentStorageProvider().removeItem(`${this._brokerId}.${e}`)}_currentStorageProvider(){return this._rememberCredentials.value()?(null===this._localStorageProvider&&(this._localStorageProvider=new R.a),
this._localStorageProvider):(null===this._sessionStorageProvider&&(this._sessionStorageProvider=new N.a),this._sessionStorageProvider)}}var V=r("Y/3S"),G=r("kcTO"),K=r("Jokx"),W=r("xlbu");function z(e){W.telemetry.sendReport("trading","symbol_mapper_http_status",{value:e})}class H{constructor(e){this._queueForTV={},this._queueForBroker={},this._brokerName=e}tvToBroker(e){return this._queueForBroker[e]||(this._queueForBroker[e]=this._requestOfData(e,this._brokerName,"symbol")),this._queueForBroker[e]}brokerToTv(e){return this._queueForTV[e]||(this._queueForTV[e]=this._requestOfData(e,this._brokerName,"brokerSymbol")),this._queueForTV[e]}async _requestOfData(e,t,r){const o=this._getSymbolSearchOptions(t,e);let i;try{i=await Object(O.retryWithChangingIntervals)(()=>Object(K.b)(o),[2,200,2e3,1e4])}catch(s){throw z(500),s}if(!i.length)throw new Error("SYMBOL_NOT_FOUND");return z(200),this._regainSymbol(r,i[0])}_getSymbolSearchOptions(e,t){return Object.assign(Object.assign({},this._parseSymbol(t)),{brokerId:e,serverHighlight:!1,onlyTradable:!0,strictMatch:!0})}_parseSymbol(e){if(e.includes(":")){const[t,r]=e.split(":");return{exchange:t,text:r}}return{text:e}}_getBrokerSymbol(e){return void 0!==e.contracts?e.contracts[0].broker_symbol:e.broker_symbol}_getTvSymbol(e){return void 0!==e.contracts?`${e.prefix||e.exchange}:${e.contracts[0].symbol}`:`${e.prefix||e.exchange}:${e.symbol}`}_regainSymbol(e,t){return this._isDirectionSymbol(e)?this._getBrokerSymbol(t):this._getTvSymbol(t)}_isDirectionSymbol(e){return"symbol"===e}}var Y=r("JWMC");const Q=Object(h.getLogger)("Trading.SymbolMapperSync"),X=window.SYMBOL_MAPPER_URL;function J(e){W.telemetry.sendReport("trading","symbol_mapper_sync_http_status",{value:e})}class Z{constructor(e,t){this._tvToBroker={},this._brokerToTv={},this._appendSymbol=e=>{const t=this._getTvSymbols(e),r=this._getBrokerSymbols(e);t.forEach((e,t)=>{const o=r[t];this._tvToBroker[e]=o,this._brokerToTv[o]=e})},void 0!==(null==t?void 0:t.unhideSymbolSearchGroups)&&(this._unhideSymbolSearchGroups=t.unhideSymbolSearchGroups),this._readyPromise=Object(O.retryWithChangingIntervals)(()=>this._initSymbolSearch(e,null==t?void 0:t.exchange)).catch(()=>(Q.logWarn("Symbol search initialization failed, switching to symlist feed"),Object(O.retryWithChangingIntervals)(()=>this._initSymlistFeed(e))))}ready(){return this._readyPromise}tvToBroker(e){return this._tvToBroker[e]||null}brokerToTv(e){return this._brokerToTv[e]||null}async _initSymbolSearch(e,t){Q.logNormal(`Requesting mapping for ${e} broker`);const r=this._getSymbolSearchOptions(e,t);try{const t=await Object(K.b)(r);if(!t.length)throw new Error("cannot get mappings: symbols list is empty");t.forEach(this._appendSymbol),Q.logNormal(`Mapping for ${e} is loaded for ${t.length} symbol(s)`),J(200)}catch(o){throw Q.logWarn("Request mapping failed: "+o.message),J(400),Object(Y.trackEvent)("SymbolMapper",e,o.message),new Error("cannot get mappings")}}_initSymlistFeed(e){Q.logNormal(`Requesting mapping for ${e} broker`)
;const t=`${X}/mergefields/mapping/${e.toLowerCase()}`;return fetch(t).then(e=>e.json()).then(t=>{if(function(e){return"error"===e.s}(t))throw Q.logWarn("Service error response: "+t.errmsg),new Error("cannot get mappings");const r=t.fields.indexOf("brokerSymbol");if(-1===r)throw new Error(`Mapping for ${e} broker does not have broker symbol field "brokerSymbol" in ${JSON.stringify(t.fields)}`);for(const e of t.symbols){const t=e.s,o=e.f[r][""];this._tvToBroker[t]=o,this._brokerToTv[o]=t}Q.logNormal(`Mapping for ${e} is loaded for ${t.symbols.length} symbol(s)`),J(200)}).catch(e=>{throw Q.logWarn("Request mapping failed: "+e.message),J(500),new Error("cannot get mappings")})}_getBrokerSymbols(e){return void 0!==e.contracts?e.contracts.map(e=>e.broker_symbol):[e.broker_symbol]}_getTvSymbols(e){return void 0!==e.contracts?e.contracts.map(t=>`${e.prefix||e.exchange}:${t.symbol}`):[`${e.prefix||e.exchange}:${e.symbol}`]}_getSymbolSearchOptions(e,t){const r={text:"",brokerId:e,noLimits:!0,serverHighlight:!1,onlyTradable:!0,exchange:t};if(void 0!==this._unhideSymbolSearchGroups){const e=this._unhideSymbolSearchGroups;e.length&&(r.unhideSymbolSearchGroups=e.join(","))}return r}}var ee=r("fZEr"),te=r("5det"),re=r("VBos"),oe=r("1rjR"),ie=r("QBLL"),se=r("C9TK");class ne{constructor(e,t,r,o){this._lastPL=0,this._isActive=!1,this._realtimeUpdate=(e,t)=>{this._realtimeData=t,this._updatePL()},this._symbol=e.symbol,this._adapter=r,this._onPlUpdate=t,this._side=e.side,this._qty=e.qty,this._avgPrice=e.avgPrice,this._instrumentInfo=o,this.positionUpdate(e)}positionUpdate(e){this._avgPrice=e.avgPrice,this._qty=e.qty,this._updatePL()}lastPL(){return this._lastPL}start(){this._isActive||(this._adapter.subscribeRealtime(this._symbol,this._realtimeUpdate),this._isActive=!0)}stop(){this._isActive&&(this._adapter.unsubscribeRealtime(this._symbol,this._realtimeUpdate),this._isActive=!1)}_updatePL(){if(!this._realtimeData||void 0===this._realtimeData.bid||void 0===this._realtimeData.ask)return;const e=((1===this._side?this._realtimeData.bid:this._realtimeData.ask)-Math.abs(this._avgPrice))*(1===this._side?1:-1)*this._qty/this._instrumentInfo.pipSize*this._instrumentInfo.pipValue;this._lastPL=e,this._onPlUpdate(e)}}class ae{constructor(e,t){var r;this._setDefaultDropdownActionsBound=this._setDefaultDropdownActions.bind(this),this._trading=e,this._metainfo=t,this._setDefaultDropdownActionsBound=this._setDefaultDropdownActions.bind(this),this._defaultDropdownActions=!0,this._credentialsStorage=new q(this._metainfo.id,new V.a(this._metainfo.id)),this._setDefaultDropdownActions(),null!==this._trading&&(null===(r=this.sellBuyButtonsVisibility())||void 0===r||r.subscribe(this._setDefaultDropdownActionsBound),Object(d.ensureNotNull)(this.orderPanelVisibility()).subscribe(this._setDefaultDropdownActionsBound),Object(d.ensureNotNull)(this.domPanelVisibility()).subscribe(this._setDefaultDropdownActionsBound))}createPLEmitter(e,t,r){return new ne(e,t,this._adapter,r)}getLogger(){return Object(h.getLogger)("Trading."+this._metainfo.id)}translate(e){
return e}setBrokerConnectionAdapter(e){this._adapter=e}patchConfig(e){this._adapter.patchConfig(e)}showOrderDialog(e,t){return Object(d.ensureNotNull)(this._trading).orderViewController().showOrderView(this._adapter,e,t)}showPositionBracketsDialog(e,t,r){return Object(d.ensureNotNull)(this._trading).orderViewController().showPositionView(this._adapter,e,t,r)}showCancelOrderDialog(e,t){return oe.a.get().open(e).then(e=>{e&&this._adapter.processErrors(t(),!0,$.t("Failed to cancel order"))})}showCancelMultipleOrdersDialog(e,t,r,o){return oe.a.get().multiple(e,t,r).then(e=>{e&&this._adapter.processErrors(o(),!0,$.t("Failed to cancel one or more orders"))})}showCancelBracketsDialog(e,t){return ie.a.get().open(e).then(e=>{e&&this._adapter.processErrors(t(),!0,$.t("Failed to cancel brackets"))})}showCancelMultipleBracketsDialog(e,t){return ie.a.get().multiple(e).then(e=>{e&&this._adapter.processErrors(t(),!0,$.t("Failed to cancel brackets"))})}showReversePositionDialog(e,t){return Object(se.a)(e,Object(d.ensureNotNull)(this._trading).showErrorNotification,t)}showMessageDialog(e,t,r=!1){r?Object(ee.showWarning)({title:e,html:t}):Object(ee.showWarning)({title:e,text:t})}showConfirmDialog(e,t,r,o,i){return Object(te.a)(e,t,r,o,i)}showSimpleConfirmDialog(e,t,r,o,i){return Object(re.a)({title:e,text:Array.isArray(t)?t.join(" "):t,mainButtonText:r,mainButtonIntent:"primary",cancelButtonText:o,showDisableConfirmationsCheckbox:i})}setDurations(e){this._adapter.setDurations(e)}setSymbolSearchId(e){this._adapter.setSymbolSearchId(e)}activateBottomWidget(){return null!==this._trading?this._trading.toggleTradingWidget():Promise.reject("Activate bottom widget failed: trading is not defined")}trackEvent(e,t,r){null!==this._trading&&this._trading.trackEvent(e,t,r)}defaultFormatter(e,t){return Object(L.getQuoteSessionInstance)("simple").formatter(e,t)}numericFormatter(e){return Promise.resolve(new x.NumericFormatter(e))}quantityFormatter(e){return Promise.resolve(new U.a(e))}selectBroker(){null!==this._trading&&this._trading.selectBroker(null)}showTradingProperties(){null!==this._trading&&this._trading.showTradingProperties()}async getSymbolType(e){return(await ce(e)).type}async getSymbolMinTick(e){const t=await ce(e);return Number(Object(E.Big)(t.minmov).div(t.pricescale))}suggestedQty(){return Object(d.ensureNotNull)(this._trading).suggestedQty()}silentOrdersPlacement(){return Object(d.ensureNotNull)(this._trading).noConfirmEnabled}sellBuyButtonsVisibility(){return null!==this._trading&&a.enabled("buy_sell_buttons")?this._trading.showSellBuyButtons:null}domPanelVisibility(){return null!==this._trading?this._trading.domPanelVisibility():null}orderPanelVisibility(){return null!==this._trading?this._trading.orderPanelVisibility():null}showPricesWithZeroVolume(){return Object(d.ensureNotNull)(this._trading).showPricesWith().zeroVolume}showNotification(e,t,r=0){null!==this._trading&&(0===r?this._trading.showErrorNotification(e,t):this._trading.showSuccessNotification(e,t))}connectionStatusUpdate(e,t){
this._adapter.connectionStatusUpdate.fire(e,t),1===e&&this._setDefaultDropdownActions()}orderUpdate(e){this._adapter.onOrderUpdate(e)}positionUpdate(e,t){this._adapter.onPositionUpdate(e,t)}tradeUpdate(e,t){this._adapter.onTradeUpdate(e,t)}orderPartialUpdate(e,t){this._adapter.onOrderPartialUpdate(e,t)}positionPartialUpdate(e,t){this._adapter.onPositionPartialUpdate(e,t)}tradePartialUpdate(e,t){this._adapter.onTradePartialUpdate(e,t)}executionUpdate(e){this._adapter.executionUpdate.fire(e)}currentAccountUpdate(){this._adapter.onCurrentAccountChanged()}realtimeUpdate(e,t){this._adapter.fireSubscription("Realtime",e,t)}domeUpdate(e,t){this._adapter.fireSubscription("DOME",e,t)}pipValueUpdate(e,t){this._adapter.fireSubscription("PipValue",e,t)}plUpdate(e,t){this._adapter.fireSubscription("PL",e,t)}tradePLUpdate(e,t){this._adapter.fireSubscription("TradePL",e,t)}equityUpdate(e){this._adapter.fireSubscription("Equity","Equity",e)}marginAvailableUpdate(e){this._adapter.fireSubscription("MarginAvailable","MarginAvailable",e)}cryptoBalanceUpdate(e,t){this._adapter.fireSubscription("CryptoBalance",e,t)}setButtonDropdownActions(e){var t;null!==this._trading&&this._defaultDropdownActions&&(this._defaultDropdownActions=!1,null===(t=this.sellBuyButtonsVisibility())||void 0===t||t.unsubscribe(this._setDefaultDropdownActionsBound),Object(d.ensureNotNull)(this.orderPanelVisibility()).unsubscribe(this._setDefaultDropdownActionsBound),Object(d.ensureNotNull)(this.domPanelVisibility()).unsubscribe(this._setDefaultDropdownActionsBound)),this._buttonDropdownActions=e}buttonDropdownActions(){return this._buttonDropdownActions}defaultContextMenuActions(...e){return null!==this._trading?this._trading.defaultContextMenuActions(...e):Promise.resolve([])}defaultDropdownMenuActions(e){return null!==this._trading?this._trading.defaultDropdownMenuActions(e):[]}get factory(){return{createDelegate:()=>new u.a,createWatchedValue:e=>new D.a(e),createPriceFormatter:(e,t,r,o)=>new G.PriceFormatter(e,t,r,o)}}get settings(){return{save:(e,t)=>I.a.setJSON(`${this._metainfo.id}.${e}`,t),load:(e,t)=>I.a.getJSON(`${this._metainfo.id}.${e}`,t),clear:(e,t)=>I.a.remove(`${this._metainfo.id}.${e}`,t)}}get credentialsStorage(){return{save:(e,t)=>this._credentialsStorage.save(e,t),load:(e,t)=>this._credentialsStorage.load(e,t),clear:e=>this._credentialsStorage.clear(e)}}createMapper(e){let t=null;return t=new H(e),t}createMapperSync(e,t){let r=null;return r=new Z(e,t),r}convertTimezone(e,t,r){const o=F.get_timezone(t),i=F.get_timezone(r),s=F.cal_to_utc(o,e);return F.utc_to_cal(i,s)}language(){return window.language}getUserSpecificHash(){return window.user.private_channel||""}activateFXCMCFD(){I.a.setValue("fxcm_cfd",!0)}async isFractional(e){return(await ce(e)).fractional}_setDefaultDropdownActions(){null!==this._trading&&this._defaultDropdownActions&&(this._buttonDropdownActions=this.defaultDropdownMenuActions())}}function ce(e){return Object(L.getQuoteSessionInstance)("full").snapshot(e)}var le=r("U/Is"),ue=r("E9hm");r.d(t,"a",(function(){return pe})),
r.d(t,"b",(function(){return he})),r.d(t,"c",(function(){return be}));const de=[];function pe(e,t){e.configFlags=Object(ue.a)(e.configFlags),de.push({metainfo:e,createBrokerFunction:t})}function he(){return de.map(e=>e.metainfo)}function be(e,t,r){return new Promise(o=>{const i=de.filter(e=>e.metainfo.id===t)[0],s=new ae(e,i.metainfo);i.createBrokerFunction(s,t=>{const n=new le.BrokerRealtimeAdapter(i.metainfo.id);o(new M(i.metainfo,t,s,n,e&&e.tradingStat(),r))})})}},"Hm/6":function(e,t,r){e.exports=r.p+"979e74f40104e3d1eb99117279963ab1.svg"},IPRJ:function(e,t,r){e.exports=r.p+"e7a94470901fdc8a9c5a05100ee285f9.svg"},JmZA:function(e,t,r){e.exports=r.p+"ac2da67a9a10f81dea3ccb57bc661f70.svg"},Jokx:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return c}));var o=r("Wt0y"),i=r("xlbu"),s=r("wVAQ"),n=r("0W4x");function a(e){return e.hasOwnProperty("exchange")}async function c(e){const t=function(){let e=location.protocol+"//"+window.SS_HOST;Object(o.isProd)()?e+="/symbol_search/":e+="/local_search/";window.SS_URL&&(e=window.SS_URL);return e}(),r=function(e){const t={};void 0!==e.text&&(t.text=e.text);void 0!==e.serverHighlight&&(t.hl=e.serverHighlight?"1":"0");void 0!==e.exchange&&(t.exchange=e.exchange);e.strictMatch&&(t.strict="1");e.noLimits&&(t.no_limits="1");void 0!==e.lang&&(t.lang=e.lang);void 0!==e.type&&(t.type=e.type);window.SS_DOMAIN_PARAMETER&&(t.domain=window.SS_DOMAIN_PARAMETER);e.brokerId&&(t.broker=e.brokerId.toLowerCase(),e.onlyTradable&&(t.tradable="1"),e.unhideSymbolSearchGroups&&(t.unhide=e.unhideSymbolSearchGroups));return t}(e),a=Object(n.createQueryParams)(r),c=(new Date).getTime();try{const r=await Object(s.fetch)(t+"?"+a,{signal:e.signal});if(!r.ok)throw new Error(`${r.status}: ${r.statusText}`);const o=await r.json();return i.telemetry.sendChartReport("symbol_search_http_status",{value:r.status}),o}catch(l){throw i.telemetry.sendChartReport("symbol_search_http_error"),l}finally{!function(e){const t=(new Date).getTime()-e;i.telemetry.sendChartReport("symbol_search_time_frame",{value:t})}(c)}}},JsCC:function(e,t,r){e.exports=r.p+"1dc764aa1d1e68ed081dca3225b1e1ba.svg"},KVSc:function(e,t,r){e.exports=r.p+"73208d90c169cfcc67eef8b9d6343738.svg"},LM8x:function(e,t,r){e.exports=r.p+"1304d9662aa397cda6a293def773af48.svg"},LaSJ:function(e,t,r){e.exports=r.p+"e9e9adf17f50557217629e0624aec3bf.svg"},LnTS:function(e,t,r){e.exports=r.p+"c112b7aeee1aaada531681686f73fb73.svg"},M64u:function(e,t,r){e.exports=r.p+"bcee829832f0b4750c2d9f744a6833f4.svg"},Mic2:function(e,t,r){e.exports=r.p+"d6b9738868d3e8d5889b6feac186fdb7.svg"},O7m7:function(e,t,r){},O7qw:function(e,t,r){e.exports=r.p+"f962b977025f0daa000bd76d98026658.svg"},P0Oe:function(e,t,r){"use strict";r.r(t),r.d(t,"CQGSeparatedBrokersMetainfo",(function(){return o}));const o={AMP:{salesSeries:["AMP","AMPTrading"]},IRONBEAM:{salesSeries:["IRB"]},TICKMILL:{
salesSeries:["House Account","Internal - Professional Non TTCA","Internal - Professional TTCA","Professional","Retail","Professional - TTCA","Corporate","Internal Connections","Internal - Retail"]}}},PtA5:function(e,t,r){e.exports=r.p+"5d99bff713b06c197109bafb5e372686.svg"},QBLL:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var o=r("YFKU"),i=r("VBos");const s={get(){return this},open:e=>Object(i.a)({title:Object(o.t)("Cancel bracket"),text:Object(o.t)("Are you sure you want to cancel {orderId}bracket?").replace("{orderId}",""!==e?e+" ":""),mainButtonIntent:"primary"}),multiple:e=>Object(i.a)({title:Object(o.t)("Cancel bracket"),text:Object(o.t)("Are you sure you want to cancel {orderId}brackets?").replace("{orderId}",""!==e?e+" ":""),mainButtonIntent:"primary"})}},RR0W:function(e){e.exports=JSON.parse('{"AMP":{"title":"AMP"},"IRONBEAM":{"title":"IRONBEAM"},"OANDA":{"title":"OANDA"},"FOREXCOM":{"title":"FOREX.com"},"FXCM":{"title":"FXCM"},"ALOR":{"title":"Alor Broker"},"MODAL":{"title":"Modalmais"},"POLONIEX":{"title":"Poloniex"},"IBROKER":{"title":"iBroker"},"SAXOBANK":{"title":"Saxo"},"TRADOVATE":{"title":"Tradovate"},"TRADESTATION":{"title":"TradeStation"},"WHSELFINVEST":{"title":"WH Selfinvest"},"GEMINI":{"title":"Gemini"},"ALPACA":{"title":"Alpaca"},"CURRENCYCOM":{"title":"Currency.com"},"HITBTC":{"title":"HitBTC"},"CAPITALCOM":{"title":"Capital.com"},"TICKMILL":{"title":"Tickmill"},"TIGER":{"title":"Tiger Brokers"},"IBKR":{"title":"Interactive Brokers"},"GLOBALPRIME":{"title":"Global Prime"},"CHAKA":{"title":"Chaka"},"TIMEX":{"title":"Timex"}}')},RSXQ:function(e,t,r){e.exports=r.p+"08acda496a50c7a05da09e5531f1c744.svg"},S1s9:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var o=r("xtVx");class i extends o.a{constructor(){super(localStorage)}}},S8UK:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var o=r("N22A");async function i(){(await Object(o.waitTradingService)()).tradingPanelPopup.show()}},T2i3:function(e,t,r){e.exports=r.p+"70d6ce70c72dd7f6d2739233362a22ca.svg"},"U/Is":function(e,t,r){"use strict";r.r(t),r.d(t,"BrokerRealtimeAdapter",(function(){return n}));var o=r("kcTO"),i=r("IWXC"),s=r("cUJV");class n{constructor(e){this._realtimeSubscriptions={},this._domeSubscriptions={},this._lastQuoteValues={},this._realtimeSubscriptions={},this._lastQuoteValues={},this._connectionId=e}isTradable(e){return Promise.resolve({tradable:!1})}connectionStatus(){return 3}formatter(e){return Object(i.getQuoteSessionInstance)("simple").formatter(e,!0)}spreadFormatter(e){const t=Object(i.getQuoteSessionInstance)("simple");return Promise.all([t.snapshot(e),t.formatter(e)]).then(([e,t])=>{const r=t.state();return"forex"!==e.type&&"cfd"!==e.type||!r.minMove2?t:new o.PriceFormatter(r.minMove2)})}quantityFormatter(e){return Promise.resolve(new s.a)}symbolInfo(e){return Object(i.getQuoteSessionInstance)("simple").snapshot(e).then(e=>({minTick:e.minmov/e.pricescale,qty:{min:1,max:1e10,step:1},description:e.description,pipValue:NaN,pipSize:NaN}))}subscribeRealtime(e,t){let r=!1
;this._realtimeSubscriptions[e]||(this._realtimeSubscriptions[e]=[],r=!0);const o=this._realtimeSubscriptions[e];function s(e){let t;const r=e.values,o=r.ask||r.last_price,i=r.bid||r.last_price;return r.spread?t=r.spread:("forex"===r.type||"cfd"===r.type)&&void 0!==i&&void 0!==o&&r.minmove2&&r.pricescale&&(t=(o-i)*r.pricescale/r.minmove2),{ask:o,ask_size:r.ask_size,bid:i,bid_size:r.bid_size,size:r.volume,spread:t,trade:r.last_price,type:r.type}}if(o.push(t),r)Object(i.getQuoteSessionInstance)("full").subscribe(this._connectionId,e,(t,r)=>{if(t.error||!t.values||!t.values.pricescale)return;this._lastQuoteValues[e]=t;const i=s(t);"is_tradable"in t.values&&(i.is_tradable=t.values.is_tradable);for(let s=0;s<o.length;s++)o[s](e,i)});else if(this._lastQuoteValues[e]){const r=s(this._lastQuoteValues[e]);t(e,r)}}unsubscribeRealtime(e,t){const r=this._realtimeSubscriptions[e];if(!r)return;const o=r.indexOf(t);-1!==o&&(r.splice(o,1),r.length||(delete this._realtimeSubscriptions[e],Object(i.getQuoteSessionInstance)("full").unsubscribe(this._connectionId,e)))}subscribeDOME(e,t){const r=["bitcoin","crypto","index"];let o=!1;this._domeSubscriptions[e]||(this._domeSubscriptions[e]=[],o=!0);const s=this._domeSubscriptions[e];function n(e){const t=e.values.ask||e.values.last_price,o=e.values.bid||e.values.last_price,i=r.includes(e.values.type)?0:e.values.ask_size||1/0,s=r.includes(e.values.type)?0:e.values.bid_size||1/0;return{snapshot:!0,asks:t?[{price:t,volume:i}]:[],bids:o?[{price:o,volume:s}]:[]}}if(s.push(t),o)Object(i.getQuoteSessionInstance)("full").subscribe(this._connectionId+"dom",e,(t,r)=>{if(t.error||!t.values||!t.values.pricescale)return;this._lastQuoteValues[e]=t;const o=n(t);for(let i=0;i<s.length;i++)s[i](e,o)});else if(this._lastQuoteValues[e]){const r=n(this._lastQuoteValues[e]);t(e,r)}}unsubscribeDOME(e,t){const r=this._domeSubscriptions[e];if(!r)return;const o=r.indexOf(t);-1!==o&&(r.splice(o,1),r.length||(delete this._domeSubscriptions[e],Object(i.getQuoteSessionInstance)("full").unsubscribe(this._connectionId+"dom",e)))}quotesSnapshot(e){return new Promise(t=>{const r=(e,o)=>{this.unsubscribeRealtime(e,r),t(o)};this.subscribeRealtime(e,r)})}}},UB4j:function(e,t,r){e.exports=r.p+"fed0a5ee8cec6f44eb002836f2400c17.svg"},Ugf8:function(e,t,r){e.exports=r.p+"fcfaf359494de88fbe94ebbec4249db9.svg"},V9cU:function(e,t,r){e.exports=r.p+"8d790891aeba0dd7e8ec9657f41bfd30.svg"},VBos:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var o=r("cJM1");async function i(e){const t=new o.a;if(e.showDisableConfirmationsCheckbox&&t.has(e.text))return!0
;const[{showSimpleDialog:i},{SimpleConfirmDialog:s}]=await Promise.all([Promise.all([r.e("vendors"),r.e(0),r.e(2),r.e(6),r.e(7),r.e(9),r.e(11),r.e(12),r.e(13),r.e(15),r.e(22),r.e(28),r.e(71),r.e(216),r.e(286),r.e(416),r.e(531),r.e(8),r.e(10),r.e(188),r.e(330),r.e("create-confirm-dialog")]).then(r.bind(null,"EcUf")),Promise.all([r.e("vendors"),r.e(0),r.e(2),r.e(6),r.e(7),r.e(9),r.e(11),r.e(12),r.e(13),r.e(15),r.e(22),r.e(28),r.e(71),r.e(216),r.e(286),r.e(416),r.e(531),r.e(8),r.e(10),r.e(188),r.e(330),r.e("create-confirm-dialog")]).then(r.bind(null,"Hc1a"))]);return new Promise(r=>{i(Object.assign(Object.assign({},e),{disabledConfirmations:t,onConfirm:t=>{r(!0),void 0!==e.onConfirm&&e.onConfirm(),t.dialogClose()},onClose:()=>{r(!1),void 0!==e.onClose&&e.onClose()}}),s)})}},ViNg:function(e,t,r){e.exports=r.p+"bf1e84e6c13c03f5a394193c1ed9ad5a.svg"},WN0Z:function(e,t,r){e.exports=r.p+"8eb2717bc35b3dfc23f9278f7d346e4f.svg"},X6XM:function(e,t,r){e.exports=r.p+"980cde7fdf278c4584e131361b49bb85.svg"},XAwv:function(e,t,r){e.exports=r.p+"0716de85ffaf9a87610e3cb704fb03ea.svg"},"Y+vJ":function(e,t,r){e.exports=r.p+"0e82e13d18969440c8eee091283060cd.svg"},"Y/3S":function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var o=r("Vdly"),i=r.n(o);class s{constructor(e){this._settingsKey=`trading.${e}.rememberCredentials`}value(){return i.a.getBool(this._settingsKey,!0)}setValue(e){i.a.setValue(this._settingsKey,e)}}},YZ9j:function(e){e.exports=JSON.parse('{"loader":"loader-8x1ZxRwP","item":"item-2-89r_cd","tv-button-loader":"tv-button-loader-23vqS1uY","black":"black-20Ytsf0V","white":"white-1ucCcc2I","gray":"gray-XDhHSS-T","loader-initial":"loader-initial-1deQDeio","loader-appear":"loader-appear-2krFtMrd"}')},Ylqo:function(e,t,r){e.exports=r.p+"dafef2f4587f93fc733f99e6c5b13b86.svg"},Z3o7:function(e,t,r){e.exports=r.p+"1e5c3fd85587ddd3ca67c93135d5c0d7.svg"},ZLV4:function(e,t,r){e.exports=r.p+"be0a67195f0456304f184d5d8cb6a5b4.svg"},ZSZN:function(e,t,r){e.exports=r.p+"20f5253008b7483f1bb121cf6d3a2fb0.svg"},ZWgA:function(e,t,r){e.exports=r.p+"08afe47743f9bdadf2ab215f1b2aa20e.svg"},ZoRv:function(e,t,r){e.exports=r.p+"2c753ad62134ddec56f5a3386de49156.svg"},a5Jl:function(e,t,r){e.exports=r.p+"b325fc240f5a8d92f1b563f40afbf135.svg"},aR9K:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var o=r("xtVx");class i extends o.a{constructor(){super(sessionStorage)}}},aYmi:function(e,t,r){e.exports={dialog:"dialog-UM6w7sFp",rounded:"rounded-UM6w7sFp",shadowed:"shadowed-UM6w7sFp",fullscreen:"fullscreen-UM6w7sFp",darker:"darker-UM6w7sFp",backdrop:"backdrop-UM6w7sFp"}},bWqG:function(e,t,r){e.exports=r.p+"7f3e2d40eaba93acabcac2fe90537df1.svg"},bac6:function(e,t,r){e.exports=r.p+"f77a055d62b815abfb695acfa4611985.svg"},c32y:function(e,t,r){e.exports=r.p+"d51e89bf0f0f900e2fd5fcfa5ae29a45.svg"},cJM1:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var o=r("Vdly"),i=r.n(o),s=r("ZX3N"),n=r.n(s),a=r("8wgr");const c=/[0-9]+([\.,][0-9]+)*([\.,][0-9]+)?|\.[0-9]+/gm,l=/[A-Z]+/gm,u=a.settingsKeys.DISABLED_CONFIRMATIONS;class d{add(e){
const t=this._getAll(),r=this._makeMessageHash(e);t.add(r),i.a.setJSON(u,Array.from(t))}has(e){const t=this._getAll(),r=this._makeMessageHash(e);return t.has(r)}clear(){i.a.remove(u)}_getAll(){return new Set(i.a.getJSON(u))}_makeMessageHash(e){const t=e.replace(c,"").replace(l,"");return r=n()(t),btoa(String.fromCharCode.apply(null,new Uint8Array(r)));var r}}},cUJV:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var o=r("zXvd");class i{constructor(e){this._formatter=new o.NumericFormatter(e)}format(e){return this._formatter.format(e)}parse(e){const t=this._formatter.parse(e);return Number.isNaN(t)?{res:!1,error:"Value is NaN"}:{res:!0,value:t}}}},cqbI:function(e,t,r){e.exports=r.p+"b5b726f116611db33aa5ebce3736047d.svg"},dzd6:function(e,t,r){e.exports=r.p+"1bc1c502a10e4122cc0d01878866f11f.svg"},eiiC:function(e,t,r){e.exports=r.p+"2026a7f54055ca34466b4b65b96f073a.svg"},er3L:function(e,t,r){e.exports=r.p+"c8254a7d99689055664f9a4e0b6c4d74.svg"},fVRd:function(e,t,r){e.exports=r.p+"70892163e2644cfa4179f67191418758.svg"},fnnw:function(e,t,r){e.exports=r.p+"d51e89bf0f0f900e2fd5fcfa5ae29a45.svg"},gQcZ:function(e,t,r){e.exports=r.p+"197305149ab8080fde3045ff30c99dfe.svg"},hvXx:function(e,t,r){e.exports=r.p+"d90a73a10fe99f15f69addbc6b20e84d.svg"},iWVE:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var o=r("YFKU"),i=r("fZEr");const s={show(e){const t=Object(o.t)("It looks like there's a technical issue on the broker's side at the moment. To avoid making these problems worse, we've temporarily halted all trading through {brokerName} on our platform. We're currently on the phone to them right now trying to get this fixed, so you can get back on it. Sorry  it's a pain in the ass, we know.").replace("{brokerName}",e);Object(i.showWarning)({title:Object(o.t)("{brokerName} maintenance").replace("{brokerName}",e),text:t})}}},ijHL:function(e,t,r){"use strict";function o(e){return s(e,n)}function i(e){return s(e,a)}function s(e,t){const r=Object.entries(e).filter(t),o={};for(const[i,s]of r)o[i]=s;return o}function n(e){const[t,r]=e;return 0===t.indexOf("data-")&&"string"==typeof r}function a(e){return 0===e[0].indexOf("aria-")}r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return i})),r.d(t,"c",(function(){return s})),r.d(t,"e",(function(){return n})),r.d(t,"d",(function(){return a}))},ljSX:function(e,t,r){e.exports=r.p+"56ecb59ac432742594c63f849264ed81.svg"},mjcE:function(e,t,r){e.exports=r.p+"a9ade954c92952e16e70f511cf791336.svg"},nDFr:function(e,t,r){e.exports=r.p+"7ac189a68582c9ee426f6236ffc3f831.svg"},"nL9+":function(e,t,r){e.exports=r.p+"884a151b1b2a6b58afee7f2b34071d85.svg"},oK70:function(e,t,r){e.exports=r.p+"3c1264158a33c5dea157013460fe3206.svg"},oh6J:function(e,t,r){e.exports=r.p+"cff39ee49ef4fc975e841be5d995718a.svg"},ojTe:function(e,t,r){e.exports=r.p+"5e5bab9ca63d74464ed39e16ab755bd0.svg"},p1Yw:function(e,t,r){e.exports=r.p+"4de610b93a89cdabbd7026bb26646618.svg"},pzGr:function(e,t,r){e.exports=r.p+"95c87ea8579af1b174319107080a725c.svg"},qXBL:function(e,t,r){
e.exports=r.p+"1dc764aa1d1e68ed081dca3225b1e1ba.svg"},"rMn+":function(e,t,r){e.exports=r.p+"45b4cd08b13cc34fc3104a0b212f0496.svg"},rgnY:function(e,t,r){e.exports=r.p+"d9fad2d4f2a722ce7e67bcfd36915b51.svg"},s3s4:function(e,t,r){e.exports=r.p+"7563cd4010352a7e59f9920a0217805f.svg"},tkUe:function(e,t,r){e.exports=r.p+"daa56f671600d72a98f212d63cbc14a9.svg"},uhCe:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var o=r("ASyk");const i={SmallHeight:o["small-height-breakpoint"],TabletSmall:o["tablet-small-breakpoint"],TabletNormal:o["tablet-normal-breakpoint"]}},xJkl:function(e,t,r){"use strict";var o=r("YFKU"),i=r("Hgre"),s=r("+GxX");const n=[{name:"DAY",value:"DAY"},{name:"GTC",value:"GTC"},{name:"GTD",value:"GTD",hasDatePicker:!0},{name:"GTT",value:"GTT",hasDatePicker:!0,hasTimePicker:!0},{name:"FAK",value:"FAK"},{name:"FOK",value:"FOK"},{name:"ATO",value:"ATO"},{name:"ATC",value:"ATC"}];var a=r("P0Oe"),c=r("fnnw"),l=r("rgnY"),u=r("ljSX"),d=r("GomP"),p=r("ZSZN"),h=r("zcCV"),b=r("ZoRv"),f=r("HPdd"),m=r("Hm/6"),g=r("RSXQ"),_=r("X6XM"),k=r("xlVz"),O=r("IPRJ"),v=r("M64u"),y=r("bWqG"),S=r("fVRd"),P=r("rMn+"),C=r("oh6J"),w=r("0BCs"),T=r("8Ycc"),j=r("/tfs"),M=r("XAwv"),E=r("Z3o7"),A=r("qXBL"),I=r("66eg"),B=r("c32y"),D=r("+NLP"),F=r("hvXx"),x=r("Ylqo"),U=r("nDFr"),L=r("oK70"),R=r("ojTe"),N=r("Mic2"),q=r("/nxI"),V=r("er3L"),G=r("Y+vJ"),K=r("ViNg"),W=r("KVSc"),z=r("G40f"),H=r("p1Yw"),Y=r("O7qw"),Q=r("s3s4"),X=r("C1Ba"),$=r("Ugf8"),J=r("CMPx"),Z=r("7iEp"),ee=r("xjTN"),te=r("JsCC"),re=r("tkUe"),oe=r("UB4j"),ie=r("PtA5"),se=r("1+PV"),ne=r("dzd6"),ae=r("BR3a"),ce=r("pzGr"),le=r("C8sB"),ue=r("a5Jl"),de=r("gQcZ"),pe=r("Ed+0"),he=r("HPYC"),be=r("LnTS"),fe=r("T2i3"),me=r("ZWgA"),ge=r("nL9+"),_e=r("JmZA"),ke=r("LaSJ"),Oe=r("bac6"),ve=r("ZLV4"),ye=r("eiiC"),Se=r("LM8x"),Pe=r("E2A4"),Ce=r("cqbI"),we=r("mjcE"),Te=r("V9cU"),je=r("WN0Z"),Me=r("xfIE"),Ee=r("RR0W"),Ae=r("aIyQ"),Ie=r.n(Ae),Be=r("IWXC");class De{constructor(e,t){this.value=NaN,this.equity=NaN,this.onValueChanged=new Ie.a,this._pointvalue=1,this._currency="USD",this._reverseCurrency=!1,this._qsmId="profit-loss-emitter"+Math.random(),this._tradingModel=e,this._symbol=t.symbol,this._avgPrice=+t.avg_price,this._qty=+t.qty||0,this._position=t,this._isLastPriceTradedSymbol=this._tradingModel.isLastPriceTradedSymbol(this._symbol);let r=null;if("forex"===t.symboltype){const e=/^(?:.*?:)?(\w{3})(\w{3})$/.exec(this._symbol);e&&(r=[e[1],e[2]])}r?"USD"===r[0]?this._reverseCurrency=!0:"USD"===r[1]?this._reverseCurrency=!1:this._currency=r[1]:t.currency&&(this._currency=t.currency),t.pointvalue&&(this._pointvalue=t.pointvalue),this._boundQuoteListener=(e,r)=>{let o;o=e.values.current_session&&"market"!==e.values.current_session||this._isLastPriceTradedSymbol?r.values.last_price:("sell"===t.side?e.values.ask:e.values.bid)||r.values.last_price,null!=o&&(this._lastPrice=o,this._update())},this._boundPositionListener=e=>{e.symbol===this._symbol&&(this._qty=e.qty,this._avgPrice=e.avg_price,this._update())},
Promise.resolve().then(()=>Object(Be.getQuoteSessionInstance)("full").subscribe(this._qsmId,this._symbol,this._boundQuoteListener)),this._tradingModel.onPositionUpdate.subscribe(null,this._boundPositionListener)}destroy(){const e=Object(Be.getQuoteSessionNoEnsure)("full");e&&e.unsubscribe(this._qsmId,this._symbol),this._tradingModel.onPositionUpdate.unsubscribe(null,this._boundPositionListener)}_update(){const e=void 0!==this._lastPrice?this._lastPrice:NaN;let t,r=(e-this._avgPrice)*this._qty*this._pointvalue;if(t=this._qty<0?r:e*this._qty*this._pointvalue,"USD"!==this._currency){const e=this._tradingModel.currencyRate(this._currency);r*=e,t*=e}this._reverseCurrency&&(r/=e,t/=e,t+=r),isFinite(r)?(this.value=r,isFinite(t)?this.equity=t:this.equity=NaN,this._position.pl=r,this.onValueChanged.fire(this)):this.value=NaN}}function Fe(e,t){return new De(e,t)}var xe=r("E9hm");const Ue=[3,1,4];function Le(e){if(e in Ee)return Ee[e];throw new Error(e+" broker does not exist")}function Re({id:e,title:t,configFlags:o,demoAccountLink:s,logoUrl:a,logoBlackUrl:c,logoMiniUrl:l,note:u,cqgBrokerIdentifier:d,demoConnectionParams:p}){Object(i.a)({id:e,title:t,telemetryId:"CQG",configFlags:o,customNotificationFields:[],description:"",durations:n,demoAccountLink:s,logoUrl:a,logoBlackUrl:c,logoMiniUrl:l,note:u},function(e,t,o){let i;return i=(i,s)=>Promise.all([Promise.all([r.e(69),r.e("cqg")]).then(r.t.bind(null,"BNQL",7)),Promise.all([r.e(69),r.e("cqg")]).then(r.t.bind(null,"EG0v",7))]).then(([{default:r},{default:n}])=>{s(new r(i,e,t,n,o))}),i}(e,d,p))}function Ne(e){let t;return t=(t,o)=>Promise.all([r.e(301),r.e(313),r.e("forexcom")]).then(r.bind(null,"SaSR")).then(({Broker:r})=>{o(new r(t,e))}),t}function qe(e,t){let o;return o=(o,i)=>Promise.all([r.e(159),r.e(209),r.e("rest-broker")]).then(r.bind(null,"LRNa")).then(({Broker:r})=>{i(new r(o,e,Object.assign({},{configFlags:xe.b},t),null,Object(s.isFeatureEnabled)("trading-fast-renew-oauth-token")))}),o}window.setIBKRBaseUrl=e=>{void 0===e||""===e?localStorage.removeItem("ibkr-base-url"):localStorage.setItem("ibkr-base-url",e)},Object(i.a)({id:"Paper",title:"Paper Trading",configFlags:{authorizationType:"none",showQuantityInsteadOfAmount:!0,supportOrderBrackets:!0,supportPositionBrackets:!0,supportClosePosition:!1,supportPLUpdate:!0,supportNativeReversePosition:!0,supportDemoLiveSwitcher:!1,supportOrdersHistory:!0,supportPartialClosePosition:!0,showNotificationsLog:!1,supportExecutions:!0},customNotificationFields:["exp"],description:"",durations:[{name:Object(o.t)("DAY"),value:"DAY"},{name:Object(o.t)("WEEK"),value:"WEEK",default:!0},{name:Object(o.t)("MONTH"),value:"MONTH"},{name:Object(o.t)("GTD"),value:"GTD",hasDatePicker:!0,hasTimePicker:!0}],logoUrl:P,logoBlackUrl:Y,logoMiniUrl:Oe,note:"by TradingView"},function(){let e;return e=(e,t)=>Promise.all([r.e(78),r.e("paper")]).then(r.t.bind(null,"fLeA",7)).then(({default:r})=>{t(new r(e,Fe))}),e}());const Ve={supportOrderBrackets:!0,supportPositionBrackets:!0,authorizationType:"password",showQuantityInsteadOfAmount:!0,
supportLevel2Data:!0,supportPLUpdate:!0,supportStopLimitOrders:!0,supportSymbolSearch:!0,supportRealtimeDataCheck:!1,calculatePLUsingLast:!0,supportTrades:!0,supportCloseTrade:!1,supportOrdersHistory:!0,supportPartialClosePosition:!0,supportPartialCloseTrade:!0,supportTrailingStop:!0,supportModifyTrailingStop:!1,positionPLInInstrumentCurrency:!0,supportExecutions:!0};Re({id:"CQG",title:"CQG",configFlags:Ve,demoAccountLink:"https://demo.cqgtrader.com/DemoRequest/TradingView/",logoUrl:h,logoBlackUrl:L,logoMiniUrl:ce,note:"Multiple FCMs",cqgBrokerIdentifier:{salesSeries:null}}),Re({id:"AMP",title:Le("AMP").title,configFlags:Object.assign(Object.assign({},Ve),{supportVerifyLiveAccount:!0}),demoAccountLink:"https://vip.ampfutures.com/tradingview-demo",logoUrl:u,logoBlackUrl:F,logoMiniUrl:se,cqgBrokerIdentifier:a.CQGSeparatedBrokersMetainfo.AMP,demoConnectionParams:{clientId:"AMPConnect",privateLabel:"AMPConnect"}}),Object(s.isFeatureEnabled)("broker_IRONBEAM")&&Re({id:"IRONBEAM",title:Le("IRONBEAM").title,configFlags:Object.assign(Object.assign({},Ve),{supportVerifyLiveAccount:!0,supportDemoLiveSwitcher:!1}),logoUrl:v,logoBlackUrl:v,logoMiniUrl:ge,cqgBrokerIdentifier:a.CQGSeparatedBrokersMetainfo.IRONBEAM}),Object(s.isFeatureEnabled)("broker_TICKMILL")&&Re({id:"TICKMILL",title:Le("TICKMILL").title,configFlags:Object.assign(Object.assign({},Ve),{supportVerifyLiveAccount:!0,supportDemoLiveSwitcher:!1}),logoUrl:w,logoBlackUrl:X,logoMiniUrl:Se,cqgBrokerIdentifier:a.CQGSeparatedBrokersMetainfo.TICKMILL});const Ge={id:"limitPriceDistance",severity:"warning",options:{buyDirectionPips:4,sellDirectionPips:4}},Ke={id:"stopPriceDistance",severity:"warning",options:{buyDirectionPips:4,sellDirectionPips:4}};if(Object(s.isFeatureEnabled)("broker_OANDA")&&Object(i.a)({id:"OANDA",title:Le("OANDA").title,configFlags:{authorizationType:"oauth2-implicit-flow",supportOrderBrackets:!0,supportTrailingStop:!0,supportTrades:!0,supportCloseTrade:!0,supportTradeBrackets:!0,requiresFIFOCloseTrades:!0,fifoOnlyForSameQty:!0,supportClosePosition:!0,supportModifyDuration:!0,supportMultiposition:!0,supportPLUpdate:!0,supportSymbolSearch:!0,requiresTermsOfServiceConfirmation:!0,supportMargin:!0,supportUnhideSymbolSearchGroups:!0,supportPartialClosePosition:!0,supportPartialCloseTrade:!0,supportHowToUse:!0,supportDisplayBrokerNameInSymbolSearch:!1,supportExecutions:!0},description:"",customTermsOfServiceText:Object(o.t)("By checking this box, I confirm I've read the warning and terms of use, accept all risks, and acknowledge that the OANDA fxTrade system is the system of record for all transactions."),logoUrl:S,logoBlackUrl:H,logoMiniUrl:ke},function(){let e;return e=(e,t)=>r.e("oanda").then(r.bind(null,"27+/")).then(r=>{t(new r.Broker(e,Object(s.isFeatureEnabled)("trading-fast-renew-oauth-token"),Object(s.isFeatureEnabled)("oanda-european-accounts-warning")))}),e}()),Object(s.isFeatureEnabled)("broker_FOREXCOM")&&Object(i.a)({id:"FOREXCOM",title:Le("FOREXCOM").title,configFlags:{authorizationType:"password",supportClosePosition:!0,supportPLUpdate:!0,
supportOrderBrackets:!0,supportPositionBrackets:!0,supportMarketBrackets:!1,supportSymbolSearch:!0,supportTrades:!0,noAD:!0,showQuantityInsteadOfAmount:!0,supportDemoLiveSwitcher:!1,supportMargin:!0,supportTrailingStop:!0,supportPartialCloseTrade:!0,supportPartialClosePosition:!0,supportHowToUse:!0,supportDisplayBrokerNameInSymbolSearch:!1},customNotificationFields:["duration.datetime","duration.type"],description:"",durations:[{name:Object(o.t)("GTC"),value:"GTC"},{name:Object(o.t)("GTD"),value:"GTD",hasDatePicker:!0,hasTimePicker:!0},{name:Object(o.t)("GFD",{context:"good-for-day"}),value:"GFD"}],backendBrokerName:"forexcom-g2",logoUrl:f,logoBlackUrl:N,logoMiniUrl:ue},Ne({id:"FOREXCOM",title:Le("FOREXCOM").title,symbolSearchId:"FOREXCOM-G2"})),Object(s.isFeatureEnabled)("broker_WHSELFINVEST")&&Object(i.a)({id:"WHSELFINVEST",title:Le("WHSELFINVEST").title,telemetryId:"FOREXCOM",configFlags:{authorizationType:"password",supportClosePosition:!0,supportPLUpdate:!0,supportOrderBrackets:!0,supportPositionBrackets:!0,supportMarketBrackets:!1,supportSymbolSearch:!0,supportTrades:!0,showQuantityInsteadOfAmount:!0,supportDemoLiveSwitcher:!1,supportMargin:!0,supportPartialCloseTrade:!0,supportPartialClosePosition:!0},customNotificationFields:["duration.datetime","duration.type"],description:"",durations:[{name:Object(o.t)("GTC"),value:"GTC"},{name:Object(o.t)("GTT"),value:"GTD",hasDatePicker:!0,hasTimePicker:!0},{name:Object(o.t)("GTD",{context:"good-for-day"}),value:"GFD"}],logoUrl:A,logoBlackUrl:te,logoMiniUrl:je},Ne({id:"WHSELFINVEST",title:Le("WHSELFINVEST").title,symbolSearchId:"WHSELFINVEST"})),Object(s.isFeatureEnabled)("broker_FXCM")){const e={id:"FXCM",title:Le("FXCM").title,configFlags:{authorizationType:"oauth2-code-flow",supportOrderBrackets:!0,supportTradeBrackets:!0,supportStopLimitOrders:!0,supportTrades:!0,supportCloseTrade:!0,supportClosePosition:!0,supportReversePosition:!1,supportMultiposition:!0,supportDemoLiveSwitcher:!1,supportSymbolSearch:!0,supportHowToUse:!1,durationForMarketOrders:!0,supportUnhideSymbolSearchGroups:!0,supportPartialCloseTrade:!0,supportDisplayBrokerNameInSymbolSearch:!1},description:"",logoUrl:m,logoBlackUrl:q,logoMiniUrl:de,durations:[{name:"GTC",value:"GTC",supportedOrderTypes:Ue},{name:"GTD",value:"GTD",hasDatePicker:!0,hasTimePicker:!0,supportedOrderTypes:Ue},{name:"FOK",value:"FOK",supportedOrderTypes:[2]},{name:"IOK",value:"IOK",supportedOrderTypes:[2]}],orderRules:[Ge,Ke]};Object(i.a)(e,function(e){return(t,o)=>Promise.all([r.e("vendors"),r.e(159),r.e(209),r.e("fxcm")]).then(r.bind(null,"gncC")).then(r=>{o(new r.Broker(t,e,Object(s.isFeatureEnabled)("broker_FXCM_token_v2"),Object(s.isFeatureEnabled)("broker_FXCM_dev"),Object(s.isFeatureEnabled)("trading-fast-renew-oauth-token")))})}(e))}if(Object(s.isFeatureEnabled)("broker_PAPERREST")){const e={id:"PAPERREST",title:"Paper REST",configFlags:{supportExecutions:!0,authorizationType:"password",supportDemoLiveSwitcher:!1,supportNativeReversePosition:!1,supportPlaceOrderPreview:Object(s.isFeatureEnabled)("paperrest_preview"),
supportModifyOrderPreview:Object(s.isFeatureEnabled)("paperrest_preview"),supportTwoFactorAuthorization:Object(s.isFeatureEnabled)("paperrest_2fa")},description:"",logoUrl:P,logoBlackUrl:Y,logoMiniUrl:Oe};let t=window.TRADING_REST_SERVER_URL;0,Object(i.a)(e,qe(t,e))}if(Object(s.isFeatureEnabled)("broker_ALOR")){const e={id:"ALOR",title:Le("ALOR").title,configFlags:{authorizationType:"password",supportDemoLiveSwitcher:!1,supportLevel2Data:!0,supportSymbolSearch:!0},description:"",logoUrl:c,logoBlackUrl:B,logoMiniUrl:oe,locales:["ru"],loginPlaceholder:Object(o.t)("Account number")+": Pxxxxxx"},t=Object(s.isFeatureEnabled)("broker_ALOR_dev")?"https://tvcomdev.alorbroker.ru/tradingview/v1/":"https://tvcom.alorbroker.ru/tradingview/v1/";Object(i.a)(e,qe(t,e))}if(Object(s.isFeatureEnabled)("broker_MODAL")){const e={id:"MODAL",title:Le("MODAL").title,configFlags:{isSuspended:Object(s.isFeatureEnabled)("modal_suspend"),authorizationType:"password",supportDemoLiveSwitcher:!1,supportRealtimeDataCheck:!0,supportSymbolSearch:!0},description:"",logoUrl:y,logoBlackUrl:z,logoMiniUrl:_e,locales:["br"],suspendedLink:"https://www.tradingview.com/blog/pb/os-servicos-da-corretora-modalmais-estarao-pausados-para-manutencao-no-tradingview-a-partir-de-01-07-2019-12810/"},t=Object(s.isFeatureEnabled)("broker_MODAL_dev")?"https://tradingviewhmg.modalmais.com.br":"https://tradingview.modalmais.com.br";Object(i.a)(e,qe(t,e))}if(Object(s.isFeatureEnabled)("broker_IBROKER")){const e={id:"IBROKER",title:Le("IBROKER").title,configFlags:{authorizationType:"password",supportDemoLiveSwitcher:!1,supportRealtimeDataCheck:!0,supportSymbolSearch:!0,supportLevel2Data:!0,supportUnhideSymbolSearchGroups:!0},description:"",logoUrl:O,logoBlackUrl:W,logoMiniUrl:me,locales:["es","it"],symbolPrefix:"IBROKER"},t=Object(s.isFeatureEnabled)("broker_IBROKER_dev")?"https://beta.ibroker.es/tradingview/api":"https://www.ibroker.es/tradingview/api";Object(i.a)(e,qe(t,e))}if(Object(s.isFeatureEnabled)("broker_SAXOBANK")){const e={id:"SAXOBANK",title:Le("SAXOBANK").title,configFlags:{authorizationType:"oauth2-implicit-flow",supportDemoLiveSwitcher:!1,supportSymbolSearch:!0,supportModifyDuration:!0,requiresTermsOfServiceConfirmation:!0,passLocalesLangInOAuth:!0,supportVerifyLiveAccount:!0,supportReversePosition:!1,supportDisplayBrokerNameInSymbolSearch:!1},customTermsOfServiceText:Object(o.t)("By checking this box, I confirm I've read the warning and terms of use, accept all risks, and acknowledge that Saxo is the system of record for all transactions."),customNotificationFields:["duration.datetime","duration.type"],description:"",logoUrl:C,logoBlackUrl:Q,logoMiniUrl:ve,logoMiniBlackUrl:ye,customPositionColumnTitles:[{unrealizedPl:Object(o.t)("Trade P/L")}],isDevEnvironment:Object(s.isFeatureEnabled)("broker_SAXOBANK_dev"),symbolPrefix:"SAXO"},t=Object(s.isFeatureEnabled)("broker_SAXOBANK_dev")?"https://appsvc-nl2-simtest-tradingviewproxy.azurewebsites.net/api":"https://api.tradingview.saxo/api";Object(i.a)(e,qe(t,e))}if(Object(s.isFeatureEnabled)("broker_TRADOVATE")){
const e={id:"TRADOVATE",title:Le("TRADOVATE").title,configFlags:{authorizationType:"password",supportLevel2Data:!1,supportDemoLiveSwitcher:!1,supportSymbolSearch:!0,supportRealtimeDataCheck:!0,supportAddBracketsToExistingOrder:!1},description:"",logoUrl:E,logoBlackUrl:ee,logoMiniUrl:Te},t=Object(s.isFeatureEnabled)("broker_TRADOVATE_dev")?"https://tradingview-hub-d.tradovate.com/":" https://tradingview-hub.tradovate.com/";Object(i.a)(e,qe(t,e))}if(Object(s.isFeatureEnabled)("broker_TRADESTATION_V3")){const e=Ue.concat([2]),t={id:"TRADESTATION",title:Le("TRADESTATION").title,configFlags:{authorizationType:"oauth2-code-flow",supportDemoLiveSwitcher:!0,supportLevel2Data:!0,supportSymbolSearch:!0,supportDOM:!0,supportRealtimeDataCheck:!0,showIPAddressRestrictionMessage:!1,supportPlaceOrderPreview:!0,supportOrdersHistory:!0,supportStopOrders:!0,supportStopLimitOrders:!0,supportOrderBrackets:!0,supportPositionBrackets:!0,supportPLUpdate:!0,supportClosePosition:!0,supportNativeReversePosition:!0,closePositionCancelsOrders:!0,supportOnlyPairPositionBrackets:!0,durationForMarketOrders:!0,supportCryptoBrackets:!0,supportExecutions:!0},description:"",durations:[{name:"DAY",value:"DAY",default:!0,supportedOrderTypes:e},{name:"DAY+",value:"DYP",supportedOrderTypes:e},{name:"GTC",value:"GTC",supportedOrderTypes:e},{name:"GTC+",value:"GCP",supportedOrderTypes:e},{name:"GTD",value:"GTD",hasDatePicker:!0,hasTimePicker:!1,supportedOrderTypes:e},{name:"GTD+",value:"GDP",hasDatePicker:!0,hasTimePicker:!1,supportedOrderTypes:e},{name:"IOC",value:"IOC",supportedOrderTypes:e},{name:"FOK",value:"FOK",supportedOrderTypes:e},{name:"OPG",value:"OPG",supportedOrderTypes:[2]},{name:"CLO",value:"CLO",supportedOrderTypes:[2]},{name:"1 MIN",value:"1",supportedOrderTypes:e},{name:"3 MIN",value:"3",supportedOrderTypes:e},{name:"5 MIN",value:"5",supportedOrderTypes:e}],logoUrl:M,logoBlackUrl:Z,logoMiniUrl:we};Object(i.a)(t,function(e){let t;return t=(t,o)=>Promise.all([r.e(159),r.e(209),r.e("tradestation")]).then(r.bind(null,"FPIL")).then(({Broker:r})=>{o(new r(t,e,Object(s.isFeatureEnabled)("broker_TRADESTATION_V3_dev"),Object(s.isFeatureEnabled)("trading-fast-renew-oauth-token")))}),t}(t))}if(Object(s.isFeatureEnabled)("broker_DUMMY")){const e={id:"DUMMY",title:"Dummy Broker",description:"",configFlags:{authorizationType:"none",supportDemoLiveSwitcher:!1},logoUrl:"",logoBlackUrl:"",logoMiniUrl:""};Object(i.a)(e,function(e){return(t,o)=>Promise.all([Promise.all([r.e(340),r.e("dummy-broker")]).then(r.bind(null,"IW9Y")),Promise.all([r.e(340),r.e("dummy-broker")]).then(r.bind(null,"WDYX"))]).then(([{BrokerApiAdapter:r},{accountFactory:i,DummyAuthorizationProvider:s}])=>{{const n=t.getLogger(),a=new s(t.credentialsStorage,n);o(new r(t,n,a,i,e))}})}(e))}if(Object(s.isFeatureEnabled)("broker_IBKR")){const e={id:"IBKR",title:Le("IBKR").title,description:"",configFlags:{authorizationType:"oauth",supportDemoLiveSwitcher:!1,supportOrderBrackets:!0,supportStopLimitOrders:!0,durationForMarketOrders:!0,supportPartialClosePosition:!0,supportPlaceOrderPreview:!0,
supportRealtimeDataCheck:!0,supportSymbolSearch:!0,supportPLUpdate:!0,supportDisplayBrokerNameInSymbolSearch:!1,supportConfirmations:!0,positionPLInInstrumentCurrency:!0,supportCancellingBothBracketsOnly:!0,supportStopOrdersInBothDirections:!0,supportExecutions:!0,closePositionCancelsOrders:!1},durations:[{name:"Day",value:"DAY",default:!0},{name:"Good Till Cancel",value:"GTC"},{name:"At The Opening",value:"OPG",supportedOrderTypes:[1,2]}],logoUrl:I,logoBlackUrl:re,logoMiniUrl:Me,importantLoginScreenMessage:Object(o.t)("Data provided by GFIS")};Object(i.a)(e,function(e){return(t,o)=>Promise.all([Promise.all([r.e(159),r.e(340),r.e("ibkr")]).then(r.bind(null,"IW9Y")),Promise.all([r.e(159),r.e(340),r.e("ibkr")]).then(r.bind(null,"Z2bE")),Promise.all([r.e(159),r.e(340),r.e("ibkr")]).then(r.bind(null,"W5pM")),Promise.all([r.e(159),r.e(340),r.e("ibkr")]).then(r.bind(null,"akJN"))]).then(([{BrokerApiAdapter:r},i,n,a])=>{var c;{const l=t.getLogger(),u=Object(s.isFeatureEnabled)("broker_IBKR_dev"),d=Object(s.isFeatureEnabled)("trading-fast-renew-oauth-token"),p=null!==(c=localStorage.getItem("ibkr-base-url"))&&void 0!==c?c:"api.ibkr.com",h=u?`https://${p}/alpha/api/`:`https://${p}/v1/api/`,b=u?`wss://${p}/alpha/api/ws`:`wss://${p}/v1/api/ws`,f=new i.IBKRAuthorizationProvider(t.credentialsStorage,l,h,b,u,d);o(new r(t,l,f,(...e)=>i.accountFactory(h,...e),e,{realtime:1e3,orders:1e3,positions:1e3,pl:1e3,executions:1e3,summaryRow:1e4,summaryTable:1e4,equity:6e4},(...e)=>n.makeVerifyLiveAccountParams(h,...e),(...e)=>a.makeCheckRealtimeDataParams(h,...e)))}})}(e))}if(Object(s.isFeatureEnabled)("broker_ALPACA")){const e={id:"ALPACA",title:Le("ALPACA").title,configFlags:{authorizationType:"oauth2-implicit-flow",supportSymbolSearch:!0,supportDemoLiveSwitcher:!1,useSessionStorage:!0,supportDisplayBrokerNameInSymbolSearch:!1},description:"",isDevEnvironment:Object(s.isFeatureEnabled)("broker_ALPACA_dev"),logoUrl:l,logoBlackUrl:D,logoMiniUrl:ie},t=Object(s.isFeatureEnabled)("broker_ALPACA_dev")?"https://staging-api.tradetalk.us/tradingview/":"https://api.alpaca.markets/tradingview/";Object(i.a)(e,qe(t,e))}if(Object(s.isFeatureEnabled)("broker_GEMINI")){const e={id:"GEMINI",title:Le("GEMINI").title,configFlags:{authorizationType:"oauth2-implicit-flow",supportSymbolSearch:!0,supportDemoLiveSwitcher:!1,supportMarketOrders:!1,supportCryptoExchangeOrderTicket:!0,supportBalances:!0,supportDisplayBrokerNameInSymbolSearch:!1},description:"",logoUrl:g,logoBlackUrl:V,logoMiniUrl:pe,isDevEnvironment:Object(s.isFeatureEnabled)("broker_GEMINI_dev"),symbolPrefix:"GEMINI"},t=Object(s.isFeatureEnabled)("broker_GEMINI_dev")?"https://api.sandbox.gemini.com/v1/tradingview/":"https://api.gemini.com/v1/tradingview/";Object(i.a)(e,qe(t,e))}if(Object(s.isFeatureEnabled)("broker_CURRENCYCOM")){const e={id:"CURRENCYCOM",title:Le("CURRENCYCOM").title,configFlags:{authorizationType:"oauth2-implicit-flow",supportSymbolSearch:!0,supportDemoLiveSwitcher:!1,supportUnhideSymbolSearchGroups:!0},description:"",logoUrl:b,logoBlackUrl:R,logoMiniUrl:le,
isDevEnvironment:Object(s.isFeatureEnabled)("broker_CURRENCYCOM_dev"),symbolPrefix:"CURRENCYCOM"},t=Object(s.isFeatureEnabled)("broker_CURRENCYCOM_dev")?"https://test-crx-tradingview.backend.currency.com/":"https://crx-tradingview.backend.currency.com/";Object(i.a)(e,function(e,t){let o;return o=(o,i)=>Promise.all([r.e(159),r.e(209),r.e("rest-broker"),r.e("currency-com")]).then(r.bind(null,"EJmm")).then(({Broker:r})=>{i(new r(o,e,Object.assign({},{configFlags:xe.b},t),null,Object(s.isFeatureEnabled)("trading-fast-renew-oauth-token")))}),o}(t,e))}if(Object(s.isFeatureEnabled)("broker_HITBTC")){const e={id:"HITBTC",title:Le("HITBTC").title,configFlags:{authorizationType:"password",supportDemoLiveSwitcher:!1,supportSymbolSearch:!0,supportDisplayBrokerNameInSymbolSearch:!1},description:"",logoUrl:k,logoBlackUrl:K,logoMiniUrl:fe,loginPlaceholder:Object(o.t)("Public API key"),passwordPlaceholder:Object(o.t)("Private API key"),connectIssueSolutionId:43000578174,symbolPrefix:"HITBTC"},t="https://tv.hitbtc.com/";Object(i.a)(e,qe(t,e))}if(Object(s.isFeatureEnabled)("broker_CAPITALCOM")){const e={id:"CAPITALCOM",title:Le("CAPITALCOM").title,configFlags:{authorizationType:"oauth2-implicit-flow",supportSymbolSearch:!0,supportDemoLiveSwitcher:!1,supportUnhideSymbolSearchGroups:!0},description:"",logoUrl:d,logoBlackUrl:x,logoMiniUrl:ne,isDevEnvironment:Object(s.isFeatureEnabled)("broker_CAPITALCOM_dev"),symbolPrefix:"CAPITALCOM"},t=Object(s.isFeatureEnabled)("broker_CAPITALCOM_dev")?"https://test-tradingview.backend-capital.com/":"https://cc-tradingview.backend-capital.com/";Object(i.a)(e,qe(t,e))}if(Object(s.isFeatureEnabled)("broker_TIGER")){const e={id:"TIGER",title:Le("TIGER").title,configFlags:{authorizationType:"oauth2-implicit-flow",supportSymbolSearch:!0,supportDemoLiveSwitcher:!1,supportVerifyLiveAccount:!0},description:"",logoUrl:T,logoBlackUrl:$,logoMiniUrl:Pe,isDevEnvironment:Object(s.isFeatureEnabled)("broker_TIGER_dev")},t=Object(s.isFeatureEnabled)("broker_TIGER_dev")?"https://openapi-sandbox.itiger.com/api":"https://openapi.itiger.com/api";Object(i.a)(e,qe(t,e))}if(Object(s.isFeatureEnabled)("broker_GLOBALPRIME")){const e={id:"GLOBALPRIME",title:Le("GLOBALPRIME").title,configFlags:{authorizationType:"password",supportDemoLiveSwitcher:!1,supportRealtimeDataCheck:!0,supportSymbolSearch:!0,supportVerifyLiveAccount:!0,supportUnhideSymbolSearchGroups:!0,supportDisplayBrokerNameInSymbolSearch:!1},description:"",logoUrl:_,logoBlackUrl:G,logoMiniUrl:he,logoMiniBlackUrl:be,symbolPrefix:"GLOBALPRIME"},t=Object(s.isFeatureEnabled)("broker_GLOBALPRIME_dev")?"https://trading.traderevolution.com/tradingview/v1":"https://trading.globalprime.com/tradingview/v1";Object(i.a)(e,qe(t,e))}if(Object(s.isFeatureEnabled)("broker_CHAKA")){const e={id:"CHAKA",title:Le("CHAKA").title,configFlags:{authorizationType:"oauth2-implicit-flow",supportSymbolSearch:!0,supportDemoLiveSwitcher:!1,useSessionStorage:!0,supportDisplayBrokerNameInSymbolSearch:!1},description:"",isDevEnvironment:Object(s.isFeatureEnabled)("broker_CHAKA_dev"),logoUrl:p,
logoBlackUrl:U,logoMiniUrl:ae},t=Object(s.isFeatureEnabled)("broker_CHAKA_dev")?"https://staging-api.tradetalk.us/tradingview/":"https://api.alpaca.markets/tradingview/";Object(i.a)(e,qe(t,e))}if(Object(s.isFeatureEnabled)("broker_TIMEX")){const e={id:"TIMEX",title:Le("TIMEX").title,configFlags:{authorizationType:"password",supportDemoLiveSwitcher:!1,supportRealtimeDataCheck:!1,supportSymbolSearch:!0,supportVerifyLiveAccount:!0,supportDisplayBrokerNameInSymbolSearch:!1},description:"",logoUrl:j,logoBlackUrl:J,logoMiniUrl:Ce,loginPlaceholder:Object(o.t)("Key ID"),passwordPlaceholder:Object(o.t)("Key Secret"),symbolPrefix:"TIMEX"},t=Object(s.isFeatureEnabled)("broker_TIMEX_dev")?"https://plasma-relay-backend-dev.timex.io/tv":"https://plasma-relay-backend.timex.io/tv";Object(i.a)(e,qe(t,e))}},xfIE:function(e,t,r){e.exports=r.p+"a559dda455aa99c4bbe7f61b7fd192a5.svg"},xjTN:function(e,t,r){e.exports=r.p+"1e5c3fd85587ddd3ca67c93135d5c0d7.svg"},xlVz:function(e,t,r){e.exports=r.p+"c6c7a4872e6d190e4d99ab498fe63d9a.svg"},xtVx:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var o=r("txPx"),i=r("ogJP");const s=Object(o.getLogger)("Trading.CredentialsWebStorage");class n{constructor(e){this._storage=e}setItem(e,t){try{const r=Object(i.isObject)(t)?JSON.stringify(t):String(t);this._storage.setItem(e,r)}catch(r){s.logError(`Unable to save credentials using key ${e}: ${r.message}`)}}getItem(e,t=null){let r=t;const o=this._storage.getItem(e);if(null===o)return r;try{r=JSON.parse(o)}catch(i){r=o}return r}removeItem(e){this._storage.removeItem(e)}}},zcCV:function(e,t,r){e.exports=r.p+"c4004d5f3256240f7219bf70ac5f054b.svg"},zztK:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 17 17" width="17" height="17" fill="none"><path stroke="currentColor" stroke-width="1.2" d="M1 1l15 15m0-15L1 16"/></svg>'}}]);