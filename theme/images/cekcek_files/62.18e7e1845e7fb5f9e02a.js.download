(window.webpackJsonp=window.webpackJsonp||[]).push([[62],{R1FM:function(t,e,s){"use strict";s.d(e,"c",(function(){return a})),s.d(e,"b",(function(){return l})),s.d(e,"a",(function(){return c}));var n=s("XCam"),o=s("wVAQ"),r=s("lpuu"),i=s("p+vD");function a(t,e){return Object(o.fetch)(`/api/v1/symbols_list/colored/${t}/share/`,{method:"POST",body:JSON.stringify({shared:e}),headers:{"Content-Type":"application/json"}}).then(r.a).then(i.convertToMarkedSymbolList)}function l(t,e){return Object(o.fetch)(`/api/v1/symbols_list/custom/${t}/share/`,{method:"POST",body:JSON.stringify({shared:e}),headers:{"Content-Type":"application/json"}}).then(r.a).then(i.convertToCustomSymbolList)}function c(t){return Object(n.j)(t)?Object(o.fetch)("/api/v1/symbols_list/colored/"+t,{method:"GET"}).then(r.a):Object(o.fetch)("/api/v1/symbols_list/custom/"+t,{method:"GET"}).then(r.a)}},SGSq:function(t,e,s){"use strict";s.d(e,"b",(function(){return o})),s.d(e,"a",(function(){return r}));var n=s("+GxX");function o(){return"enable_non_unique_watch_sections"}function r(){return Object(n.isFeatureEnabled)("enable_non_unique_watch_sections")}},TsgZ:function(t,e,s){"use strict";s.d(e,"a",(function(){return d})),s.d(e,"b",(function(){return m}));var n=s("Eyy1"),o=s("IWXC"),r=s("1pWb"),i=s("8woN"),a=s("y8Ih"),l=s("fgbt"),c=s("bKsZ"),u=s("NP3r"),h=s("e3/o");const b=new Map;class d{constructor(t,e,s="watchlist"){this._symbolDataHandlers=new Map,this._fastSymbols=new Set,this._subscribedSymbols=new Set,this._subscriptionSet=new Set,this._cancelSubscriptionSet=new Set,this._quoteSessionDataHandler=t=>{const e=Object(n.ensureDefined)(t.symbolname),{filtered:s,keepSubscription:o}=this._applyDataFilters(t);o||this._unsubscribeSymbols([e]),this._lastSymbolData.set(e,s);const r=this._symbolDataHandlers.get(e);r&&r(s)},this._clientId=t,this._quoteSession=Object(o.getQuoteSessionInstance)(s),this._lastSymbolData=e||new Map}destroy(){const t=Array.from(this._subscribedSymbols);this._unsubscribeSymbols(t)}addFastSymbol(t){this._fastSymbols.has(t)||!this._subscribedSymbols.has(t)||Object(r.b)(t)||(this._fastSymbols.add(t),this._quoteSession.setFastSymbols(this._clientId,Array.from(this._fastSymbols)))}removeFastSymbol(t){this._fastSymbols.has(t)&&(this._fastSymbols.delete(t),this._quoteSession.setFastSymbols(this._clientId,Array.from(this._fastSymbols)))}addSymbolDataHandler(t,e){Object(r.b)(t)||this._symbolDataHandlers.set(t,e)}removeSymbolDataHandler(t){this._symbolDataHandlers.delete(t)}addToSubscriptionSet(t){t.forEach(t=>{Object(r.b)(t)||this._subscriptionSet.add(t)})}clearSubscriptionSet(){this._subscriptionSet.clear()}addToCancelSubscriptionSet(t){t.forEach(t=>{Object(r.b)(t)||this._cancelSubscriptionSet.add(t)})}commitSubscriptionChanges(){Array.from(this._subscriptionSet).forEach(t=>{this._cancelSubscriptionSet.has(t)&&(this._subscriptionSet.delete(t),this._cancelSubscriptionSet.delete(t))}),this._subscribeSymbols(Array.from(this._subscriptionSet)),this._subscriptionSet.clear(),this._unsubscribeSymbols(Array.from(this._cancelSubscriptionSet)),
this._cancelSubscriptionSet.clear(),this._quoteSession.setFastSymbols(this._clientId,Array.from(this._fastSymbols))}getLastSymbolData(t){return this._lastSymbolData.get(t)}getSymbolSnapshotForAll(t,e,s=Object(h.guid)()){const n=t.map(t=>this.getSymbolSnapshot(t,e,s));return Promise.all(n)}getSymbolSnapshot(t,e,s=Object(h.guid)()){if(Object(r.b)(t))return Promise.resolve(void 0);const n=this._lastSymbolData.get(t);return n&&"ok"===n.status&&(_(n,e)||n.complete)?Promise.resolve(n):new Promise(n=>{const o=this._clientId+"_snapshot_"+s,r=s=>{const{filtered:i,keepSubscription:a}=this._applyDataFilters(s);i&&"error"!==i.status&&this._lastSymbolData.set(t,i),(!a||_(i,e)||"error"===i.status||i.complete)&&(this._quoteSession.unsubscribe(o,t,r),n(i))};this._quoteSession.subscribe(o,t,r)})}getSymbolFullName(t){if(Object(r.b)(t))return Promise.resolve(t);if(b.has(t))return Object(n.ensureDefined)(b.get(t));const e=new Promise(e=>{const s=this._clientId+"_SymbolFullName",n=o=>{const r=o=>{this._quoteSession.unsubscribe(s,t,n),e(o)};o&&"ok"===o.status?o.values&&o.values.pro_name&&r(o.values.pro_name):r(t)};this._quoteSession.subscribe(s,t,n)});return b.set(t,e),e}getSymbolsFullNames(t){return Promise.all(t.map(t=>this.getSymbolFullName(t)))}getUniqueSymbolsFullNames(t){return this.getSymbolsFullNames(t).then(t=>Array.from(new Set(t)))}_subscribeSymbols(t){this._quoteSession.subscribe(this._clientId,t,this._quoteSessionDataHandler),t.forEach(t=>this._subscribedSymbols.add(t))}_unsubscribeSymbols(t){this._quoteSession.unsubscribe(this._clientId,t,this._quoteSessionDataHandler),t.forEach(t=>{this._subscribedSymbols.delete(t)})}_applyDataFilters(t){{const e=()=>Object(u.enabled)(c.ProductFeatures.IDC_AVAILABLE_DELAY),s=t=>Object.assign(Object.assign({},t),{status:"sf_data",values:{}});if((t=>Object(a.a)(t)||Object(l.a)(Object(i.getExchange)(Object(n.ensureDefined)(t.symbolname)),!0))(t)&&!e())return{filtered:s(t),keepSubscription:!1}}return{filtered:t,keepSubscription:!0}}}const m=new class{constructor(){this._adapters={},this._lastSymbolData=new Map}destroy(){Object.keys(this._adapters).forEach(t=>Object(n.ensureDefined)(this._adapters[t]).destroy()),this._lastSymbolData.clear()}get(t){return void 0===this._adapters[t]&&(this._adapters[t]=new d(t,this._lastSymbolData)),Object(n.ensureDefined)(this._adapters[t])}};function _(t,e){for(const s of Array.from(e))if(!t.values.hasOwnProperty(s))return!1;return!0}},ehHn:function(t,e,s){"use strict";s.d(e,"l",(function(){return m})),s.d(e,"o",(function(){return _})),s.d(e,"d",(function(){return y})),s.d(e,"a",(function(){return S})),s.d(e,"m",(function(){return f})),s.d(e,"b",(function(){return g})),s.d(e,"k",(function(){return p})),s.d(e,"e",(function(){return v})),s.d(e,"p",(function(){return C})),s.d(e,"h",(function(){return N})),s.d(e,"c",(function(){return D})),s.d(e,"q",(function(){return E})),s.d(e,"j",(function(){return P})),s.d(e,"n",(function(){return x})),s.d(e,"i",(function(){return L})),s.d(e,"g",(function(){return k})),s.d(e,"f",(function(){return T})),s.d(e,"r",(function(){
return q}));var n=s("Eyy1"),o=s("YFKU"),r=s("Kxc7"),i=s("fZEr"),a=s("TsgZ"),l=s("txPx"),c=s("8woN"),u=s("1pWb"),h=s("JWMC"),b=s("INgx"),d=s("tEuG");function m(t,e,s){return!("colored"===e&&!s)&&Object(u.b)(t)}function _(t){return t.replace(u.a,"")}function y(t){return u.a+t}function S(t,e,s=!0){const n=new Set(t),o=s?" 1":"";if(!n.has(e+o))return e+o;let r=2,i="";for(;r<=2e3&&(i=`${e} ${r}`,n.has(i));)r+=1;return i}const f=Object(l.getLogger)("Platform.Model.Watchlist");function g(){return r.enabled("multiple_watchlists")&&window.user&&Boolean(window.user.is_pro)}function p(t){return"string"==typeof t&&!/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F]/.test(t)&&!/^[\r\n\t,]*$/.test(t)}function v(t,e){return()=>new Promise(s=>{Object(i.showRename)({title:t,initValue:e,text:Object(o.t)("Symbol list name")+":",maxLength:128,onRename:({newValue:t,dialogClose:e})=>{s(t),e()}})})}function O(t){return t.replace("âˆ’","-")}function C(t,e,s,o){const r=function(t){const e=[],s=[];t.forEach((t,e)=>{Object(u.b)(t)&&s.push(e)});let n=0;s.forEach(s=>{e.push({values:t.slice(n,s),separator:t[s]}),n=s+1});const o=s[s.length-1],r=t.slice(o+1);return r.length>0&&e.push({values:r,separator:null}),e}(e);return r.forEach(e=>{e.values.sort((e,r)=>{if("flag"===s){const t=Object(d.a)().getSymbolColor(e),s=Object(d.a)().getSymbolColor(r);return Object(b.c)(o)(t,s)}const i=a.b.get(t).getLastSymbolData(e),l=a.b.get(t).getLastSymbolData(r),c=j(i),u=j(l),h=i&&"flag"!==s?i.values[s]:void 0,m=l&&"flag"!==s?l.values[s]:void 0;return function(t,e){const s=-1===e?-1/0:1/0;return(o,r,i,a)=>{if("rchp"!==t){if(void 0===o&&void 0===r)return 0;if(void 0===o)return-e;if(void 0===r)return e}switch(t){case"short_name":return e*(o===r?0:Object(n.ensureDefined)(o)<Object(n.ensureDefined)(r)?-1:1);case"rchp":return i||(o=void 0),a||(r=void 0),w(o,r,e,s);case"last_price":case"change":case"change_percent":return w(o,r,e,s);case"volume":{const t=Object(n.ensureDefined)(o)>=1e100?s:Number(o),i=Object(n.ensureDefined)(r)>=1e100?s:Number(r);return e*(t-i)}default:return Object(n.ensureDefined)(o)>Object(n.ensureDefined)(r)?-1:1}}}(s,o)(h,m,c,u)})}),function(t){const e=[];return t.forEach(({values:t,separator:s})=>{e.push(...t),null!==s&&e.push(s)}),e}(r)}function j(t){if(!t)return!1;const e="pre_market"===t.values.current_session,s="post_market"===t.values.current_session;return e||s}function w(t,e,s,n){let o=parseFloat(O(String(t))),r=parseFloat(O(String(e)));return o=isNaN(o)?n:o,r=isNaN(r)?n:r,s*(o-r)}function N(t){return"colored"===t.type?t.name||Object(b.b)(t.color):t.name}function D(t,e){return t===e||Object(c.shortName)(t)===e}function E(t){return{symbol:t.symbol,side:t.side,qty:t.qty,avgPrice:t.avgPrice}}function P(t,e){return t===e||void 0!==t&&void 0!==e&&(t.side===e.side&&t.qty===e.qty&&t.avgPrice===e.avgPrice&&t.symbol===e.symbol)}function x(t){try{return Object(c.shortName)(t)}catch(e){return t}}function L(t){const e=new Map;for(let s=0;s<t.length;s++){const o=t[s].toUpperCase(),r=x(o);if(e.has(r)){const t=Object(n.ensureDefined)(e.get(r))
;if(t.has(o)||t.has(r)||o===r)return!0;t.add(o),e.set(r,t)}else e.set(r,new Set([o]))}return!1}function k(t,e){if(e.includes(t))return t}function T(t,e,s){const n="next"===s;for(let o=t;n?o<e.length:o>=0;n?o++:o--)if(!Object(u.b)(e[o]))return e[o];for(let o=n?0:e.length-1;n?o<t:o>t;n?o++:o--)if(!Object(u.b)(e[o]))return e[o]}function q(t){t?Object(h.trackEvent)("Watchlist","Multi select","Remove"):Object(h.trackEvent)("Watchlist","Remove")}},lnbc:function(t,e,s){"use strict";s("bSeV");var n=s("Eyy1"),o=s("XCam"),r=s("u9Ke"),i=s("RwqP");class a{constructor(t){this._executing=null,this._destroyed=!1,this._handleChange=()=>{if(this._destroyed)return;const t=this._getCommands();if(t.length>0){if(null!==this._executing)return;const[e,...s]=t;switch(e.type){case"append":this._executing=this._api.appendSymbols(e.color,e.symbols);break;case"remove":this._executing=this._api.removeSymbols(e.color,e.symbols);break;case"replace":this._executing=this._api.replaceSymbols(e.color,e.symbols);break;case"reset":this._executing=this._api.resetSymbols(e.symbols);break;case"rename":this._executing=this._api.renameList(e.color,e.name);break;case"reset-all":this._executing=this._api.resetAll();break;case"share":this._executing=this._api.shareList(e.color,e.shared)}this._executing.then(()=>{if(this._executing=null,this._destroyed)return;const[t]=this._getCommands();t===e?this._store.dispatch(Object(o.s)({count:1})):(this._onWarn(`Command: ${JSON.stringify(e)} was sent to the server but is not found in the state`),s.length>0&&this._onWarn(`Commands: ${JSON.stringify(s)} was dropped from state without syncing with server`)),this._handleChange()},t=>{this._destroyed||this._onError(e,t)})}};const{root:e,selector:s,onError:n,onWarn:r,api:i}=t;this._store=e,this._selector=s,this._subscription=this._store.subscribe(this._handleChange),this._onError=n,this._onWarn=r,this._api=i,this._handleChange()}destroy(){this._subscription(),this._destroyed=!0}_getCommands(){const t=this._selector(this._store.getState());return Object(o.e)(t)}}var l=s("txPx"),c=s("wVAQ"),u=s("lpuu");var h=s("R1FM");const b=Object(l.getLogger)("MarkedSymbols.Api");class d{getLists(){return Object(c.fetch)("/api/v1/symbols_list/colored/").then(u.a)}removeSymbols(t,e){return 0===e.length?Promise.resolve():(b.logNormal(`Sending request to remove symbols from ${t}-list: ${e}`),function(t,e){return Object(c.fetch)(`/api/v1/symbols_list/colored/${t}/remove/`,{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then(u.a)}(t,e))}appendSymbols(t,e){return 0===e.length?Promise.resolve():(b.logNormal(`Sending request to append symbols to ${t}-list: ${e}`),function(t,e){return Object(c.fetch)(`/api/v1/symbols_list/colored/${t}/append/`,{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then(u.a)}(t,e))}replaceSymbols(t,e){return 0===e.length?Promise.resolve():(b.logNormal(`Sending request to replace symbols in ${t}-list: ${e}`),function(t,e){return Object(c.fetch)(`/api/v1/symbols_list/colored/${t}/replace/?unsafe=true`,{
method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then(u.a)}(t,e))}resetSymbols(t){return 0===t.length?Promise.resolve():(b.logNormal("Sending request to reset symbols: "+t),function(t){return Object(c.fetch)("/api/v1/symbols_list/colored/bulk_remove/",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then(u.a)}(t))}resetAll(){return b.logNormal("Sending request to reset ALL symbols"),Object(c.fetch)("/api/v1/symbols_list/colored/",{method:"DELETE"}).then(u.a)}renameList(t,e){return b.logNormal(`Sending request to rename ${t}-list: ${e}`),function(t,e){return Object(c.fetch)(`/api/v1/symbols_list/colored/${t}/rename/`,{method:"POST",body:JSON.stringify({name:e}),headers:{"Content-Type":"application/json"}}).then(u.a)}(t,e)}shareList(t,e){return b.logNormal(`Sending request to share ${t}-list: ${e}`),Object(h.c)(t,e).then(()=>{})}}var m=s("TxTq"),_=s.n(m),y=s("DJLU"),S=s("dm8g"),f=(s("NNtz"),s("J/x9")),g=s("ehHn"),p=s("IWXC"),v=s("NP3r"),O=s("bKsZ"),C=s("oOPW"),j=s("SGSq"),w=s("INgx");s.d(e,"d",(function(){return N})),s.d(e,"c",(function(){return T})),s.d(e,"a",(function(){return q})),s.d(e,"b",(function(){return A}));let N=500;const D=6e5,E=3e4,P=3e4;const x=Object(l.getLogger)("MarkedSymbols.Model");let L,k=null;function T(t){return t.markedLists}class q{constructor(t){var e,s;this._promise=Object(f.initSymbolListService)(),this._service=null,this._executor=null,this._subscription=null,this._state=null,this._sync=null,this._disconnectTimestamp=null,this._destroyed=!1,this._recover=!1,this._onPushStreamChange=t=>{window.user&&window.user.session_hash!==t?_.a.ownPushStream()?(x.logNormal("Cross browser sync"),this.syncSymbols()):x.logDebug("Sync skipped: on secondary tab"):x.logDebug("Sync skipped: session hash")},this._onPushStreamStatus=t=>{const e=Date.now();if(t===y.ConnectionStatus.Open&&k===y.ConnectionStatus.Closed){k=t;const s=null===this._disconnectTimestamp?0:e-this._disconnectTimestamp;if(this._disconnectTimestamp=null,!window.is_authenticated)return void x.logDebug("Sync skipped: is not authenticated");if(!_.a.ownPushStream())return void x.logDebug("Sync skipped: on secondary tab");if(s<D)return void x.logDebug("Sync skipped: short disconnection");L=setTimeout(()=>{const t=null!==this._state?Object(o.i)(this._state):null;null===t||t<e?(x.logNormal("Reconnect sync"),this.syncSymbols()):x.logNormal("Reconnect sync handled by another tab")},Math.random()*P+E)}else t===y.ConnectionStatus.Closed&&(this._disconnectTimestamp=Date.now(),k=t,clearTimeout(L))},this._handleChange=()=>{var t,e;if(this._destroyed)return;const{store:s}=Object(n.ensureNotNull)(this._service),o=Object(n.ensureNotNull)(T(s.getState()));if(this._state!==o)try{null===(e=(t=this._opts).onChange)||void 0===e||e.call(t,o,Object(n.ensureNotNull)(this._state))}finally{this._state=o}},this._handleExecutorError=t=>{this._destroyed||(x.logError("Failed to execute "+t.type),this._recover=!0,this.syncSymbols())},this._opts=t,this._api=t.api||new d,
this._session=t.quoteSession||Object(p.getQuoteSessionInstance)("simple"),this._restrictedMarkSymbols=function(t){const{limit:e,colors:s,onLimit:n,onRestrictedColor:a,selector:l}=t;return t=>(c,u)=>{var h,b;const d=u(),m=l(d),{color:_,symbols:y,separators:S}=t;if(null!==_){if(!s().includes(_))return void a();const t=null!==(b=null===(h=m.lists.byColor[_])||void 0===h?void 0:h.symbols)&&void 0!==b?b:[],o=new Set(t),l=r.a.castMany([]);for(const e of new Set(y))!S&&Object(i.b)(e)||o.has(e)||l.push(e);if(l.length+o.size>e())return void n()}c(Object(o.k)(t))}}({selector:t=>Object(n.ensureNotNull)(T(t)),limit:null!==(e=t.limit)&&void 0!==e?e:()=>N,onLimit:()=>{var t,e;x.logNormal("LimitReached"),null===(e=(t=this._opts).onLimit)||void 0===e||e.call(t)},colors:null!==(s=t.colors)&&void 0!==s?s:()=>o.a.filter(F),onRestrictedColor:()=>{var t,e;null===(e=(t=this._opts).onRestrictedColor)||void 0===e||e.call(t)}}),this._promise.then(t=>{if(this._destroyed)return;this._service=t;const{store:e}=t;this._state=Object(n.ensureNotNull)(T(e.getState())),this._subscription=e.subscribe(this._handleChange)}),this.connect()}destroy(){this._destroyed=!0,this._sync=null,this._subscription&&this._subscription(),this._executor&&this._executor.destroy(),this.closeConnection()}getSymbolsByColor(t){var e;if(null===this._service)return[];const{store:s}=this._service,n=T(s.getState());return null===n?[]:null!==(e=Object(o.h)(n,t))&&void 0!==e?e:[]}getLists(){return o.a.reduce((t,e)=>(t.set(e,new Set(this.getSymbolsByColor(e))),t),new Map)}setSymbolsColor(t,e){if(x.logNormal("Set symbols color "+e),null===this._service)return;const s=this._restrictedMarkSymbols({symbols:t,color:e,separators:!1});this._service.store.dispatch(s)}markMany(t){if(x.logNormal("Mark many symbols: "+t.color),null===this._service)return;const e=this._restrictedMarkSymbols(t);this._service.store.dispatch(e)}getSymbolColor(t){if(null===this._service)return null;const{store:e}=this._service,s=T(e.getState());if(null===s)return null;const n=Object(o.g)(s,t);return n&&!Object(w.d)(n)?null:n}clearAllSymbolsColor(){x.logNormal("Clear all symbols color"),null!==this._service&&this._service.store.dispatch(Object(o.p)({}))}syncSymbols(){if(null===this._sync){const t=this._sync=this._synchronize({assert:()=>{if(this._sync!==t)throw new Error("ROUTINE_CANCELLED")},cancel:()=>{this._sync=null}}).then(()=>{this._sync=null},t=>{throw this._sync=null,t})}return this._sync}activateSeparators(t){null!==this._service&&this._service.store.dispatch(Object(o.c)({value:t}))}anonymize(){null!==this._service&&this._service.store.dispatch(Object(o.q)({timestamp:Date.now(),lists:[],separators:Object(j.a)()}))}connect(){this._subscribeOnPushStream()}closeConnection(){this._unsubscribeOnPushStream()}_resolve(t){const e=new Set;for(const n of t)if(void 0!==n.symbols)for(const t of n.symbols){Object(g.n)(t)===t&&e.add(t)}const s=Array.from(e).map(t=>this._session.snapshot(t).then(e=>e.pro_name||t,()=>t).then(e=>[t,e]));return Promise.all(s).then(e=>{const s=new Map(e);return t.map(t=>{var e
;const n=null!==(e=t.symbols)&&void 0!==e?e:[];return{id:t.id,name:t.name,color:t.color,shared:t.shared,symbols:n.map(t=>{var e;return null!==(e=s.get(t))&&void 0!==e?e:t})}})})}_synchronize(t){return null!==this._executor&&(this._executor.destroy(),this._executor=null,x.logNormal("Executor was destroyed.")),Promise.all([this._api.getLists(),this._promise,this._recover?Object(S.a)("marked-symbols"):Promise.resolve()]).then(([e])=>(t.assert(),Promise.all([this._resolve(e),Promise.resolve(Date.now())]))).then(([e,s])=>{t.assert(),this._recover=!1;const{store:r}=Object(n.ensureNotNull)(this._service);null===this._executor&&this._createExecutor();const i=null!==this._state?Object(o.i)(this._state):null;if(null!==i&&i>=s)return;const a=Object(o.q)({lists:e.map(t=>{var e;return{name:null!==(e=t.name)&&void 0!==e?e:null,color:t.color,symbols:t.symbols,shared:t.shared}}),timestamp:s,separators:Object(j.a)()});r.dispatch(a)}).catch(t=>{if(!(t instanceof Error&&(x.logError("Sync symbols error: "+t.message),"ROUTINE_CANCELLED"===t.message)))throw t})}_createExecutor(){const{store:t}=Object(n.ensureNotNull)(this._service);this._executor=new a({root:t,selector:t=>Object(n.ensureNotNull)(T(t)),api:this._api,onError:this._handleExecutorError,onWarn:t=>{x.logWarn(t)}}),x.logNormal("Executor was created")}_subscribeOnPushStream(){_.a.on("marked-symbols",this._onPushStreamChange),_.a.onPrivateStatus(this._onPushStreamStatus)}_unsubscribeOnPushStream(){_.a.off("marked-symbols",this._onPushStreamChange),_.a.offStatus(this._onPushStreamStatus),clearTimeout(L),k=null}}function F(t){return o.b.Red===t||Object(v.enabled)(O.ProductFeatures.MULTIFLAGGED_SYMBOLS_LISTS)}function A(t){return!!F(t)||(Object(C.createGoProDialog)({feature:"flaggedSymbols"}),!1)}},tEuG:function(t,e,s){"use strict";s.d(e,"a",(function(){return d}));s("bSeV");var n=s("XCam"),o=s("YFKU"),r=s("lnbc"),i=s("brCa"),a=s("SGSq"),l=s("+GxX");class c{constructor(t){this._symbolChangeHandlers=new Map,this._listChangeHandlers=[],this._initHandlers=[],this._sync=null,this._inited=!1,this._handleChange=(t,e)=>{if(t.lists!==e.lists){this._listChangeHandlers.forEach(s=>{try{s(t,e)}catch(n){}});for(const[s,o]of Array.from(this._symbolChangeHandlers.entries())){const r=Object(n.g)(t,s),i=Object(n.g)(e,s);r!==i&&o.forEach(t=>{try{t(r,i)}catch(e){}})}}},this._onLoginStateChange=()=>{let t;this._model.closeConnection(),window.is_authenticated?(this._model.connect(),t=this._syncSymbols()):(this._model.anonymize(),this._inited=!1,t=Promise.resolve()),t.then(this._fireInit)},this._fireInit=()=>{this._initHandlers.forEach(t=>t())},this._runWithSync=t=>{this._sync?this._sync.then(t):t()},this._model=new r.a({api:t?t.api:void 0,quoteSession:t?t.quoteSession:void 0,onChange:this._handleChange,limit:null==t?void 0:t.limit,onLimit:h,colors:null==t?void 0:t.colors}),l.FeatureToggle.onFeaturesStateChanged().subscribe(this,()=>{this._model.activateSeparators(Object(a.a)())}),this._subscribeLoginStateChange(),this._syncSymbols().then(this._fireInit)}getSymbolsByColor(t){
return this._model.getSymbolsByColor(t)}setSymbolsColor(t,e){0!==t.length&&this._runWithSync(()=>{this._model.setSymbolsColor(t,e)})}getSymbolColor(t){return this._model.getSymbolColor(t)}markMany(t){this._runWithSync(()=>{this._model.markMany(t)})}clearAllSymbolsColor(){this._runWithSync(()=>{this._model.clearAllSymbolsColor()})}onSymbolChange(t,e){const s=this._symbolChangeHandlers.get(t);s?s.push(e):this._symbolChangeHandlers.set(t,[e])}offSymbolChange(t,e){const s=this._symbolChangeHandlers.get(t);if(s){const n=s.filter(t=>t!==e);n.length>0?this._symbolChangeHandlers.set(t,n):this._symbolChangeHandlers.delete(t)}}onListChange(t){this._listChangeHandlers.push(t)}offListChange(t){this._listChangeHandlers=this._listChangeHandlers.filter(e=>e!==t)}onInit(t){this._initHandlers.push(t)}offInit(t){this._initHandlers=this._initHandlers.filter(e=>e!==t)}destroy(){l.FeatureToggle.onFeaturesStateChanged().unsubscribeAll(this),this._model.closeConnection(),this._unsubscribeLoginStateChange()}isInited(){return this._inited}_subscribeLoginStateChange(){window.loginStateChange&&window.loginStateChange.subscribe(this,this._onLoginStateChange)}_unsubscribeLoginStateChange(){window.loginStateChange&&window.loginStateChange.unsubscribe(this,this._onLoginStateChange)}_syncSymbols(){if(window.is_authenticated){this._sync=this._model.syncSymbols();const t=()=>{this._sync=null,this._inited=!0};return this._sync.then(t).catch(t)}return Promise.resolve()}}let u=null;function h(){u||(u=Object(i.createNoticeDialog)({title:o.t("Issue With Flagging"),content:o.t("Unable to flag all selected symbols since it exceeds the maximum amount ({limit}).").format({limit:String(r.d)})}),u.then(t=>{t.on("afterClose",()=>{u=null}),t.open()}))}let b=null;function d(){return null===b&&(b=new c),b}}}]);