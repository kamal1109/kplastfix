(window.webpackJsonp=window.webpackJsonp||[]).push([["chart-widget-gui"],{"+jnJ":function(e,t,i){"use strict";i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return a}));i("YFKU"),i("EsMY");var s,o=i("m/cY"),l=i("Vdly");function n(e){return e===s.AlwaysOn||e===s.AlwaysOff?e:s.VisibleOnMouseOver}function a(e,t){let i,a;function r(){if(!i){i=Object(o.a)();let s=l.getValue(e);void 0===s&&void 0!==t&&(s=l.getValue(t)),i.setValue(n(s)),i.subscribe(i,t=>{l.setValue(e,n(t.value()))})}return i}return{property:r,availableValues:function(){return[{id:s.VisibleOnMouseOver,value:s.VisibleOnMouseOver,title:window.t("Visible on Mouse Over")},{id:s.AlwaysOn,value:s.AlwaysOn,title:window.t("Always Visible")},{id:s.AlwaysOff,value:s.AlwaysOff,title:window.t("Always Invisible")}]},actualBehavior:function(){if(!a){a=Object(o.a)();const e=r(),t=()=>{let t=e.value();t!==s.AlwaysOn&&t!==s.AlwaysOff&&(t=Modernizr.mobiletouch?s.AlwaysOn:s.VisibleOnMouseOver),a&&a.setValue(t)};e.subscribe(a,t),t()}return a}}}!function(e){e.AlwaysOn="alwaysOn",e.VisibleOnMouseOver="visibleOnMouseOver",e.AlwaysOff="alwaysOff"}(s||(s={}))},"/KDZ":function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var s=i("q1tI");class o extends s.PureComponent{constructor(e){super(e),this._handleChange=()=>{this.forceUpdate()},this.state={query:window.matchMedia(this.props.rule)}}componentDidMount(){this._subscribe(this.state.query)}componentDidUpdate(e,t){this.state.query!==t.query&&(this._unsubscribe(t.query),this._subscribe(this.state.query))}componentWillUnmount(){this._unsubscribe(this.state.query)}render(){return this.props.children(this.state.query.matches)}static getDerivedStateFromProps(e,t){return e.rule!==t.query.media?{query:window.matchMedia(e.rule)}:null}_subscribe(e){e.addListener(this._handleChange)}_unsubscribe(e){e.removeListener(this._handleChange)}}},"/NcV":function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14" width="14" height="14"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M5.5 1.5l5 5.5-5 5.5"/></svg>'},"1ANp":function(e,t,i){"use strict";i.d(t,"c",(function(){return o})),i.d(t,"d",(function(){return l})),i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return a}));var s=i("+jnJ");const o="NavigationButtons.visibility",{property:l,availableValues:n,actualBehavior:a}=Object(s.b)(o)},"1Wf8":function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M3.5 2.8a.7.7 0 0 0-.7.7V6H1.2V3.5a2.3 2.3 0 0 1 2.3-2.3h11a2.3 2.3 0 0 1 2.3 2.3V6h-1.6V3.5a.7.7 0 0 0-.7-.7h-11z" class="bracket-up"/><path fill="currentColor" d="M3.5 15.2a.7.7 0 0 1-.7-.7V12H1.2v2.5a2.3 2.3 0 0 0 2.3 2.3h11a2.3 2.3 0 0 0 2.3-2.3V12h-1.6v2.5a.7.7 0 0 1-.7.7h-11z" class="bracket-down"/></svg>'},"1pWb":function(e,t,i){"use strict";i.d(t,"b",(function(){return o}));var s=i("RwqP");function o(e){return Object(s.b)(e)}i.d(t,"a",(function(){return s.a}))},"2CEX":function(e,t){
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 22" width="24" height="22" fill="none"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M6 6.5A2.5 2.5 0 0 1 8.5 4H10v1H8.5C7.67 5 7 5.67 7 6.5v1.15a3.5 3.5 0 0 1-1.93 3.13l-.45.22.45.22A3.5 3.5 0 0 1 7 14.35v1.15c0 .83.67 1.5 1.5 1.5H10v1H8.5A2.5 2.5 0 0 1 6 15.5v-1.15a2.5 2.5 0 0 0-1.38-2.23l-1.34-.67a.5.5 0 0 1 0-.9l1.34-.67A2.5 2.5 0 0 0 6 7.65V6.5zM15.5 5H14V4h1.5A2.5 2.5 0 0 1 18 6.5v1.15c0 .94.54 1.8 1.38 2.23l1.34.67a.5.5 0 0 1 0 .9l-1.34.67A2.5 2.5 0 0 0 18 14.35v1.15a2.5 2.5 0 0 1-2.5 2.5H14v-1h1.5c.83 0 1.5-.67 1.5-1.5v-1.15a3.5 3.5 0 0 1 1.93-3.13l.45-.22-.45-.22A3.5 3.5 0 0 1 17 7.65V6.5c0-.83-.67-1.5-1.5-1.5z"/></svg>'},"5Alx":function(e,t,i){e.exports={marginlegendhoriz:"4px",legend:"legend-2KhwsEwE",item:"item-2KhwsEwE",withAction:"withAction-2KhwsEwE",selected:"selected-2KhwsEwE",last:"last-2KhwsEwE",text:"text-2KhwsEwE",noWrapWrapper:"noWrapWrapper-2KhwsEwE",noWrap:"noWrap-2KhwsEwE",series:"series-2KhwsEwE",valuesAdditionalWrapper:"valuesAdditionalWrapper-2KhwsEwE",valueItem:"valueItem-2KhwsEwE",valueTitle:"valueTitle-2KhwsEwE",valueValue:"valueValue-2KhwsEwE",valuesWrapper:"valuesWrapper-2KhwsEwE",directionColumn:"directionColumn-2KhwsEwE",titleWrapper:"titleWrapper-2KhwsEwE",button:"button-2KhwsEwE",statusesWrapper:"statusesWrapper-2KhwsEwE",buttonsWrapper:"buttonsWrapper-2KhwsEwE",buttons:"buttons-2KhwsEwE",noActions:"noActions-2KhwsEwE",title:"title-2KhwsEwE",title2nd:"title2nd-2KhwsEwE",disabled:"disabled-2KhwsEwE",withCustomTextColor:"withCustomTextColor-2KhwsEwE",study:"study-2KhwsEwE",title1st:"title1st-2KhwsEwE",hideValues:"hideValues-2KhwsEwE",has5Buttons:"has5Buttons-2KhwsEwE",stayInHoveredMode:"stayInHoveredMode-2KhwsEwE",withTail:"withTail-2KhwsEwE",loading:"loading-2KhwsEwE",loader:"loader-2KhwsEwE",withDot:"withDot-2KhwsEwE",title3rd:"title3rd-2KhwsEwE",title4th:"title4th-2KhwsEwE",miniHidden2Title:"miniHidden2Title-2KhwsEwE",microHidden2Title:"microHidden2Title-2KhwsEwE",hidden3Title:"hidden3Title-2KhwsEwE",flagged:"flagged-2KhwsEwE",medium:"medium-2KhwsEwE",minimized:"minimized-2KhwsEwE",micro:"micro-2KhwsEwE",onlyOneButtonCanBeStick:"onlyOneButtonCanBeStick-2KhwsEwE",touchMode:"touchMode-2KhwsEwE",buttonIcon:"buttonIcon-2KhwsEwE",flag:"flag-2KhwsEwE",invisibleHover:"invisibleHover-2KhwsEwE",eye:"eye-2KhwsEwE",hiddenLoading:"hiddenLoading-2KhwsEwE","eye-animation":"eye-animation-2KhwsEwE",markerContainer:"markerContainer-2KhwsEwE",flagWrapper:"flagWrapper-2KhwsEwE",sourcesWrapper:"sourcesWrapper-2KhwsEwE",newCollapser:"newCollapser-2KhwsEwE",sources:"sources-2KhwsEwE",toggler:"toggler-2KhwsEwE pane-button-xPfK7aM7",counter:"counter-2KhwsEwE",iconArrow:"iconArrow-2KhwsEwE",objectTree:"objectTree-2KhwsEwE",onlyOneSourceShown:"onlyOneSourceShown-2KhwsEwE",closed:"closed-2KhwsEwE",objectsTreeCanBeShown:"objectsTreeCanBeShown-2KhwsEwE"}},"61S9":function(e,t){
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 22" width="30" height="24" fill="none"><g fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" class="normal-eye"><path d="M18 7.91C16.7 6.5 14.7 5 12 5S7.3 6.49 6 7.91C6 7.91 4 10 4 11s2 3.09 2 3.09C7.3 15.5 9.3 17 12 17s4.7-1.49 6-2.91c0 0 2-2.09 2-3.09s-2-3.09-2-3.09zm-11.26 5.5C7.94 14.74 9.7 16 12 16s4.05-1.26 5.25-2.59c0 0 1.75-1.91 1.75-2.41 0-.5-1.75-2.41-1.75-2.41C16.05 7.26 14.3 6 12 6S7.95 7.26 6.74 8.59C6.74 8.59 5 10.5 5 11c0 .5 1.74 2.41 1.74 2.41z"/><path d="M12 13a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm0 1a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></g><g fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" class="crossed-eye"><path d="M8.85 16.27c.92.44 1.97.73 3.15.73 2.7 0 4.7-1.49 6-2.91 0 0 2-2.09 2-3.09s-2-3.09-2-3.09l-.39-.4-.7.7.34.38S19 10.5 19 11c0 .5-1.75 2.41-1.75 2.41C16.05 14.74 14.3 16 12 16c-.88 0-1.68-.18-2.4-.48l-.75.75zM7.1 13.78l-.36-.37S5 11.5 5 11c0-.5 1.74-2.41 1.74-2.41C7.94 7.26 9.7 6 12 6c.88 0 1.68.18 2.4.48l.75-.75A7.17 7.17 0 0 0 12 5C9.3 5 7.3 6.49 6 7.91 6 7.91 4 10 4 11s2 3.09 2 3.09l.39.4.7-.7z"/><path d="M11.22 13.9a3 3 0 0 0 3.68-3.68l-.9.9A2 2 0 0 1 12.13 13l-.9.9zm.66-4.9A2 2 0 0 0 10 10.88l-.9.9a3 3 0 0 1 3.68-3.68l-.9.9zM5.65 16.65l12-12 .7.7-12 12-.7-.7z"/></g><g class="loading-eye"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M18 7.91C16.7 6.5 14.7 5 12 5S7.3 6.49 6 7.91C6 7.91 4 10 4 11s2 3.09 2 3.09C7.3 15.5 9.3 17 12 17s4.7-1.49 6-2.91c0 0 2-2.09 2-3.09s-2-3.09-2-3.09zm-11.26 5.5C7.94 14.74 9.7 16 12 16s4.05-1.26 5.25-2.59c0 0 1.75-1.91 1.75-2.41 0-.5-1.75-2.41-1.75-2.41C16.05 7.26 14.3 6 12 6S7.95 7.26 6.74 8.59C6.74 8.59 5 10.5 5 11c0 .5 1.74 2.41 1.74 2.41z"/></g><g class="animated-loading-eye"><path stroke="currentColor" stroke-linecap="round" d="M14.5 11a2.5 2.5 0 1 0-2.5 2.5"/></g></svg>'},"6dGu":function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15"><path fill="currentColor" d="M3.5 5.58c.24-.28.65-.3.92-.07L7.5 8.14l3.08-2.63a.65.65 0 1 1 .84.98L7.5 9.86 3.58 6.49a.65.65 0 0 1-.07-.91z"/></svg>'},"94TV":function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14" width="14" height="14"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M6.5 1.5l5 5.5-5 5.5M3 4l2.5 3L3 10"/></svg>'},"956S":function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><circle fill="currentColor" cx="15" cy="9" r="1.5"/><circle fill="currentColor" cx="9" cy="9" r="1.5"/><circle fill="currentColor" cx="3" cy="9" r="1.5"/></svg>'},"9Crk":function(e,t){
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M13.4 5.9c-.41 1.62-1.16 2.43-2.25 2.43-.52 0-1.25-.15-2.2-.45-.93-.3-1.58-.45-1.96-.45-.55 0-.98.3-1.27.9H4.66c.1-.67.36-1.24.76-1.71.4-.48.86-.72 1.4-.72.56 0 1.31.16 2.27.46.95.3 1.62.45 2.01.45.64 0 1.06-.3 1.27-.9h1.03zm0 3.87c-.41 1.62-1.16 2.43-2.25 2.43-.52 0-1.25-.15-2.2-.45-.93-.3-1.58-.46-1.96-.46-.55 0-.98.3-1.27.9H4.66c.1-.67.36-1.24.76-1.7.4-.48.86-.72 1.4-.72.56 0 1.31.15 2.27.46.95.3 1.62.44 2.01.44.64 0 1.06-.3 1.27-.9h1.03z"/></svg>'},AH3n:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M13 12.78V5.22a.3.3 0 0 0-.51-.2L8.7 8.78a.3.3 0 0 0 0 .42L12.5 13a.3.3 0 0 0 .51-.21zM8 12.78V5.22a.3.3 0 0 0-.51-.2L3.7 8.78a.3.3 0 0 0 0 .42L7.5 13a.3.3 0 0 0 .51-.21z"/></svg>'},D8x7:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 22" width="24" height="22" fill="none"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M17.35 6.35l-10 10-.7-.7 10-10 .7.7z"/><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M6.65 6.35l10 10 .7-.7-10-10-.7.7z"/></svg>'},EV8o:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var s=i("ogJP");function o(e,t,i,o,l){const n=document.createElement("div");n.className=t,n.classList.toggle(o,!e.visible.value()),Object.assign(n.dataset,e.dataset),void 0!==e.className&&n.classList.add(e.className),void 0!==e.title&&(n.classList.add("apply-common-tooltip"),n.setAttribute("title",e.title.value()),void 0!==e.hotKeyTitle&&(n.dataset.tooltipHotkey=e.hotKeyTitle)),n.addEventListener("touchend",e.action),n.addEventListener("mousedown",t=>{0===t.button&&e.action(t)});const a=document.createElement("div");a.classList.add(i);const r=e.iconMap.get(l)||"";return Object(s.isString)(r)?a.innerHTML=r:a.appendChild(r),n.appendChild(a),n}},HDec:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 12" width="12" height="12" fill="none"><path fill="currentColor" d="M11.57 0H1a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h10.57a.5.5 0 0 0 .41-.78l-3.3-4.94a.5.5 0 0 1 0-.56l3.3-4.94a.5.5 0 0 0-.41-.78z"/></svg>'},"J/x9":function(e,t,i){"use strict";i.r(t);var s=i("eqEH");const o={id:"SymbolListService"};function l(){return Promise.all([Promise.all([i.e("vendors"),i.e(43),i.e(61),i.e(62),i.e(86),i.e(193),i.e(267),i.e("symbol-list-service")]).then(i.bind(null,"CqQ8")),Promise.all([i.e("vendors"),i.e(43),i.e(61),i.e(62),i.e(86),i.e(193),i.e(267),i.e("symbol-list-service")]).then(i.bind(null,"NyG/")),Promise.all([i.e("vendors"),i.e(43),i.e(61),i.e(62),i.e(86),i.e(193),i.e(267),i.e("symbol-list-service")]).then(i.bind(null,"aOxy")),Promise.all([i.e("vendors"),i.e(43),i.e(61),i.e(62),i.e(86),i.e(193),i.e(267),i.e("symbol-list-service")]).then(i.bind(null,"1O7s"))]).then(([e,t,i,l])=>{if(Object(s.hasService)(o))return Object(s.service)(o);const{store:n,runner:a}=e.configureStore(),r=a.run(t.symbolListRepositorySaga)
;return Object(s.registerService)(o,{store:n,runner:a,actions:{addSymbols:l.addSymbolsThunk,initWidget:i.initWidget,saveListAs:l.saveListAsThunk},task:r}),Object(s.service)(o)})}i.d(t,"initSymbolListService",(function(){return l}))},Jjb7:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M13.5 4.5l-9 9M4.5 4.5l9 9"/></svg>'},JmzL:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"/></svg>'},LIcf:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M7.9 5.87v2.17h3.07v1.4H7.9v2.8h4.22v1.46H6.25V4.4h5.94v1.47H7.9z"/></svg>'},M3mX:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M9 2.5c-1.06 0-1.88.93-1.75 1.98l.63 5.03a1.13 1.13 0 0 0 2.25 0l.62-5.03A1.77 1.77 0 0 0 9 2.5zm0 10a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3z"/></svg>'},MQEA:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 7" width="9" height="7"><path fill="currentColor" d="M8.5 3.5L5 0v3H0v1h5v3z"/></svg>'},MjtL:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14" width="14" height="14"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M8.5 1.5L3.5 7l5 5.5"/></svg>'},OJSF:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15"><path fill="currentColor" d="M11.65 12.35l-9-9 .7-.7 9 9-.7.7z"/><path fill="currentColor" d="M2.65 11.65l9-9 .7.7-9 9-.7-.7z"/></svg>'},PXSR:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15"><path fill="currentColor" d="M11.83 6.12l-.66.76L8 4.1V12H7V4.1L3.83 6.88l-.66-.76L7.5 2.34l4.33 3.78z"/></svg>'},QEZv:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15"><path fill="currentColor" d="M11.83 8.88l-.66-.76L8 10.9V3H7v7.9L3.83 8.12l-.66.76 4.33 3.78 4.33-3.78z"/></svg>'},RgOa:function(e,t){
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14" width="14" height="14" fill="none"><path fill="currentColor" fill-rule="evenodd" d="M8.63 1.08a2.04 2.04 0 0 1-3.26 0c-.51.14-1 .35-1.45.6l.01.2A2.05 2.05 0 0 1 1.7 3.93a6.1 6.1 0 0 0-.6 1.45 2.04 2.04 0 0 1 0 3.26c.13.51.34 1 .6 1.45l.2-.01a2.05 2.05 0 0 1 2.03 2.24c.45.26.94.47 1.45.6a2.04 2.04 0 0 1 3.26 0c.51-.13 1-.34 1.45-.6l-.01-.2a2.05 2.05 0 0 1 2.24-2.03c.26-.45.47-.94.6-1.45a2.04 2.04 0 0 1 0-3.26 6.1 6.1 0 0 0-.6-1.45 2.05 2.05 0 0 1-2.23-2.23 6.1 6.1 0 0 0-1.45-.6zM7.84.42c.17-.24.43-.47.72-.4.84.18 1.62.5 2.32.96.23.15.26.48.22.76a1.03 1.03 0 0 0 1.16 1.16c.28-.04.6-.01.76.22.45.7.78 1.48.97 2.32.06.29-.17.55-.41.72a1.02 1.02 0 0 0 0 1.68c.24.17.47.43.4.72a7.12 7.12 0 0 1-.96 2.32c-.15.23-.48.26-.76.22a1.03 1.03 0 0 0-1.17 1.01l.01.15c.04.28.01.6-.22.76-.7.45-1.48.78-2.32.97-.29.06-.55-.17-.72-.41a1.02 1.02 0 0 0-1.68 0c-.17.24-.43.47-.72.4a7.12 7.12 0 0 1-2.32-.96c-.23-.15-.26-.48-.22-.76v-.15a1.02 1.02 0 0 0-1.16-1c-.28.03-.6 0-.76-.23A7.12 7.12 0 0 1 0 8.56c-.06-.29.17-.55.41-.72a1.02 1.02 0 0 0 0-1.68c-.24-.17-.47-.43-.4-.72.18-.84.5-1.62.96-2.32.15-.23.48-.26.76-.22h.15a1.02 1.02 0 0 0 1-1.16c-.03-.28 0-.6.23-.76C3.82.53 4.6.2 5.44 0c.29-.06.55.17.72.41a1.02 1.02 0 0 0 1.68 0zM9 7a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm1 0a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/></svg>'},RspR:function(e,t,i){"use strict";i.d(t,"c",(function(){return l})),i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return a}));var s=i("+jnJ"),o=i("1ANp");const{property:l,availableValues:n,actualBehavior:a}=Object(s.b)("PaneButtons.visibility",o.c)},RwqP:function(e,t,i){"use strict";i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return o}));const s="###";function o(e){return e.startsWith(s)}},Sn4D:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var s=i("q1tI"),o=i.n(s),l=i("Eyy1"),n=i("TSYQ"),a=i("x0D+"),r=i("0YpW"),d=i("AiMB"),h=i("mkWe"),u=i("qFKp"),c=i("X0gx"),_=i("sHQ4");function p(e){const{position:t,onClose:i,children:p,className:b,theme:m=_}=e,g=Object(l.ensureNotNull)(Object(s.useContext)(h.a)),[w,v]=Object(s.useState)(0),y=Object(s.useRef)(null),S=Object(s.useContext)(c.a);return Object(s.useEffect)(()=>{var e;return null===(e=y.current)||void 0===e||e.focus({preventScroll:!0}),S.subscribe(g,i),Object(r.setFixedBodyState)(!0),u.CheckMobile.iOS()&&Object(a.disableBodyScroll)(Object(l.ensureNotNull)(y.current)),v(g.addDrawer()),()=>{S.unsubscribe(g,i);const e=g.removeDrawer();u.CheckMobile.iOS()&&Object(a.enableBodyScroll)(Object(l.ensureNotNull)(y.current)),0===e&&Object(r.setFixedBodyState)(!1)}},[]),o.a.createElement(d.a,null,o.a.createElement("div",{className:n(_.wrap,_["position"+t])},w===g.currentDrawer&&o.a.createElement("div",{className:_.backdrop,onClick:i}),o.a.createElement("div",{className:n(_.drawer,m.drawer,_["position"+t],b),ref:function(e){y.current=e},tabIndex:-1,onScroll:function(e){e.stopPropagation()},"data-name":e["data-name"]},p)))}},TGRH:function(e,t,i){"use strict";i.r(t),i.d(t,"ControlBarNavigation",(function(){
return k}));var s=i("Eyy1"),o=(i("YFKU"),i("1ANp")),l=i("Ialn"),n=i("gWrr"),a=i("/DW5"),r=i("qFKp"),d=i("JWMC"),h=i("Nkvk"),u=i("MjtL"),c=i("e8Rm"),_=i("e2QN"),p=i("vg09"),b=i("/NcV"),m=i("94TV"),g=i("qfuz"),w=i("MQEA"),v=i("eYcT"),y=i("nFx7");i("jrhZ");const S=Object(a.b)({keys:["Alt","R"],text:"{0} + {1}"}),f=Object(a.b)({keys:["Alt","Click","Alt","Enter"],text:"{0} + {1}, {2} + {3}"}),E=Object(a.b)({keys:[g],text:"{0}"}),M=Object(a.b)({keys:[w],text:"{0}"}),C=`<div class="control-bar-wrapper">\n\t<div class="control-bar control-bar--hidden">\n\t\t<div class="control-bar__group js-btn-group js-btn-group-zoom">\n\t\t\t<div class="control-bar__btn control-bar__btn--zoom-out apply-common-tooltip" title="${window.t("Zoom Out")}">\n\t\t\t\t${c}\n\t\t\t</div>\n\t\t\t<div class="control-bar__btn control-bar__btn--zoom-in apply-common-tooltip" title="${window.t("Zoom In")}">\n\t\t\t\t${p}\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="control-bar__group js-btn-group js-btn-group-maximize">\n\t\t\t<div class="control-bar__btn control-bar__btn--maximize apply-common-tooltip" title="${window.t("Maximize chart")}" data-tooltip-hotkey="${f}">\n\t\t\t\t${v}\n\t\t\t</div>\n\t\t\t<div class="control-bar__btn control-bar__btn--minimize js-hidden apply-common-tooltip" title="${window.t("Restore chart")}" data-tooltip-hotkey="${f}">\n\t\t\t\t${y}\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="control-bar__group js-btn-group js-btn-group-scroll">\n\t\t\t<div class="control-bar__btn control-bar__btn--move-left apply-common-tooltip" title="${window.t("Scroll to the Left")}" data-tooltip-hotkey="${E}">\n\t\t\t\t${u}\n\t\t\t</div>\n\t\t\t<div class="control-bar__btn control-bar__btn--move-right apply-common-tooltip" title="${window.t("Scroll to the Right")}" data-tooltip-hotkey="${M}">\n\t\t\t\t${b}\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="control-bar__group js-btn-group js-btn-group-reset-scale">\n\t\t\t<div class="control-bar__btn control-bar__btn--turn-button control-bar__btn--btn-hidden apply-common-tooltip js-btn-reset" title="${window.t("Reset Chart")}" data-tooltip-hotkey="${S}">\n\t\t\t\t${_}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>`,V=`<div class="control-bar control-bar__btn control-bar__btn--back-present control-bar__btn--btn-hidden apply-common-tooltip" title="${window.t("Scroll to the Most Recent Bar")}">\n\t${m}\n</div>`,x=r.CheckMobile.any(),T={zoomInOut:!0,maximize:!0,scrollLeftRight:!0,resetScale:!0,goToRealtime:!0};class k{constructor(e,t,i){this._widget=Object(s.ensureNotNull)(Object(n.parseHtml)(C).querySelector(".control-bar-wrapper")),this._controlBar=Object(s.ensureNotNull)(this._widget.querySelector(".control-bar")),this._back=Object(s.ensureNotNull)(Object(n.parseHtml)(V).querySelector(".control-bar__btn--back-present")),this._btnGroups=Array.from(this._controlBar.querySelectorAll(".js-btn-group")),this._backButtonVisible=!1,this._boundMouseHandler=null,this._chartModel=null,this._checkIntervalId=0,this._controlBarVisible=!1,this._priceAxisChanged=null,this._resetAvailabilityChanged=null,this._priceAxisName="right",
this._rafId=0,this._visibilityTypeProperty=null,this._boundUpdateMaximizeButtonsVisibility=this._updateMaximizeButtonsVisibility.bind(this),this._boundToggleFullscreenButtons=this._toggleFullscreenButtons.bind(this),this._paneWidth=0,this._leftPriceScaleWidth=0,this._rightPriceScaleWidth=0,this._chart=e,this._parent=t,this._options=Object.assign({},T,i),this._visibilityPrioritizedGroups=this._initGroupDescriptions(),this._init(),this._initHandlers(),this.updatePosition()}destroy(){if(null!==this._visibilityTypeProperty&&(this._visibilityTypeProperty.unsubscribe(this,this._onVisibilityTypeChange),this._visibilityTypeProperty=null),null!==this._boundMouseHandler&&(this._parent.removeEventListener("mousemove",this._boundMouseHandler,!1),this._parent.removeEventListener("mouseleave",this._boundMouseHandler,!1),this._boundMouseHandler=null),null!==this._priceAxisChanged&&(this._priceAxisChanged.unsubscribe(this,this._updateBackBtnPosition),this._priceAxisChanged=null),clearInterval(this._checkIntervalId),null!==this._resetAvailabilityChanged){this._resetAvailabilityChanged.unsubscribe(this,this._updateResetScalesButtonVisibility);const e=this._chart.getResizerDetacher();e.fullscreenable.unsubscribe(this._boundUpdateMaximizeButtonsVisibility),e.fullscreen.unsubscribe(this._boundToggleFullscreenButtons),this._resetAvailabilityChanged=null}this._chart=null}updatePosition(){const e=this._chart.paneWidgets();if(0===e.length)return;this._paneWidth=e[0].width(),this._leftPriceScaleWidth=this._chart.getPriceAxisMaxWidthByName("left"),this._rightPriceScaleWidth=this._chart.getPriceAxisMaxWidthByName("right");const t=this._chart.timeAxisHeight()+this._bottomMargin();this._widget.style.bottom=t+"px",this._back.style.bottom=t+"px",this._updateBtnGroupVisibility()}_bottomMargin(){var e;const t=this._chart.paneWidgets();return(null!==(e=this._chart.maximizedPaneWidget())&&void 0!==e?e:t[t.length-1]).containsMainSeries()?32:5}_init(){if(r.CheckMobile.any())for(const e of this._btnGroups)e.classList.add("js-hidden");this._buttons={zoomIn:this._widget.querySelector(".control-bar__btn--zoom-in"),zoomOut:this._widget.querySelector(".control-bar__btn--zoom-out"),moveLeft:this._widget.querySelector(".control-bar__btn--move-left"),moveRight:this._widget.querySelector(".control-bar__btn--move-right"),turn:this._widget.querySelector(".control-bar__btn--turn-button"),maximize:this._widget.querySelector(".control-bar__btn--maximize"),minimize:this._widget.querySelector(".control-bar__btn--minimize")},this._initVisibility(),this._parent.appendChild(this._widget),this._parent.appendChild(this._back),this._backButtonVisible=!1,this._priceAxisName=Object(l.isRtl)()?"left":"right",this._chart.withModel(this,()=>{this._chartModel=this._chart.model(),this._priceAxisChanged=this._chart.getPriceAxisWidthChangedByName(this._priceAxisName),this._resetAvailabilityChanged=this._chartModel.model().isScalesResetAvailableChanged(),this._priceAxisChanged.subscribe(this,this._updateBackBtnPosition),
this._resetAvailabilityChanged.subscribe(this,this._updateResetScalesButtonVisibility);const e=this._chart.getResizerDetacher();e.fullscreenable.subscribe(this._boundUpdateMaximizeButtonsVisibility),e.fullscreen.subscribe(this._boundToggleFullscreenButtons),this._updateMaximizeButtonsVisibility(),this._updateBackBtnPosition(),this._back.addEventListener("click",()=>{null!==this._chartModel&&this._chartModel.timeScale().scrollToRealtime(!0)}),this._checkIntervalId=setInterval(()=>this._check(),1e3)})}_initHandlers(){const e=Modernizr.mobiletouch?"touchstart":"mousedown",t=Modernizr.mobiletouch?["touchend"]:["mouseup","mouseout"];this._buttons.moveLeft.addEventListener(e,e=>{e.preventDefault(),this._chart.scrollHelper().moveByBar(1),this._trackEvent("Move Left")}),this._buttons.moveRight.addEventListener(e,e=>{e.preventDefault(),this._chart.scrollHelper().moveByBar(-1),this._trackEvent("Move Right")});for(const s of t)this._buttons.moveLeft.addEventListener(s,()=>this._chart.scrollHelper().stopMoveByBar()),this._buttons.moveRight.addEventListener(s,()=>this._chart.scrollHelper().stopMoveByBar());this._buttons.turn.addEventListener("click",e=>{e.preventDefault(),this._chart.GUIResetScales(),this._trackEvent("Reset to Default Settings")}),this._buttons.zoomOut.addEventListener("click",e=>{e.preventDefault(),null!==this._chartModel&&this._chartModel.zoomOut(),this._trackEvent("Zoom Out")}),this._buttons.zoomIn.addEventListener("click",e=>{e.preventDefault(),null!==this._chartModel&&this._chartModel.zoomIn(),this._trackEvent("Zoom In")}),this._buttons.maximize.addEventListener("click",e=>{e.preventDefault(),this._chart.setActive(!0),this._chart.getResizerDetacher().requestFullscreen(),this._trackEvent(" Maximize Chart")}),this._buttons.minimize.addEventListener("click",e=>{e.preventDefault(),this._chart.getResizerDetacher().exitFullscreen(),this._trackEvent(" Restore Chart")});const i=e=>e.addEventListener("contextmenu",e=>e.preventDefault());i(this._buttons.moveLeft),i(this._buttons.moveRight),i(this._buttons.turn),i(this._buttons.zoomOut),i(this._buttons.zoomIn),i(this._buttons.minimize),i(this._buttons.maximize)}_initGroupDescriptions(){return[{shouldBeHiddenOnMobile:!1,available:this._isMaximizeButtonAvailable.bind(this),className:"js-btn-group-maximize",element:this._getBtnGroup("js-btn-group-maximize"),totalWidth:50},{shouldBeHiddenOnMobile:!1,available:()=>this._options.resetScale,className:"js-btn-group-reset-scale",element:this._getBtnGroup("js-btn-group-reset-scale"),totalWidth:50},{shouldBeHiddenOnMobile:!0,available:()=>this._options.zoomInOut,className:"js-btn-group-zoom",element:this._getBtnGroup("js-btn-group-zoom"),totalWidth:86},{shouldBeHiddenOnMobile:!0,available:()=>this._options.scrollLeftRight,className:"js-btn-group-scroll",element:this._getBtnGroup("js-btn-group-scroll"),totalWidth:86}]}_check(){if(null===this._chartModel||!this._options.goToRealtime)return;const e=this._chartModel.timeScale().rightOffset()<0;e!==this._backButtonVisible&&(this._backButtonVisible=e,
this._back.classList.toggle("control-bar__btn--btn-hidden",!this._backButtonVisible))}_initVisibility(){this._visibilityTypeProperty=Object(o.a)(),this._visibilityTypeProperty.subscribe(this,this._onVisibilityTypeChange),this._onVisibilityTypeChange()}_onVisibilityTypeChange(){if(null===this._visibilityTypeProperty)return;const e=this._visibilityTypeProperty.value();"alwaysOn"===e||"alwaysOff"===e?(this._controlBarVisible="alwaysOn"===e,null!==this._boundMouseHandler&&(this._parent.removeEventListener("mousemove",this._boundMouseHandler,!1),this._parent.removeEventListener("mouseleave",this._boundMouseHandler,!1),this._boundMouseHandler=null)):(this._controlBarVisible=!1,this._boundMouseHandler||(this._boundMouseHandler=this._visibilityMouseHandler.bind(this),this._parent.addEventListener("mousemove",this._boundMouseHandler),this._parent.addEventListener("mouseleave",this._boundMouseHandler))),this._updateControlBarVisibility()}_visibilityMouseHandler(e){if(e.buttons)return;if(null!==this._chartModel&&this._chartModel.lineBeingCreated())return;let t="mouseleave"!==e.type;if("mousemove"===e.type){const i=this._widget.getBoundingClientRect(),s=100-this._bottomMargin();t=e.clientX>=i.left-100&&e.clientX<=i.right+100&&e.clientY>=i.top-s&&e.clientY<=i.bottom+100}this._controlBarVisible!==t&&(this._controlBarVisible=t,null===this._rafId&&(this._rafId=this._controlBar.ownerDocument.defaultView.requestAnimationFrame(this._updateControlBarVisibility.bind(this))))}_updateControlBarVisibility(){this._rafId=null,this._controlBar.classList.toggle("control-bar--hidden",!this._controlBarVisible)}_updateBackBtnPosition(){if("left"===this._priceAxisName||"right"===this._priceAxisName){const e=this._chart.getPriceAxisMaxWidthByName(this._priceAxisName)+14;e&&(this._back.style.marginRight=e+"px")}}_updateBtnGroupVisibility(){const e=this._leftPriceScaleWidth+this._paneWidth,t=(e+this._rightPriceScaleWidth)/2;let i=2*Math.min(e-t,t-this._leftPriceScaleWidth)-50-50,s=!1;for(const o of this._visibilityPrioritizedGroups){o.enoughSpaceForGroup=!1;o.available()&&(!x||!o.shouldBeHiddenOnMobile)&&(i-=o.totalWidth,o.enoughSpaceForGroup=i>=0&&!s,s=s||!o.enoughSpaceForGroup),!o.enoughSpaceForGroup!==o.element.classList.contains("js-hidden")&&o.element.classList.toggle("js-hidden",!o.enoughSpaceForGroup)}this._updateControlBarPosition()}_getBtnGroup(e){return Object(s.ensureDefined)(this._btnGroups.find(t=>t.classList.contains(e)))}_updateControlBarPosition(){const e=this._visibilityPrioritizedGroups.reduce((e,t)=>e+(t.enoughSpaceForGroup?t.totalWidth:0),0),t=(this._paneWidth+this._leftPriceScaleWidth+this._rightPriceScaleWidth)/2-Math.ceil(e/2);this._widget.style.left=t+"px"}_updateResetScalesButtonVisibility(){if(null===this._chartModel)return;const e=this._chartModel.model().isScalesResetAvailable();this._buttons.turn.classList.toggle("control-bar__btn--btn-hidden",!e)}_updateMaximizeButtonsVisibility(){this._updateBtnGroupVisibility()}_toggleFullscreenButtons(){const e=this._chart.getResizerDetacher().fullscreen.value()
;this._buttons.maximize.classList.toggle("js-hidden",e),this._buttons.minimize.classList.toggle("js-hidden",!e)}_isMaximizeButtonAvailable(){return!!this._options.maximize&&(!!this._chart.getResizerDetacher().fullscreenable.value()&&!h.mediaState.isPhoneSizeDevice())}_trackEvent(e){this._chart.onWidget()||Object(d.trackEvent)("Navigation button",e)}}},Tq3g:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M14.48 5.1c-.52 2.03-1.46 3.04-2.82 3.04-.64 0-1.55-.19-2.74-.56-1.17-.38-1.99-.57-2.46-.57-.69 0-1.22.37-1.58 1.13H3.55A4.3 4.3 0 0 1 4.5 6c.5-.6 1.08-.9 1.74-.9.7 0 1.65.2 2.84.58 1.2.37 2.04.55 2.52.55.8 0 1.32-.37 1.59-1.13h1.29zm0 4.84c-.52 2.02-1.46 3.03-2.82 3.03-.64 0-1.55-.19-2.74-.56-1.17-.38-1.99-.57-2.46-.57-.69 0-1.22.38-1.58 1.13H3.55a4.3 4.3 0 0 1 .95-2.14c.5-.6 1.08-.9 1.74-.9.7 0 1.65.2 2.84.58 1.2.37 2.04.56 2.52.56.8 0 1.32-.38 1.59-1.13h1.29z"/></svg>'},Uua9:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M7.65 5.16v2.68h3.78v1.73H7.65V13h5.19v1.8H5.62V3.35h7.3v1.8H7.65z"/></svg>'},VrXG:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M7.57 14.8H5.03V3.36c1.62-.05 2.64-.08 3.06-.08 1.66 0 2.98.49 3.96 1.47a5.23 5.23 0 0 1 1.47 3.88c0 4.11-1.99 6.17-5.95 6.17zm-.5-9.66v7.8c.32.04.67.06 1.05.06 1.03 0 1.83-.38 2.41-1.12.58-.75.88-1.79.88-3.13 0-2.44-1.14-3.67-3.42-3.67-.22 0-.53.02-.93.06z"/></svg>'},VrrN:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M7.84 13.7H5.78V4.4l2.48-.06c1.35 0 2.42.4 3.22 1.2.8.78 1.19 1.83 1.19 3.15 0 3.34-1.61 5.01-4.83 5.01zm-.41-7.85v6.35c.26.02.55.03.86.03.83 0 1.48-.3 1.95-.9.48-.6.72-1.46.72-2.54 0-2-.93-2.99-2.78-2.99-.18 0-.43.02-.75.05z"/></svg>'},WYzw:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M19.32 6H8.68A2.68 2.68 0 0 0 6 8.68V11h1V8.68C7 7.75 7.75 7 8.68 7h10.64c.93 0 1.68.75 1.68 1.68V11h1V8.68C22 7.2 20.8 6 19.32 6zM7 19.32c0 .93.75 1.68 1.68 1.68h10.64c.93 0 1.68-.75 1.68-1.68V17h1v2.32C22 20.8 20.8 22 19.32 22H8.68A2.68 2.68 0 0 1 6 19.32V17h1v2.32z"/></svg>'},X0gx:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var s=i("q1tI"),o=i.n(s),l=i("tWVy");const n=o.a.createContext(l.a)},"Y+EN":function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15"><path fill="currentColor" d="M7.23 2.58a.5.5 0 0 1 .54 0l5.5 3.5a.5.5 0 0 1 0 .84l-5.5 3.5a.5.5 0 0 1-.54 0l-5.5-3.5a.5.5 0 0 1 0-.84l5.5-3.5zM2.93 6.5L7.5 9.4l4.57-2.9L7.5 3.6 2.93 6.5z"/><path fill="currentColor" d="M1.58 9.23a.5.5 0 0 1 .69-.15L7.5 12.4l5.23-3.33a.5.5 0 0 1 .54.84l-5.5 3.5a.5.5 0 0 1-.54 0l-5.5-3.5a.5.5 0 0 1-.15-.69z"/></svg>'},YGQl:function(e,t){
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path stroke="currentColor" stroke-linecap="round" stroke-width="1.7" d="M12.5 5.5l-7 7m0-7l7 7"/></svg>'},ZKFq:function(e,t,i){e.exports={"css-value-pane-controls-padding-left":"1px","css-value-pane-controls-padding-right":"5px",paneControls:"paneControls-2fnY2ZKI",hasTopMargin:"hasTopMargin-2fnY2ZKI",hidden:"hidden-2fnY2ZKI",forceHidden:"forceHidden-2fnY2ZKI",button:"button-2fnY2ZKI pane-button-xPfK7aM7",buttonIcon:"buttonIcon-2fnY2ZKI",minimize:"minimize-2fnY2ZKI",newButton:"newButton-2fnY2ZKI",touchMode:"touchMode-2fnY2ZKI",maximize:"maximize-2fnY2ZKI","maximize-animation-up-bracket":"maximize-animation-up-bracket-2fnY2ZKI","maximize-animation-down-bracket":"maximize-animation-down-bracket-2fnY2ZKI","minimize-animation-up-bracket":"minimize-animation-up-bracket-2fnY2ZKI","minimize-animation-down-bracket":"minimize-animation-down-bracket-2fnY2ZKI",up:"up-2fnY2ZKI","up-animation":"up-animation-2fnY2ZKI",down:"down-2fnY2ZKI","down-animation":"down-animation-2fnY2ZKI",buttonsWrapper:"buttonsWrapper-2fnY2ZKI"}},bNWL:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 2 30 24" width="30" height="24" fill="none"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M15.82 14l5.36-5.36-.82-.82L15 13.18 9.64 7.82l-.82.82L14.18 14l-5.36 5.36.82.82L15 14.82l5.36 5.36.82-.82L15.82 14z"/></svg>'},dm8g:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));i("bSeV");var s=i("wVAQ"),o=i("txPx"),l=i("JWMC");const n=Object(o.getLogger)("User.Sync");function a(e){return`${e}_${window.user&&window.user.username||""}`}function r(e){return Object(s.fetch)("/u/sync/",{credentials:"same-origin"}).then(e=>e.json(),e=>{n.logError(e)}).then(t=>{t.is_authenticated!==window.is_authenticated&&(window.is_authenticated=t.is_authenticated,Object(l.trackEvent)("Sync User Data","Different Auth",a(e))),t.pro_plan!==window.user.pro_plan&&(window.user.pro_plan=t.pro_plan,t.pro_plan||(window.user.is_pro=void 0),Object(l.trackEvent)("Sync User Data","Different Pro Plan",a(e)))})}},e2QN:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 18" width="14" height="18"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2"><path d="M1 10a6 6 0 1 0 6-6H3"/><path d="M5 1L2.5 4 5 7"/></g></svg>'},e8Rm:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14" width="14" height="14"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M2 7h10"/></svg>'},eYcT:function(e,t){
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g class="corner-left-top"><path fill="currentColor" d="M6 9C6 7.89543 6.89543 7 8 7H10C10.5523 7 11 7.44772 11 8C11 8.55228 10.5523 9 10 9H8V11C8 11.5523 7.55228 12 7 12C6.44772 12 6 11.5523 6 11V9Z"/></g><g class="corner-right-top"><path fill="currentColor" d="M17 8C17 7.44772 17.4477 7 18 7H20C21.1046 7 22 7.89543 22 9V11C22 11.5523 21.5523 12 21 12C20.4477 12 20 11.5523 20 11V9H18C17.4477 9 17 8.55228 17 8Z"/></g><g class="corner-right-bottom"><path fill="currentColor" d="M21 16C21.5523 16 22 16.4477 22 17V19C22 20.1046 21.1046 21 20 21H18C17.4477 21 17 20.5523 17 20C17 19.4477 17.4477 19 18 19H20V17C20 16.4477 20.4477 16 21 16Z"/></g><g class="corner-left-bottom"><path fill="currentColor" d="M7 16C7.55228 16 8 16.4477 8 17V19H10C10.5523 19 11 19.4477 11 20C11 20.5523 10.5523 21 10 21H8C6.89543 21 6 20.1046 6 19V17C6 16.4477 6.44772 16 7 16Z"/></g></svg>'},fgbt:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));i("bSeV");function s(e,t=!1){if(e&&e.startsWith("exchange-"))return function(e,t=!1){const i=window.pro,s=i.getProduct(e);return!!i.isProductDefined(s)&&(t?!!s.idc_service_codes_delay:!!s.idc_service_codes)}(e,t);const i=(e||"").toLowerCase();return window.pro.getIDCExchanges(t).includes(i)}},fk9O:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M13.5 6.35l6.32 5.27-.64.76L14 8.07V21h-1V8.07l-5.18 4.31-.64-.76 6.32-5.27z"/></svg>'},gKdq:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M14 7v12.93l5.18-4.31.64.76-6.32 5.27-6.32-5.27.64-.76L13 19.93V7h1z"/></svg>'},i9xP:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15"><circle fill="currentColor" cx="12.75" cy="7.5" r="1.25"/><circle fill="currentColor" cx="7.5" cy="7.5" r="1.25"/><circle fill="currentColor" cx="2.25" cy="7.5" r="1.25"/></svg>'},jrhZ:function(e,t,i){e.exports={"animation-minimize-corner-left-top":"animation-minimize-corner-left-top-1yUqeyiZ","animation-minimize-corner-right-top":"animation-minimize-corner-right-top-1yUqeyiZ","animation-minimize-corner-right-bottom":"animation-minimize-corner-right-bottom-1yUqeyiZ","animation-minimize-corner-left-bottom":"animation-minimize-corner-left-bottom-1yUqeyiZ","animation-maximize-corner-left-top":"animation-maximize-corner-left-top-1yUqeyiZ","animation-maximize-corner-right-top":"animation-maximize-corner-right-top-1yUqeyiZ","animation-maximize-corner-right-bottom":"animation-maximize-corner-right-bottom-1yUqeyiZ","animation-maximize-corner-left-bottom":"animation-maximize-corner-left-bottom-1yUqeyiZ"}},ku84:function(e,t){
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15" fill="none"><path fill="currentColor" d="M4.5 12A1.5 1.5 0 0 1 3 10.5V9H2v1.5A2.5 2.5 0 0 0 4.5 13h6a2.5 2.5 0 0 0 2.5-2.5V9h-1v1.5c0 .83-.67 1.5-1.5 1.5h-6z" class="bracket-up"/><path fill="currentColor" d="M4.5 3C3.67 3 3 3.67 3 4.5V6H2V4.5A2.5 2.5 0 0 1 4.5 2h6A2.5 2.5 0 0 1 13 4.5V6h-1V4.5c0-.83-.67-1.5-1.5-1.5h-6z" class="bracket-down"/></svg>'},lpuu:function(e,t,i){"use strict";function s(e){return e.ok?204===e.status?Promise.resolve():e.json():e.json().then(e=>{throw new Error(e.detail||"not ok")})}i.d(t,"a",(function(){return s}))},lvAK:function(e,t,i){"use strict";i.r(t);var s=i("RspR"),o=i("3ClC"),l=(i("LVLx"),i("Eyy1")),n=i("eJTA"),a=i("+jnJ"),r=i("AvGy"),d=i("+GxX"),h=i("EV8o"),u=i("ZKFq"),c=i("0jws");const _=Object(d.isFeatureEnabled)("lower_legend_collapser");class p{constructor(e,t,i){this._parentEl=document.createElement("div"),this._listActionsWrapperEl=null,this._listActionsElements={},this._actionsSpawns={},this._onMouseEnterLeaveEventHandler=null,this._mouseOverWidget=!1,this._wrapEl=e,this._onMouseEnterLeaveEventHandler=this._onMouseEnterLeaveEvent.bind(this),this._wrapEl.addEventListener("mouseenter",this._onMouseEnterLeaveEventHandler),this._wrapEl.addEventListener("mouseleave",this._onMouseEnterLeaveEventHandler),this._actions=t,this._globalVisibility=i.globalVisibility.spawn(),this._globalVisibility.subscribe(this._updatePaneControlsWidgetVisibility.bind(this)),this._visibilityType=i.visibilityType.spawn(),this._visibilityType.subscribe(this._updatePaneControlsWidgetVisibility.bind(this)),this._doNotSwitchToContextMenuMode=i.doNotSwitchToContextMenuMode,this._themedColor=i.themedColor.spawn(),this._themedColor.subscribe(this._updateThemedColor.bind(this));for(const[s,o]of Object.entries(this._actions)){const e=s;this._actionsSpawns[e]={visible:o.visible.spawn(),title:void 0===o.title?null:o.title.spawn()},this._actionsSpawns[e].visible.subscribe(this._updateActionVisibilities.bind(this,e));const t=this._actionsSpawns[e].title;null!==t&&t.subscribe(this._updateActionTitle.bind(this,e))}this._render(),this._updatePaneControlsWidgetVisibility(),this._updateThemedColor(this._themedColor.value()),this._parentEl.classList.toggle(u.touchMode,r.a),this._parentEl.addEventListener("contextmenu",e=>e.preventDefault())}destroy(){this._visibilityType.destroy(),this._themedColor.destroy();for(const e of Object.keys(this._actionsSpawns)){const t=e;this._actionsSpawns[t].visible.destroy();const i=this._actionsSpawns[t].title;null!==i&&i.destroy()}null!==this._onMouseEnterLeaveEventHandler&&(this._wrapEl.removeEventListener("mouseenter",this._onMouseEnterLeaveEventHandler),this._wrapEl.removeEventListener("mouseleave",this._onMouseEnterLeaveEventHandler),this._onMouseEnterLeaveEventHandler=null),this._parentEl.innerHTML="",delete this._parentEl}getElement(){return this._parentEl}updateWidgetModeByWidth(e){
const t=!this._doNotSwitchToContextMenuMode.value()&&e<356,i=!this._doNotSwitchToContextMenuMode.value()&&e<666.65,s=Object(l.ensureNotNull)(this._listActionsWrapperEl),o=Object(l.ensureNotNull)(this._listActionsElements.more);s.classList.toggle(c.blockHidden,t||i),o.classList.toggle(c.blockHidden,t||!i||!this._actions.more.visible.value())}_render(){this._renderActions(),this._parentEl.classList.add(u.paneControls),this._wrapEl.append(this._parentEl)}_renderActions(){null===this._listActionsWrapperEl&&(this._listActionsWrapperEl=document.createElement("div"),this._listActionsWrapperEl.classList.add(u.buttonsWrapper),this._parentEl.append(this._listActionsWrapperEl));const e=r.a?"large":"small";if(this._listActionsElements.up=Object(h.a)(this._actions.up,u.button,u.buttonIcon,c.blockHidden,e),this._listActionsElements.down=Object(h.a)(this._actions.down,u.button,u.buttonIcon,c.blockHidden,e),this._listActionsElements.close=Object(h.a)(this._actions.close,u.button,u.buttonIcon,c.blockHidden,e),this._listActionsElements.maximize=Object(h.a)(this._actions.maximize,u.button,u.buttonIcon,c.blockHidden,e),this._listActionsElements.minimize=Object(h.a)(this._actions.minimize,u.button,u.buttonIcon,c.blockHidden,e),this._listActionsWrapperEl.append(this._listActionsElements.up,this._listActionsElements.down,this._listActionsElements.close,this._listActionsElements.maximize,this._listActionsElements.minimize),this._listActionsElements.more=Object(h.a)(this._actions.more,u.button,u.buttonIcon,c.blockHidden,e),_)for(const t of Object.keys(this._listActionsElements))Object(l.ensureNotNull)(this._listActionsElements[t]).classList.add(u.newButton);this._parentEl.append(this._listActionsElements.more)}_updateActionVisibilities(e,t){Object(l.ensureNotNull)(this._listActionsElements[e]).classList.toggle(c.blockHidden,!t)}_updateActionTitle(e,t){Object(l.ensureNotNull)(this._listActionsElements[e]).setAttribute("title",t)}_onMouseEnterLeaveEvent(e){this._mouseOverWidget="mouseenter"===e.type,this._visibilityType.value()===a.a.VisibleOnMouseOver&&this._updatePaneControlsWidgetVisibility()}_updatePaneControlsWidgetVisibility(){let e,t=!1;switch(this._visibilityType.value()){case a.a.AlwaysOff:e=!1,t=!0;break;case a.a.AlwaysOn:e=this._globalVisibility.value();break;case a.a.VisibleOnMouseOver:e=this._globalVisibility.value()&&this._mouseOverWidget}this._parentEl.classList.toggle(u.hidden,!e),this._parentEl.classList.toggle(u.forceHidden,!this._globalVisibility.value()||t)}_updateThemedColor(e){if(e.length>0)if(_){const[t,i,s]=Object(n.parseRgb)(e);this._parentEl.style.color=Object(n.rgbaToString)([t,i,s,Object(n.normalizeAlphaComponent)(.8)])}else this._parentEl.style.color=e;else this._parentEl.style.removeProperty("color")}}var b=i("7KDR"),m=i("5VQP"),g=i("obM5"),w=i("fk9O"),v=i("gKdq"),y=i("WYzw");function S(e,t){const i=Object(l.ensureNotNull)(t.target);return function(e){const t=[];if(e.maximize.visible.value()){const i=Object(l.ensure)(e.maximize.title),s=Object(l.ensureNotNull)(e.maximize.action);t.push(new b.Action({icon:y,
label:i.value(),statName:"Maximize Pane",shortcutHint:f,onExecute:()=>s()}))}else if(e.minimize.visible.value()){const i=Object(l.ensure)(e.minimize.title),s=Object(l.ensureNotNull)(e.minimize.action);t.push(new b.Action({icon:y,label:i.value(),statName:"Minimize Pane",shortcutHint:f,onExecute:()=>s()}))}if(e.up.visible.value()){const i=Object(l.ensure)(e.up.title),s=Object(l.ensureNotNull)(e.up.action);t.push(new b.Action({icon:w,label:i.value(),statName:"Move pane up",onExecute:()=>s()}))}if(e.down.visible.value()){const i=Object(l.ensure)(e.down.title),s=Object(l.ensureNotNull)(e.down.action);t.push(new b.Action({icon:v,label:i.value(),statName:"Move pane down",onExecute:()=>s()}))}if(e.close.visible.value()){const i=Object(l.ensure)(e.close.title),s=Object(l.ensureNotNull)(e.close.action);t.push(new b.Action({icon:g,label:i.value(),statName:"Delete pane",onExecute:()=>s()}))}return m.ContextMenuManager.createMenu(t)}(e).then(e=>(e.show(e=>{const t=i.getBoundingClientRect();return{clientX:t.right-e,clientY:t.top+t.height+3}}),e))}const f=window.t("Double click");var E=i("hY0g"),M=i.n(E),C=i("EsvI"),V=i("/DW5"),x=i("OJSF"),T=i("PXSR"),k=i("QEZv"),O=i("ku84"),L=i("i9xP"),W=i("1Wf8"),A=i("956S");i.d(t,"PaneControlsWidget",(function(){return F}));const H=Modernizr.mobiletouch,B=window.t("Delete pane"),P=window.t("Move pane up"),j=window.t("Move pane down"),D=window.t("Maximize pane"),z=window.t("Restore pane"),N=window.t("Manage panes"),I=window.t("Double click"),R=Object(V.b)({keys:[""],text:I});class F{constructor(e,t,i,o,l){this._actions={},this._moreActionCM=null,this._themedColor=new M.a(""),this._model=e,this._paneWidget=t,this._callbacks=o,this._closeButtonVisibility=new M.a(this._getCloseButtonVisibility()),this._upButtonVisibility=new M.a(this._getUpButtonVisibility()),this._downButtonVisibility=new M.a(this._getDownButtonVisibility()),this._maximizeButtonVisibility=new M.a(this._getMaximizeButtonVisibility()),this._minimizeButtonVisibility=new M.a(this._getMinimizeButtonVisibility()),this._createActions(),this._visibilityTypeProperty=Object(s.a)(),this._visibilityTypeProperty.subscribe(this,e=>{this._visibilityType.setValue(e.value())}),this._visibilityType=new M.a(this._visibilityTypeProperty.value()),this._isPaneMaximize=new M.a(this._getIsPaneMaximizeValue()),this._isWidgetShow=new M.a(this._getIsWidgetShow()),this._backgroundThemeName=i.backgroundThemeName,this._renderer=new p(l,this._actions,{visibilityType:this._visibilityType.readonly(),globalVisibility:this._isWidgetShow.readonly(),doNotSwitchToContextMenuMode:this._isPaneMaximize.readonly(),themedColor:this._themedColor.readonly()})}destroy(){this._visibilityTypeProperty.unsubscribeAll(this),this._renderer.destroy()}getElement(){return this._renderer.getElement()}action(){return this._actions}update(){this._updateButtonsVisibility(),this._isPaneMaximize.setValue(this._getIsPaneMaximizeValue()),this._isWidgetShow.setValue(this._getIsWidgetShow())}updateWidgetModeByWidth(e){this._renderer.updateWidgetModeByWidth(e)}updateThemedColors(e){
null===e&&(e=Object(C.getStdThemedValue)("chartProperties.paneProperties.background",this._backgroundThemeName.value())),this._themedColor.setValue(e||"")}_updateButtonsVisibility(){this._closeButtonVisibility.setValue(this._getCloseButtonVisibility()),this._upButtonVisibility.setValue(this._getUpButtonVisibility()),this._downButtonVisibility.setValue(this._getDownButtonVisibility()),this._maximizeButtonVisibility.setValue(this._getMaximizeButtonVisibility()),this._minimizeButtonVisibility.setValue(this._getMinimizeButtonVisibility())}_createActions(){this._actions.up={iconMap:new Map([["large",T],["small",T]]),action:this._onUpDownButton.bind(this,"up"),visible:this._upButtonVisibility,title:new M.a(P),className:u.up,dataset:{name:"pane-button-up"}},this._actions.down={iconMap:new Map([["large",k],["small",k]]),action:this._onUpDownButton.bind(this,"down"),visible:this._downButtonVisibility,title:new M.a(j),className:u.down,dataset:{name:"pane-button-down"}},this._actions.close={iconMap:new Map([["large",x],["small",x]]),action:this._onCloseButton.bind(this),visible:this._closeButtonVisibility,title:new M.a(B),dataset:{name:"pane-button-close"}},this._actions.maximize={iconMap:new Map([["large",W],["small",O]]),action:this._onToggleMaximizeButton.bind(this),visible:this._maximizeButtonVisibility,title:new M.a(D),hotKeyTitle:R,className:u.maximize,dataset:{name:"pane-button-maximize"}},this._actions.minimize={iconMap:new Map([["large",W],["small",O]]),action:this._onToggleMaximizeButton.bind(this),visible:this._minimizeButtonVisibility,title:new M.a(z),hotKeyTitle:R,className:u.minimize,dataset:{name:"pane-button-minimize"}},this._actions.more={iconMap:new Map([["large",A],["small",L]]),action:this._showButtonsInContextMenu.bind(this),visible:new M.a(!H),title:new M.a(N),dataset:{name:"pane-button-more"}}}_getCloseButtonVisibility(){const e=this._paneWidget.state();let t=!1;return e.containsMainSeries()||e.isMaximized()||H||(t=e.dataSources().some(e=>Object(o.isStudy)(e))),t}_onCloseButton(){const e=this._model.model().panes().indexOf(this._paneWidget.state());this._model.removePane(e)}_getUpButtonVisibility(){const e=this._paneWidget.state();return this._model.model().panes().indexOf(e)>0&&!e.isMaximized()&&!H}_getDownButtonVisibility(){const e=this._paneWidget.state(),t=this._model.model().panes();return t.indexOf(e)<t.length-1&&!e.isMaximized()&&!H}_onUpDownButton(e){const t=this._model.model().panes().indexOf(this._paneWidget.state());this._model.rearrangePanes(t,e)}_getMaximizeButtonVisibility(){const e=this._paneWidget.state();return this._model.model().panes().length>1&&!e.isMaximized()&&!H}_getMinimizeButtonVisibility(){const e=this._paneWidget.state();return this._model.model().panes().length>1&&e.isMaximized()}_onToggleMaximizeButton(){this._callbacks.toggleMaximizePane(this._paneWidget)}_showButtonsInContextMenu(e){e.preventDefault(),null!==this._moreActionCM&&this._moreActionCM.isShown()?this._moreActionCM=null:S(this._actions,e).then(e=>{this._moreActionCM=e})}_getIsPaneMaximizeValue(){
return this._paneWidget.state().isMaximized()}_getIsWidgetShow(){return this._model.model().panes().length>1}}},mkWe:function(e,t,i){"use strict";i.d(t,"b",(function(){return l})),i.d(t,"a",(function(){return n}));var s=i("q1tI"),o=i.n(s);class l extends o.a.PureComponent{constructor(e){super(e),this._addDrawer=()=>{const e=this.state.currentDrawer+1;return this.setState({currentDrawer:e}),e},this._removeDrawer=()=>{const e=this.state.currentDrawer-1;return this.setState({currentDrawer:e}),e},this.state={currentDrawer:0}}render(){return o.a.createElement(n.Provider,{value:{addDrawer:this._addDrawer,removeDrawer:this._removeDrawer,currentDrawer:this.state.currentDrawer}},this.props.children)}}const n=o.a.createContext(null)},nFx7:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g class="corner-left-top"><path fill="currentColor" d="M10 7C10.5523 7 11 7.44772 11 8V10C11 11.1046 10.1046 12 9 12H7C6.44772 12 6 11.5523 6 11C6 10.4477 6.44772 10 7 10H9V8C9 7.44772 9.44772 7 10 7Z"/></g><g class="corner-right-top"><path fill="currentColor" d="M18 7C18.5523 7 19 7.44772 19 8V10H21C21.5523 10 22 10.4477 22 11C22 11.5523 21.5523 12 21 12H19C17.8954 12 17 11.1046 17 10V8C17 7.44772 17.4477 7 18 7Z"/></g><g class="corner-right-bottom"><path fill="currentColor" d="M17 18C17 16.8954 17.8954 16 19 16H21C21.5523 16 22 16.4477 22 17C22 17.5523 21.5523 18 21 18H19V20C19 20.5523 18.5523 21 18 21C17.4477 21 17 20.5523 17 20V18Z"/></g><g class="corner-left-bottom"><path fill="currentColor" d="M6 17C6 16.4477 6.44772 16 7 16H9C10.1046 16 11 16.8954 11 18V20C11 20.5523 10.5523 21 10 21C9.44772 21 9 20.5523 9 20V18H7C6.44772 18 6 17.5523 6 17Z"/></g></svg>'},obM5:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M7.65 8.35l.7-.7 6.15 6.14 6.15-6.14.7.7-6.14 6.15 6.14 6.15-.7.7-6.15-6.14-6.15 6.14-.7-.7 6.14-6.15-6.14-6.15z"/></svg>'},"p+vD":function(e,t,i){"use strict";i.r(t),i.d(t,"convertToCustomSymbolList",(function(){return n})),i.d(t,"convertToMarkedSymbolList",(function(){return a})),i.d(t,"convertToSymbolList",(function(){return r})),i.d(t,"getCustomWatchLists",(function(){return d})),i.d(t,"renameWatchList",(function(){return h})),i.d(t,"removeWatchList",(function(){return u})),i.d(t,"addSymbols",(function(){return c})),i.d(t,"removeSymbols",(function(){return _})),i.d(t,"replaceSymbols",(function(){return p})),i.d(t,"createWatchList",(function(){return b})),i.d(t,"putWatchList",(function(){return m})),i.d(t,"setActive",(function(){return g})),i.d(t,"getActive",(function(){return w}));var s=i("Eyy1"),o=i("wVAQ"),l=i("lpuu");function n(e){var t;return{type:"custom",id:e.id,name:e.name,symbols:null!==(t=e.symbols)&&void 0!==t?t:[],shared:e.shared}}function a(e){var t,i;const o=Object(s.ensureNotNull)(e.color);return{type:"colored",id:o,color:o,name:null!==(t=e.name)&&void 0!==t?t:null,symbols:null!==(i=e.symbols)&&void 0!==i?i:[],shared:e.shared}}function r(e){
return"custom"===e.type?n(e):a(e)}function d(){return Object(o.fetch)("/api/v1/symbols_list/custom/").then(l.a).then(e=>e.map(n))}function h(e,t){return Object(o.fetch)(`/api/v1/symbols_list/custom/${e.id}/rename/`,{method:"POST",body:JSON.stringify({name:t}),headers:{"Content-Type":"application/json"}}).then(l.a)}function u(e){return Object(o.fetch)(`/api/v1/symbols_list/custom/${e.id}/`,{method:"DELETE"}).then(l.a)}function c(e,t){return Object(o.fetch)(`/api/v1/symbols_list/custom/${e.id}/append/`,{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then(l.a)}function _(e,t){return Object(o.fetch)(`/api/v1/symbols_list/custom/${e.id}/remove/`,{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then(l.a)}function p(e,t){return Object(o.fetch)(`/api/v1/symbols_list/custom/${e.id}/replace/?unsafe=true`,{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then(l.a)}function b(e){return Object(o.fetch)("/api/v1/symbols_list/custom/",{method:"POST",body:JSON.stringify({name:e.name,symbols:e.symbols}),headers:{"Content-Type":"application/json"}}).then(l.a).then(n)}function m(e){throw new Error("not implemented")}function g(e){return Object(o.fetch)(`/api/v1/symbols_list/active/${e}/`,{method:"POST"})}function w(){return Object(o.fetch)("/api/v1/symbols_list/active/",{method:"GET"}).then(l.a).then(r)}},qfuz:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 7" width="9" height="7"><path fill="currentColor" d="M.5 3.5L4 0v3h5v1H4v3z"/></svg>'},rGGD:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16"><path fill="currentColor" d="M2.4 5.46a.8.8 0 0 1 1.14-.05L8 9.42l4.46-4.01a.8.8 0 0 1 1.08 1.18L8 11.58 2.47 6.59a.8.8 0 0 1-.06-1.13z"/></svg>'},sAH5:function(e,t,i){"use strict";i.r(t);var s=i("Eyy1"),o=i("hY0g"),l=i.n(o),n=i("ogJP"),a=i("ikwP"),r=i("eJTA"),d=i("Kxc7"),h=i("AvGy"),u=(i("LVLx"),i("MjAr")),c=i("EV8o"),_=i("S8xo"),p=i("GUQs"),b=i("EOiv"),m=i("5Alx"),g=i("0jws"),w=i("qFKp"),v=i("qBrV");const y=w.CheckMobile.any(),S=[m.title1st,m.title2nd,m.title3rd,m.title4th];class f{constructor(e,t,i){this._el=null,this._firstBlockWrapper=null,this._titleParentEl=null,this._titleElements=[],this._valuesParentEl=null,this._valuesAdditionalWrapperEl=null,this._valuesElements=[],this._actionsParentEl=null,this._actionAdditionalWrapperEl=null,this._stayInHoveredMode=!1,this._mode=4,this._statusesWrapper=null,this._resizeObserver=null,this._hideInvisibleHover=null,this._hideValues=null,this._allButtonsWidth=null,this._lastStatusesWrapperWidth=null,this._lastActionsWrapperWidth=null,this._showActionsHandler=null,this._hideActionsHandler=null,this._selectedSourceHandler=null,this._mouseEventHandlers=[],this._disableTimeout=null,this._loader=null,this._model=e,this._parentEl=t,this._disabled=this._model.disabled().spawn(),this._disabled.subscribe(this._updateDisabledState.bind(this)),this._selected=this._model.selected().spawn(),
this._selected.subscribe(this._updateSelectedState.bind(this)),this._loading=this._model.loading().spawn(),this._loading.subscribe(function(e,t){let i=0;return s=>{clearTimeout(i),Boolean(s)?e():i=setTimeout(e,t,!1)}}(this._updateLoadingState.bind(this),700)),this._isTitleHidden=this._model.isTitleHidden().spawn(),this._isValuesHidden=this._model.isValuesHidden().spawn(),this._isRowHidden=this._model.isRowHidden().spawn(),this._isTitleHidden.subscribe(this._updateShowTitles.bind(this)),this._isValuesHidden.subscribe(this._updateShowValues.bind(this)),this._isRowHidden.subscribe(this._updateShowLine.bind(this)),this._titlesSpawns=this._model.titles().map(e=>e.spawn());for(let s=0;s<this._titlesSpawns.length;s++)this._titlesSpawns[s].subscribe(this._updateTitlesHandler.bind(this,s));this._values=this._model.values().spawn(),this._values.subscribe(this._updateValues.bind(this)),this._createValuesSpawns(),this._addValuesSpawnsSubscriptions(),this._actionsSpawnArray=this._model.actions().map(e=>({visible:e.visible.spawn(),title:void 0===e.title?null:e.title.spawn()}));for(let s=0;s<this._actionsSpawnArray.length;s++){this._actionsSpawnArray[s].visible.subscribe(this._updateActionVisibilities.bind(this,s));const e=this._actionsSpawnArray[s].title;null!==e&&e.subscribe(this._updateActionTitle.bind(this,s))}this._withActions=i.withActions,this._render(),this._updateStates(),this._updateShowTitles(),this._updateShowValues(),this._updateShowLine(),null!==this._valuesParentEl&&(this._loader=new b.a(this._valuesParentEl,{className:m.loader})),this._customTextColor=i.customTextColor.spawn(),this._customTextColor.subscribe(this._updateCustomTextColor.bind(this)),this._updateCustomTextColor(),this._withActions&&(this._showActionsHandler=Object(p.c)(this._showActions.bind(this)),this._hideActionsHandler=Object(p.c)(this._hideActions.bind(this)),this._selectedSourceHandler=Object(p.c)(this._model.setSourceSelected.bind(this._model)),null!==this._titleParentEl&&(this._titleParentEl.addEventListener("touchend",this._selectedSourceHandler),this._titleParentEl.addEventListener("mousedown",this._selectedSourceHandler),y||(this._titleParentEl.addEventListener("mouseenter",this._showActionsHandler),this._titleParentEl.addEventListener("mouseleave",this._hideActionsHandler)),this._mouseEventHandlers.push(new _.MouseEventHandler(this._titleParentEl,{mouseDoubleClickEvent:this._model.onShowSettings.bind(this._model),doubleTapEvent:this._model.onShowSettings.bind(this._model)}))),null===this._actionAdditionalWrapperEl||null===this._actionsParentEl||y||(this._actionAdditionalWrapperEl.addEventListener("mouseenter",this._showActionsHandler),this._actionAdditionalWrapperEl.addEventListener("mouseleave",this._hideActionsHandler),this._actionsParentEl.addEventListener("contextmenu",e=>{e.preventDefault(),e.stopPropagation()})))}destroy(){var e,t;this._disabled.destroy(),this._selected.destroy(),this._loading.destroy(),this._isTitleHidden.destroy(),this._isValuesHidden.destroy(),this._isRowHidden.destroy(),this._customTextColor.destroy(),
null!==this._disableTimeout&&clearTimeout(this._disableTimeout);for(const i of this._titlesSpawns)i.destroy();if(null!==this._titleParentEl){for(const e of this._mouseEventHandlers)e.destroy();this._titleElements=[],this._withActions&&null!==this._selectedSourceHandler&&null!==this._showActionsHandler&&null!==this._hideActionsHandler&&(this._titleParentEl.removeEventListener("touchend",this._selectedSourceHandler),this._titleParentEl.removeEventListener("mousedown",this._selectedSourceHandler),y||(this._titleParentEl.removeEventListener("mouseenter",this._showActionsHandler),this._titleParentEl.removeEventListener("mouseleave",this._hideActionsHandler))),this._titleParentEl=null}for(const i of this._actionsSpawnArray){i.visible.destroy();const e=i.title;null!==e&&e.destroy()}if(null!==this._actionAdditionalWrapperEl&&(this._withActions&&null!==this._showActionsHandler&&null!==this._hideActionsHandler&&!y&&(this._actionAdditionalWrapperEl.removeEventListener("mouseenter",this._showActionsHandler),this._actionAdditionalWrapperEl.removeEventListener("mouseleave",this._hideActionsHandler)),this._actionAdditionalWrapperEl=null),this._actionsParentEl=null,this._removeValuesSpawnsSubscriptions(),this._values.destroy(),null!==this._valuesParentEl&&(this._valuesElements=[],this._valuesParentEl=null),null===(e=this._hideInvisibleHover)||void 0===e||e.destroy(),null===(t=this._hideValues)||void 0===t||t.destroy(),null!==this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null),null!==this._el){Object(s.ensureNotNull)(this._el.parentNode).removeChild(this._el),this._el=null}}getHeight(){return null===this._el?null:24}updateMode(e){this._mode===e&&null!==this._allButtonsWidth||(this._mode=e,this._updateAllButtonsWidth())}_render(){this._renderTitle(),this._renderActions(),this._renderValues(),this._el=document.createElement("div"),this._firstBlockWrapper=document.createElement("div"),this._firstBlockWrapper.classList.add(m.noWrapWrapper),this._firstBlockWrapper.appendChild(Object(s.ensureNotNull)(this._titleParentEl)),null!==this._actionsParentEl&&this._firstBlockWrapper.appendChild(this._actionsParentEl),this._el.appendChild(this._firstBlockWrapper),this._el.appendChild(Object(s.ensureNotNull)(this._valuesParentEl)),this._parentEl.append(this._el)}_renderTitle(){null===this._titleParentEl&&(this._titleParentEl=document.createElement("div"),this._titleParentEl.classList.add(m.titleWrapper));const e=this._titleParentEl;for(let t=0;t<this._titlesSpawns.length;t++){const i=document.createElement("div");i.classList.add(m.title,S[t],"apply-overflow-tooltip"),i.dataset.name="legend-source-title";const s=this._titlesSpawns[t].value();s.length>0?(i.appendChild(document.createTextNode(s)),i.classList.add(m.withDot)):i.classList.add(g.blockHidden),e.appendChild(i),this._titleElements.push(i)}}_renderActions(){if(!this._withActions)return;null===this._actionsParentEl&&(this._actionsParentEl=document.createElement("div"),this._actionsParentEl.classList.add(m.buttonsWrapper),
this._parentEl.append(this._actionsParentEl),this._actionAdditionalWrapperEl=document.createElement("div"),this._actionAdditionalWrapperEl.classList.add(m.buttons),this._actionsParentEl.appendChild(this._actionAdditionalWrapperEl));const e=Object(s.ensureNotNull)(this._actionAdditionalWrapperEl),t=h.a?"large":"small";for(const i of this._model.actions()){const s=Object(c.a)(i,m.button,m.buttonIcon,g.blockHidden,t);e.appendChild(s)}}_isWidthButtonsMode(){return null!==this._el&&(this._el.classList.contains(m.withAction)||this._disabled.value()||this._selected.value()||this._stayInHoveredMode)}_updateTitlesHandler(e,t){const i=Object(s.ensureNotNull)(this._titleElements[e]),o=0===t.length;i.classList.toggle(g.blockHidden,o),i.classList.toggle(m.withDot,!o),Object(v.a)(i,t)}_updateStates(e){this._updateDisabledState(),this._updateSelectedState(),this._updateLoadingState(),e&&this._clearDisableState()}_updateValuesHTMLElHandler(e,t){const i=Object(s.ensure)(this._valuesElements[e].value);Object(v.a)(i,t),this._updateShowValues()}_updateValueColorHandler(e,t=""){Object(s.ensure)(this._valuesElements[e].value).style.color=t}_updateValueVisibleHandler(e,t){const i=Object(s.ensure)(this._valuesElements[e].value).closest("."+m.valueItem);null!==i&&i.classList.toggle(g.blockHidden,!t)}_updateShowLine(){null!==this._el&&this._el.classList.toggle(g.blockHidden,this._isRowHidden.value())}_createValuesSpawns(){this._valuesSpawnArray=this._values.value().map(e=>({value:e.value.spawn(),color:e.color.spawn(),visible:e.visible.spawn()}))}_removeValuesSpawnsSubscriptions(){for(const e of this._valuesSpawnArray)e.value.destroy(),e.color.destroy(),e.visible.destroy();this._valuesSpawnArray=[]}_addValuesSpawnsSubscriptions(){for(let e=0;e<this._valuesSpawnArray.length;e++){const t=this._valuesSpawnArray[e];t.value.subscribe(this._updateValuesHTMLElHandler.bind(this,e)),t.color.subscribe(this._updateValueColorHandler.bind(this,e)),t.visible.subscribe(this._updateValueVisibleHandler.bind(this,e))}}_updateShowValues(){null!==this._valuesAdditionalWrapperEl&&this._valuesAdditionalWrapperEl.classList.toggle(g.blockHidden,this._isValuesShouldBeHidden())}_isValuesShouldBeHidden(){return!this._valuesSpawnArray.some(e=>e.value.value().length>0)}_addStatusesWidget(e,t,i){this._statusesWrapper=document.createElement("div"),this._statusesWrapper.classList.add(m.statusesWrapper),this._statusesWrapper.appendChild(e),Object(s.ensureNotNull)(this._firstBlockWrapper).appendChild(this._statusesWrapper),this._hideInvisibleHover=t.spawn(),this._hideInvisibleHover.subscribe(this._updateInvisibleHoverMode.bind(this),{callWithLast:!0}),this._hideValues=i.spawn(),this._hideValues.subscribe(this._updateHideValuesMode.bind(this),{callWithLast:!0}),this._updateStatusWidgetVisibility(this._disabled.value()),this._resizeObserver=new u.default(this._handlerRestrictTitleWidth.bind(this)),null!==this._actionsParentEl&&this._resizeObserver.observe(this._actionsParentEl),this._resizeObserver.observe(this._statusesWrapper)}_updateTitleMaxWidth(){
if(null===this._firstBlockWrapper)return;const e=this._allButtonsWidth||0,t=(this._lastActionsWrapperWidth||0)+(this._lastStatusesWrapperWidth||0);this._isWidthButtonsMode()?this._firstBlockWrapper.style.maxWidth=`calc(100% - ${Math.max(e,t)}px)`:this._firstBlockWrapper.style.maxWidth=t>0?`calc(100% - ${t}px)`:""}_updateAllButtonsWidth(){this._allButtonsWidth=this._getButtonsCount()*I+1,this._updateTitleMaxWidth()}_updateInvisibleHoverMode(e){null!==this._el&&this._el.classList.toggle(m.invisibleHover,!e)}_updateHideValuesMode(e){null!==this._el&&this._el.classList.toggle(m.hideValues,e)}_showActions(){if(null===this._el||!this._withActions)return;this._el.classList.add(m.withAction);const e=null!==this._valuesParentEl&&null!==this._titleParentEl&&this._valuesParentEl.offsetTop===this._titleParentEl.offsetTop;this._el.classList.toggle(m.withTail,e),this._updateTitleMaxWidth()}_hideActions(){null!==this._el&&this._withActions&&!this._stayInHoveredMode&&(this._el.classList.remove(m.withAction),null!==this._valuesParentEl&&this._valuesParentEl.classList.remove(m.withTail),this._updateTitleMaxWidth())}_handlerRestrictTitleWidth(e){if(null===this._actionsParentEl||null===this._firstBlockWrapper)return;let t=null,i=null;for(const s of e)s.target===this._statusesWrapper&&(t=s.contentRect.width),s.target===this._actionsParentEl&&(i=s.contentRect.width);t===this._lastStatusesWrapperWidth&&i===this._lastActionsWrapperWidth||(null!==t&&(this._lastStatusesWrapperWidth=t),null!==i&&(this._lastActionsWrapperWidth=i),this._updateTitleMaxWidth())}_clearDesabledTimeout(){null!==this._disableTimeout&&(clearTimeout(this._disableTimeout),this._disableTimeout=null)}_updateDisabledState(){null!==this._el&&(this._el.classList.remove("tempDisabled"),this._el.classList.remove(m.hiddenLoading),this._clearDesabledTimeout(),this._disabled.value()?(this._el.classList.add(m.disabled),this._updateStatusWidgetVisibility(!0)):(this._el.classList.add("tempDisabled"),this._el.classList.add(m.hiddenLoading),this._disableTimeout=setTimeout(()=>{null!==this._el&&(!this._loading.value()&&this._el.classList.contains("tempDisabled")&&(this._el.classList.remove("tempDisabled"),this._el.classList.remove(m.hiddenLoading),this._el.classList.toggle(m.disabled,this._disabled.value()),this._updateStatusWidgetVisibility(!1)),this._clearDesabledTimeout())},1e3)),this._updateTitleMaxWidth())}_clearDisableState(){null!==this._el&&(this._el.classList.remove(m.hiddenLoading),this._el.classList.remove(m.disabled),this._el.classList.remove("tempDisabled"),this._updateStatusWidgetVisibility(this._disabled.value()),this._updateTitleMaxWidth())}_updateSelectedState(){null!==this._el&&this._withActions&&this._el.classList.toggle(m.selected,this._selected.value())}_updateLoadingState(){if(null===this._el)return;this._el.classList.contains("tempDisabled")&&(this._loading.value()?this._el.classList.add(m.hiddenLoading):this._clearDisableState());const e=this._loading.value();this._el.classList.toggle(m.loading,e),null!==this._loader&&this._loader.toggleVisibility(e)}
_updateShowTitles(){null!==this._titleParentEl&&(this._titleParentEl.classList.toggle(g.blockHidden,this._isTitleHidden.value()),null!==this._actionsParentEl&&this._actionsParentEl.classList.toggle(g.blockHidden,this._isTitleHidden.value()))}_updateValues(){this._removeValuesSpawnsSubscriptions(),this._createValuesSpawns(),null!==this._valuesParentEl&&null!==this._valuesAdditionalWrapperEl&&(this._valuesElements=[],this._valuesAdditionalWrapperEl.innerHTML=""),this._renderValues(),this._addValuesSpawnsSubscriptions(),this._updateShowValues()}_updateActionVisibilities(e){null!==this._actionsParentEl&&this._actionsParentEl.querySelectorAll("."+m.button)[e].classList.toggle(g.blockHidden,!this._actionsSpawnArray[e].visible.value())}_updateActionTitle(e){const t=this._actionsSpawnArray[e].title;null!==this._actionsParentEl&&null!==t&&this._actionsParentEl.querySelectorAll("."+m.button)[e].setAttribute("title",t.value())}_updateCustomTextColor(){const e=this._customTextColor.value()||"";for(const i of this._titleElements)null!==i&&(i.style.color=e);const t=Object(s.ensureNotNull)(this._valuesParentEl).querySelectorAll("."+m.valueTitle);for(let i=0;i<t.length;i++)t[i].style.color=e;Object(s.ensureNotNull)(this._el).classList.toggle(m.withCustomTextColor,Boolean(e))}_updateStatusWidgetVisibility(e){null!==this._statusesWrapper&&this._statusesWrapper.classList.toggle(g.blockHidden,e)}}class E extends f{constructor(e,t,i){super(e,t,i),this._clientHeight=null,this._flagged=this._model.flagged().spawn(),this._flagged.subscribe(this._updateFlaggedState.bind(this)),this._updateStates(),i.statusWidgetEl&&this._addStatusesWidget(i.statusWidgetEl,i.hideInvisibleHover,i.hideValues),this._selected.subscribe(this._updateTitleMaxWidth.bind(this))}destroy(){super.destroy(),void 0!==this._flagged&&this._flagged.destroy()}getHeight(){return null===this._el?null:(null===this._clientHeight&&(this._clientHeight=this._el.clientHeight,0===this._clientHeight&&(this._clientHeight=null)),this._clientHeight)}_getButtonsCount(){return 1===this._mode?1:3}_render(){super._render();const e=Object(s.ensureNotNull)(this._el);e.classList.add(m.item,m.series),e.classList.toggle(m.onlyOneButtonCanBeStick,this._model.isOneButtonCanBeStick()),e.dataset.name="legend-series-item"}_updateStates(){super._updateStates(),this._updateFlaggedState()}_renderValues(){null===this._valuesParentEl&&(this._valuesParentEl=document.createElement("div"),this._valuesParentEl.classList.add(m.valuesWrapper),this._valuesAdditionalWrapperEl=document.createElement("div"),this._valuesAdditionalWrapperEl.classList.add(m.valuesAdditionalWrapper),this._valuesParentEl.appendChild(this._valuesAdditionalWrapperEl));const e=Object(s.ensureNotNull)(this._valuesAdditionalWrapperEl),t=this._values.value();for(const i of t){const t=document.createElement("div");t.classList.add(m.valueItem),t.classList.toggle(g.blockHidden,!i.visible.value());const s=document.createElement("div"),o=i.title.value()||"";s.classList.add(m.valueTitle),s.classList.toggle(g.blockHidden,0===o.length),
s.appendChild(document.createTextNode(o)),t.appendChild(s);const l=document.createElement("div");l.classList.add(m.valueValue),l.style.color=i.color.value()||"",l.appendChild(document.createTextNode(i.value.value())),t.appendChild(l),this._valuesElements.push({title:s,value:l}),e.appendChild(t)}}_createValuesSpawns(){super._createValuesSpawns(),this._values.value().forEach((e,t)=>{this._valuesSpawnArray[t].title=e.title.spawn()})}_removeValuesSpawnsSubscriptions(){for(const e of this._valuesSpawnArray)e.title.destroy();super._removeValuesSpawnsSubscriptions()}_addValuesSpawnsSubscriptions(){super._addValuesSpawnsSubscriptions();for(let e=0;e<this._valuesSpawnArray.length;e++)this._valuesSpawnArray[e].title.subscribe(this._updateValuesTitleHTMLElHandler.bind(this,e))}_isValuesShouldBeHidden(){return!this._valuesSpawnArray.some(e=>e.value.value().length>0||(e.title.value()||"").length>0)}_updateValuesTitleHTMLElHandler(e,t=""){const i=Object(s.ensure)(this._valuesElements[e].title);Object(v.a)(i,t),i.classList.toggle(g.blockHidden,0===t.length),this._updateShowValues()}_isWidthButtonsMode(){return null!==this._el&&(void 0!==this._flagged&&Boolean(this._flagged.value())||super._isWidthButtonsMode())}_updateFlaggedState(){if(void 0===this._flagged)return;Object(s.ensureNotNull)(this._el).classList.toggle(m.flagged,Boolean(this._flagged.value())),this._updateTitleMaxWidth()}}const M=w.isSafari?"click":"auxclick";class C extends f{constructor(e,t,i){super(e,t,i),this._wheelClickHandler=null,this._canUpdateRowVisibility=!0,this._globalRowVisibility=this._model.globalVisibility().spawn(),this._globalRowVisibility.subscribe(this._updateShowLine.bind(this),{callWithLast:!0}),this._has5Buttons=this._model.isPineScriptDataSource().spawn(),this._has5Buttons.subscribe(this._update5ButtonsStyles.bind(this)),this._updateStates(!this._disabled.value()),i.statusWidgetEl&&this._addStatusesWidget(i.statusWidgetEl,i.hideInvisibleHover,i.hideValues),this._selected.subscribe(this._updateTitleMaxWidth.bind(this)),i.withActions&&(this._wheelClickHandler=this._onWheelClicked.bind(this),null!==this._titleParentEl&&this._titleParentEl.addEventListener(M,this._wheelClickHandler))}destroy(){super.destroy(),this._has5Buttons.destroy(),this._globalRowVisibility&&this._globalRowVisibility.destroy(),null!==this._wheelClickHandler&&null!==this._titleParentEl&&this._titleParentEl.removeEventListener(M,this._wheelClickHandler)}_updateShowLine(){if(null===this._el||!this._canUpdateRowVisibility)return;const e=!this._globalRowVisibility.value();e?this._el.classList.toggle(g.blockHidden,e):super._updateShowLine()}_getButtonsCount(){switch(this._mode){case 4:return this._has5Buttons.value()?5:4;case 3:return 3;default:return 2}}_render(){super._render();const e=Object(s.ensureNotNull)(this._el);e.classList.add(m.item,m.study),e.dataset.name="legend-source-item"}_renderValues(){null===this._valuesParentEl&&(this._valuesParentEl=document.createElement("div"),this._valuesParentEl.classList.add(m.valuesWrapper),
this._valuesAdditionalWrapperEl=document.createElement("div"),this._valuesAdditionalWrapperEl.classList.add(m.valuesAdditionalWrapper),this._valuesParentEl.appendChild(this._valuesAdditionalWrapperEl));const e=Object(s.ensureNotNull)(this._valuesAdditionalWrapperEl),t=this._values.value();for(const i of t){const t=document.createElement("div");t.classList.add(m.valueItem),t.classList.toggle(g.blockHidden,!i.visible.value());const s=document.createElement("div");s.classList.add(m.valueValue),s.style.color=i.color.value()||"",s.appendChild(document.createTextNode(i.value.value())),t.appendChild(s),this._valuesElements.push({value:s}),e.appendChild(t)}}_update5ButtonsStyles(e){null!==this._el&&(this._el.classList.toggle(m.has5Buttons,e),this._updateAllButtonsWidth())}_onWheelClicked(e){1===e.button&&this._model.onRemoveSource()}}var V=i("JWMC");function x(e){Object(V.trackEvent)("GUI","Legend action",e)}var T=i("+GxX"),k=i("6dGu"),O=i("rGGD"),L=i("Y+EN"),W=i("vYP1");const A=window.t("Hide Indicator Legend"),H=window.t("Show Indicator Legend"),B=window.t("Show Object Tree"),P=Object(T.isFeatureEnabled)("lower_legend_collapser");class j{constructor(e,t,i){this._el=null,this._counterEl=null,this._arrowIconEL=null,this._objectTreeEl=null,this._mode=0,this._parentEl=e,this._themedColor=t.spawn(),this._themedColor.subscribe(this._updateThemedColor.bind(this)),this._sourceCount=i.visibleDataSourceCount.spawn(),this._sourceCount.subscribe(this._updateSourceCount.bind(this)),this._isStateOpen=i.isDataSourcesCollapsed.spawn(),this._isStateOpen.subscribe(this._updateState.bind(this)),this._showObjectsTree=i.showObjectsTree.spawn(),this._showObjectsTree.subscribe(this._updateObjectTreeVisibility.bind(this)),this._render(),this._updateState(),this._updateThemedColor(this._themedColor.value()),this._updateObjectTreeVisibility(this._showObjectsTree.value()),this._toggleStateHandler=Object(p.c)(i.onCollapseDataSources),this._showObjectTreeHandler=Object(p.c)(i.onShowObjectsTreeDialog),null!==this._el&&(this._el.addEventListener("touchend",this._toggleStateHandler),this._el.addEventListener("click",this._toggleStateHandler),this._el.addEventListener("contextmenu",e=>{e.preventDefault(),e.stopPropagation()})),null!==this._objectTreeEl&&(this._objectTreeEl.addEventListener("touchend",this._showObjectTreeHandler),this._objectTreeEl.addEventListener("click",this._showObjectTreeHandler))}destroy(){this._sourceCount.destroy(),this._isStateOpen.destroy(),null!==this._objectTreeEl&&(this._objectTreeEl.removeEventListener("touchend",this._showObjectTreeHandler),this._objectTreeEl.removeEventListener("click",this._showObjectTreeHandler),this._objectTreeEl=null),this._arrowIconEL=null,this._counterEl=null,null!==this._el&&(this._el.removeEventListener("touchend",this._toggleStateHandler),this._el.removeEventListener("click",this._toggleStateHandler),this._el.innerHTML="",this._el=null)}setMode(e){this._mode=e?1:0,this._updateTooltip()}_render(){this._el=document.createElement("div"),this._el.className=m.toggler+" apply-common-tooltip",
this._arrowIconEL=document.createElement("div"),this._arrowIconEL.classList.add(m.iconArrow),this._arrowIconEL.innerHTML=h.a?O:k,this._el.appendChild(this._arrowIconEL),this._objectTreeEl=document.createElement("div"),this._objectTreeEl.classList.add(m.objectTree),this._objectTreeEl.innerHTML=h.a?W:L,this._el.appendChild(this._objectTreeEl),this._counterEl=document.createElement("div"),this._counterEl.classList.add(m.counter),this._counterEl.appendChild(document.createTextNode(String(this._sourceCount.value()))),this._el.appendChild(this._counterEl),this._parentEl.appendChild(this._el)}_updateThemedColor(e){if(null!==this._el)if(e.length>0)if(P){const[t,i,s]=Object(r.parseRgb)(e);this._el.style.backgroundColor=Object(r.rgbaToString)([t,i,s,Object(r.normalizeAlphaComponent)(.8)])}else this._el.style.backgroundColor=e;else this._el.style.removeProperty("background-color")}_updateSourceCount(e){const t=Object(s.ensureNotNull)(this._counterEl);if(Object(v.a)(t,String(e)),P){const t=Object(s.ensureNotNull)(this._el),i=e<1;t.classList.toggle(g.blockHidden,i);const o=1===e;t.classList.toggle(m.onlyOneSourceShown,o)}else this._updateCounterVisibility(e)}_updateCounterVisibility(e){if(null===this._counterEl)return;const t=1===e;this._counterEl.classList.toggle(g.blockHidden,t)}_updateState(){const e=!this._isStateOpen.value();this._parentEl.classList.toggle(m.closed,e),this._updateTooltip(),x((e?"Hide":"Show")+" not main sources")}_tooltip(){return 1===this._mode?B:this._isStateOpen.value()?A:H}_updateTooltip(){null!==this._el&&this._el.setAttribute("title",this._tooltip())}_updateObjectTreeVisibility(e){Object(s.ensureNotNull)(this._el).classList.toggle(m.objectsTreeCanBeShown,e)}}var D=i("+6II"),z=i("R5JZ");function N(e,t){const i=new l.a(t(e.value()));e.subscribe(e=>{i.setValue(t(e))});return i.readonly().spawn(()=>e.unsubscribe())}const I=h.a?44:28,R=Object(T.isFeatureEnabled)("hide_interval_exchange_legend"),F=Object(T.isFeatureEnabled)("lower_legend_collapser"),K=d.enabled("object_tree_legend_mode");class G{constructor(e,t){this._renderToggler=null,this._mainDataSourceRenderer=null,this._dataSourceRenderers=[],this._wrapText=null,this._parentEl=document.createElement("div"),this._mainDataSourceEl=null,this._dataSourcesEl=null,this._dataSourcesAdditionalWrapperEl=null,this._collapsedDataSourcesWrapperEl=null,this._collapsedDataSourcesEl=null,this._outsideEventForCollapsedTooltip=null,this._options=e,this._togglerOptions=t,this._isStudiesLegendHidden=e.isStudiesLegendHidden.spawn(),this._isStudiesLegendHidden.subscribe(this._updateLegendVisibility.bind(this)),this._isAllLegendHidden=e.isAllLegendHidden.spawn(),this._isAllLegendHidden.subscribe(this._updateLegendVisibility.bind(this)),this._updateLegendVisibility(),this._themedColor=e.themedColor.spawn(),this._themedColor.subscribe(this._setCustomBg.bind(this)),this._showBackground=e.showBackground.spawn(),this._showBackground.subscribe(this._setCustomBg.bind(this)),this._backgroundTransparency=e.backgroundTransparency.spawn(),
this._backgroundTransparency.subscribe(this._setCustomBg.bind(this)),this._collapsedDataSourcesCountSpawn=e.collapsedDataSourcesCount.spawn(),this._collapsedDataSourcesCountSpawn.subscribe(this._updateCollapsedSourcesCount.bind(this)),this._showCollapsedDataSourcesTooltipHandler=this._showCollapsedDataSourcesTooltip.bind(this),h.a||(this._wrapText=e.wrapText.spawn(),this._wrapText.subscribe(this._updateWrapText.bind(this)),this._updateWrapText(this._wrapText.value())),this._parentEl.classList.add(m.legend),this._parentEl.classList.toggle(m.noActions,!this._options.withActions),this._parentEl.classList.toggle(m.touchMode,h.a),this._parentEl.classList.toggle(m.newCollapser,F),this._parentEl.dataset.name="legend",this._parentEl.style.setProperty("--legend-source-item-button-width",I+"px"),this._parentEl.addEventListener("contextmenu",t=>{t.preventDefault(),e.showLegendWidgetContextMenu(t)})}destroy(){if(this._isStudiesLegendHidden.destroy(),this._isAllLegendHidden.destroy(),this._themedColor.destroy(),this._showBackground.destroy(),this._backgroundTransparency.destroy(),this._collapsedDataSourcesCountSpawn.destroy(),h.a&&null!==this._collapsedDataSourcesWrapperEl&&this._collapsedDataSourcesWrapperEl.removeEventListener("touchend",this._showCollapsedDataSourcesTooltipHandler),this._outsideEventForCollapsedTooltip&&this._outsideEventForCollapsedTooltip(),null!==this._wrapText&&this._wrapText.destroy(),null!==this._dataSourcesAdditionalWrapperEl&&(this._dataSourcesAdditionalWrapperEl.innerHTML="",this._dataSourcesAdditionalWrapperEl=null),null!==this._dataSourcesEl&&(this._dataSourcesEl.innerHTML="",this._dataSourcesEl=null),null!==this._renderToggler&&(this._renderToggler.destroy(),this._renderToggler=null),null!==this._mainDataSourceRenderer&&(this._mainDataSourceRenderer.destroy(),this._mainDataSourceRenderer=null),0!==this._dataSourceRenderers.length){for(const e of this._dataSourceRenderers)e.destroy();this._dataSourceRenderers=[]}this._parentEl.innerHTML="",delete this._parentEl}addMainDataSource(e,t){this._renderMainDataSourceEl(),this._mainDataSourceRenderer=new E(e,Object(s.ensureNotNull)(this._mainDataSourceEl),{withActions:this._options.withActions,customTextColor:this._options.customTextColor,statusWidgetEl:t.getElement(),hideInvisibleHover:N(t.visibleWidgetsCount,e=>Boolean(e)),hideValues:t.errorWidgetIsShown}),this._updateLegendVisibility(),e.onDestroy().subscribe(this,()=>{null!==this._mainDataSourceRenderer&&(this._mainDataSourceRenderer.destroy(),this._mainDataSourceRenderer=null)},!0)}addDataSources(e,t){this._renderDataSourcesEl();const i=Object(s.ensureNotNull)(this._dataSourcesAdditionalWrapperEl);for(let s=0;s<e.length;s++){const o=e[s],l=new C(o,i,{withActions:this._options.withActions,customTextColor:this._options.customTextColor,statusWidgetEl:t[s].getElement(),hideInvisibleHover:N(t[s].visibleWidgetsCount,e=>Boolean(e)),hideValues:t[s].errorWidgetIsShown});this._dataSourceRenderers.push(l),this._updateLegendVisibility(),o.onDestroy().subscribe(this,()=>{const e=this._dataSourceRenderers.indexOf(l)
;-1!==e&&(this._dataSourceRenderers[e].destroy(),this._dataSourceRenderers.splice(e,1))},!0)}}addCustomWidget(e,t){if(0===t.block){this._renderMainDataSourceEl();const i=Object(s.ensureNotNull)(this._mainDataSourceEl);1===t.position&&e.renderTo(i,i.firstChild),0===t.position&&e.renderTo(i)}if(1===t.block){this._renderDataSourcesEl();const i=Object(s.ensureNotNull)(this._dataSourcesAdditionalWrapperEl);1===t.position&&e.renderTo(i,i.firstChild),0===t.position&&e.renderTo(i)}}firstTitle(){return this._parentEl.firstElementChild}getElement(){return this._parentEl}updateMode(e){const t=K&&e<112?1:e<205?2:e<222?3:4;null!==this._mainDataSourceRenderer&&this._mainDataSourceRenderer.updateMode(t);for(const s of this._dataSourceRenderers)s.updateMode(t);if(this._parentEl.classList.toggle(m.medium,3===t),this._parentEl.classList.toggle(m.minimized,2===t),this._parentEl.classList.toggle(m.micro,1===t),null!==this._renderToggler&&this._renderToggler.setMode(1===t),R){const t=e<442;this._parentEl.classList.toggle(m.miniHidden2Title,t);const i=e<192;this._parentEl.classList.toggle(m.microHidden2Title,i);const s=e<442;this._parentEl.classList.toggle(m.hidden3Title,s)}const i=h.a||e<542;this._parentEl.classList.toggle(m.directionColumn,i)}getMainSourceHeight(){return null===this._mainDataSourceRenderer?0:this._mainDataSourceRenderer.getHeight()}getDataSourceHeight(){return 0===this._dataSourceRenderers.length?0:this._dataSourceRenderers[0].getHeight()}_renderMainDataSourceEl(){null===this._mainDataSourceEl&&(this._mainDataSourceEl=document.createElement("div"),this._parentEl.insertBefore(this._mainDataSourceEl,this._dataSourcesEl))}_renderDataSourcesEl(){null===this._dataSourcesEl&&(this._dataSourcesEl=document.createElement("div"),this._dataSourcesEl.classList.add(m.sourcesWrapper),this._renderToggle(this._dataSourcesEl),this._dataSourcesAdditionalWrapperEl=document.createElement("div"),this._dataSourcesAdditionalWrapperEl.classList.add(m.sources),this._dataSourcesEl.appendChild(this._dataSourcesAdditionalWrapperEl),this._renderCollapsedCounter(this._dataSourcesAdditionalWrapperEl),this._parentEl.appendChild(this._dataSourcesEl))}_renderToggle(e){this._options.showToggleButton&&(this._renderToggler=new j(e,this._options.themedColor,this._togglerOptions))}_renderCollapsedCounter(e){this._collapsedDataSourcesWrapperEl=document.createElement("div"),this._collapsedDataSourcesWrapperEl.className=`${m.item} ${m.last}`,this._collapsedDataSourcesEl=document.createElement("span"),this._collapsedDataSourcesEl.className=m.text+" apply-common-tooltip",this._collapsedDataSourcesWrapperEl.append(this._collapsedDataSourcesEl),e.append(this._collapsedDataSourcesWrapperEl),h.a&&this._collapsedDataSourcesWrapperEl.addEventListener("touchend",this._showCollapsedDataSourcesTooltipHandler),this._updateCollapsedSourcesCount(this._collapsedDataSourcesCountSpawn.value())}_showCollapsedDataSourcesTooltip(){Object(D.showOnElement)(this._collapsedDataSourcesEl,{text:this._options.collapsedDataSourcesTitle.value()}),this._addOutsideEventForHideTooltip()}
_addOutsideEventForHideTooltip(){null!==this._outsideEventForCollapsedTooltip&&this._outsideEventForCollapsedTooltip(),this._outsideEventForCollapsedTooltip=Object(z.a)(new CustomEvent("timestamp").timeStamp,this._collapsedDataSourcesWrapperEl,()=>{null!==this._outsideEventForCollapsedTooltip&&this._outsideEventForCollapsedTooltip(),Object(D.hide)()},window.document,{touchEnd:!0})}_updateCollapsedSourcesCount(e){if(null===this._collapsedDataSourcesWrapperEl||null===this._collapsedDataSourcesEl)return;const t=0===e;this._collapsedDataSourcesWrapperEl.classList.toggle(g.blockHidden,t),t||(Object(v.a)(this._collapsedDataSourcesEl,"+"+e),this._collapsedDataSourcesEl.setAttribute("title",this._options.collapsedDataSourcesTitle.value()))}_updateLegendVisibility(){this._parentEl.classList.toggle(g.blockHidden,this._isAllLegendHidden.value()),null!==this._dataSourcesEl&&this._dataSourcesEl.classList.toggle(g.blockHidden,this._isStudiesLegendHidden.value())}_setCustomBg(){const e=this._showBackground.value(),t=this._themedColor.value(),i=this._backgroundTransparency.value();let s="";if(e){const[e,o,l]=Object(r.parseRgb)(t);s=Object(r.rgbaToString)([e,o,l,Object(r.normalizeAlphaComponent)(1-i/100)])}this._parentEl.style.color=s}_updateWrapText(e){this._parentEl.classList.toggle(m.noWrap,!e)}}var U=i("Tmoa"),Z=i("aIyQ"),q=i.n(Z),Y=i("Ialn"),X=i("QloM"),$=i("1AAW"),J=i("CLNU");function Q(e){return void 0!==e?U.resetTransparency(e):e}const ee=window.t("Show"),te=window.t("Hide");class ie{constructor(e,t,i,s,o){this._values=new l.a([]),this._actions=[],this._onDestroy=new q.a,this._loading=new l.a(!1),this._moreActionCM=null,this._model=e,this._source=t,this._options=i,this._callbacks=s,this._contextMenuOptions=o,this._disabled=new l.a(this._getDisabledState()),this._selected=new l.a(!1),this._isTitleHidden=new l.a(this._getTitleHiddenValue()),this._isValuesHidden=new l.a(this._getValuesHiddenValue()),this._isRowHidden=new l.a(this._getRowHiddenValue()),Object($.combine)(()=>({}),this._isTitleHidden,this._isValuesHidden,this._disabled).subscribe(this._updateRowVisibilities.bind(this)),this._values.subscribe(()=>{this._isValuesHidden.setValue(this._getValuesHiddenValue())})}destroy(){}onDestroy(){return this._onDestroy}titles(){return this._titles.map(e=>e.readonly())}values(){return this._values.readonly()}actions(){return this._actions}disabled(){return this._disabled.readonly()}selected(){return this._selected.readonly()}loading(){return this._loading.readonly()}isTitleHidden(){return this._isTitleHidden.readonly()}isValuesHidden(){return this._isValuesHidden.readonly()}isRowHidden(){return this._isRowHidden.readonly()}update(){this._updateTitle(),this._updateValues(),this._updateStates()}updateSource(e){this._source!==e&&(this._source=e,this.update())}onToggleDisabled(){const e=this._source.properties().childs().visible,t=!e.value();this._model.setProperty(e,t,`${t?"Show":"Hide"} ${this._source.title()}`),x((t?"Show":"Hide")+" source")}onShowSettings(){this._source.userEditEnabled()&&(this.setSourceSelected(),
this._callbacks.showChartPropertiesForSource(this._source,X.TabNames.style),x("Settings for source"))}onShowMoreActions(e){return this._options.readOnlyMode?Promise.resolve(null):(this._callbacks.updateActions(),x("Show source context menu"),this._callbacks.showContextMenuForSources([this._source],this._calcNewPosition(e),this._contextMenuOptions))}setSourceSelected(){this._model.selectionMacro(e=>{e.clearSelection(),e.addSourceToSelection(this._source)})}_moreActionHandler(e){e.preventDefault(),null!==this._moreActionCM&&this._moreActionCM.isShown()?this._moreActionCM=null:(this.setSourceSelected(),this.onShowMoreActions(e).then(e=>{this._moreActionCM=e}))}_updateTitle(){const e=this._source.statusView();if(null===e)return;const t=e.getSplitTitle();for(let i=0;i<this._titles.length;i++){const e=t[i],s=Object(J.clean)(Array.isArray(e)?e.join(" "):e||"",!0);this._titles[i].setValue(s)}}_updateStates(){this._disabled.setValue(this._getDisabledState()),this._selected.setValue(this._model.selection().isSelected(this._source)),this._loading.setValue(Boolean(this._source.isLoading()))}_hasValues(){return this._values.value().length>0}_getEyeTitle(){return this._disabled.value()?ee:te}_getDisabledState(){return!this._source.properties().visible.value()}_updateRowVisibilities(){this._isRowHidden.setValue(this._getRowHiddenValue())}_getRowHiddenValue(){return this._options.readOnlyMode&&this._disabled.value()||this._isTitleHidden.value()&&(this._isValuesHidden.value()||this._disabled.value())}_calcNewPosition(e){let t={};if(e.hasOwnProperty("touches")&&e.touches.length>0)t={clientX:e.touches[0].clientX,clientY:e.touches[0].clientY};else if(null!==e.target){const i=e.target.getBoundingClientRect();t={clientX:Object(Y.isRtl)()?i.right:i.left,clientY:i.top+i.height+3}}else{const i=e;t={clientX:i.clientX,clientY:i.clientY}}return t}}var se=i("fFbJ"),oe=i("HDec"),le=i("z4c1"),ne=i("61S9"),ae=i("vWJB"),re=i("wZiV");const de=window.t("More"),he=window.t("Flag Symbol"),ue=window.t("Unflag Symbol"),ce=d.enabled("show_hide_button_in_legend"),_e=d.enabled("marked_symbols")&&Object(T.isFeatureEnabled)("marked_symbols_enabled");class pe extends ie{constructor(e,t,i,s,o){super(e,t,i,s,o),this._titles=[new l.a(""),new l.a(""),new l.a(""),new l.a("")],this._symbolMarker=null,this._symbolMarkerIcon=null,this._flagged=new l.a(null),this._symbolAction=null,this._symbol=null,this._isOneButtonCanBeStick=!1,this._createActions(),this._updateSymbolMarker(),this._model.model().properties().paneProperties.legendProperties.showSeriesTitle.subscribe(this,()=>{this._isTitleHidden.setValue(this._getTitleHiddenValue())});const n=[this._model.model().properties().paneProperties.legendProperties.showSeriesOHLC,this._model.model().properties().paneProperties.legendProperties.showBarChange];for(const l of n)l.subscribe(this,()=>{this._isValuesHidden.setValue(this._getValuesHiddenValue())});this.update(),this._source.onStatusChanged().subscribe(this,()=>{this._loading.setValue(this._source.isLoading())})}destroy(){super.destroy(),
this._model.model().properties().paneProperties.legendProperties.showSeriesTitle.unsubscribeAll(this),this._model.model().properties().paneProperties.legendProperties.showSeriesOHLC.unsubscribeAll(this),this._model.model().properties().paneProperties.legendProperties.showBarChange.unsubscribeAll(this),this._source.onStatusChanged().unsubscribeAll(this),this._onDestroy.fire()}flagged(){return this._flagged.readonly()}onShowSettings(){this._source.userEditEnabled()&&this._callbacks.showGeneralChartProperties(X.TabNames.symbol)}isOneButtonCanBeStick(){return this._isOneButtonCanBeStick}_updateValues(){const e=this._source.legendView(),t=this._values.value(),i=e.marketTitle(),s=e.marketTitle().length>0;if(0===t.length){const t={value:new l.a(""),color:new l.a(""),visible:new l.a(s),title:new l.a(i)},o=e.items().map(e=>({value:new l.a(e.value()),color:new l.a(Q(e.color())),visible:new l.a(e.visible()),title:new l.a(e.title())}));this._values.setValue([t].concat(o))}else{t[0].title.setValue(i),t[0].visible.setValue(s);const o=e.items();for(let e=0;e<o.length;e++){const i=o[e];t[e+1].value.setValue(i.value()),t[e+1].color.setValue(Q(i.color())),t[e+1].visible.setValue(i.visible()),t[e+1].title.setValue(i.title())}}}_updateStates(){super._updateStates(),this._updateSymbolMarker()}_getTitleHiddenValue(){return!this._model.model().properties().paneProperties.legendProperties.showSeriesTitle.value()}_getValuesHiddenValue(){return!this._hasValues()||!this._model.model().properties().paneProperties.legendProperties.showSeriesOHLC.value()&&!this._model.model().properties().paneProperties.legendProperties.showBarChange.value()}_createActions(){if(_e&&this._options.symbolMarkerEnabled){const e=document.createElement("div");e.classList.add(m.markerContainer),this._symbolMarkerIcon=e,this._symbolAction={iconMap:new Map([["large",e],["small",e]]),action:Object(p.c)(this._symbolActionHandler.bind(this)),visible:new l.a(!0),className:m.flag,title:new l.a(this._getMarkerTitle()),dataset:{name:"legend-flag-action"}},this._actions.push(this._symbolAction)}if(ce){const e={iconMap:new Map([["large",ne],["small",le]]),action:Object(p.c)(this.onToggleDisabled.bind(this)),visible:new l.a(!0),className:m.eye,title:new l.a(this._getEyeTitle()),dataset:{name:"legend-show-hide-action"}};this._actions.push(e),this._disabled.subscribe(()=>{e.title.setValue(this._getEyeTitle())})}this._actions.push({iconMap:new Map([["large",re],["small",ae]]),action:this._moreActionHandler.bind(this),visible:new l.a(!0),title:new l.a(de),dataset:{name:"legend-more-action"}})}_getMarkerTitle(){return null!==this._symbolMarker?this._symbolMarker.isMarked()?ue:he:""}_symbolActionHandler(){null!==this._symbolMarker&&(this._updateSymbolMarker(),x("Change flag state"))}_updateSymbolMarker(){if(_e&&this._options.symbolMarkerEnabled){const e=Object(s.ensureNotNull)(this._symbolAction),t=Object(s.ensureNotNull)(this._symbolMarkerIcon),i=this._model.model().mainSeries().symbol();this._symbolMarker?this._symbol!==i&&(this._symbolMarker.bindTo(i,t),
this._symbol=i):(this._symbolMarker=Object(se.b)({symbol:i,container:t,specialImage:oe,className:m.flagWrapper,onMarkedChanged:()=>this._updateSymbolMarker()}),this._symbol=i),this._flagged.setValue(this._symbolMarker.isMarked());Object(s.ensureDefined)(e.title).setValue(this._getMarkerTitle())}else this._isOneButtonCanBeStick=!0}}var be=i("3ClC"),me=i("3jc8"),ge=i("z61+"),we=i("lCO3"),ve=i("nmnj"),ye=i("brCa"),Se=i("txPx"),fe=i("RgOa"),Ee=i("2CEX"),Me=i("D8x7"),Ce=i("bNWL"),Ve=i("cKqi"),xe=i("YzC7");const Te=Object(Se.getLogger)("Chart.LegendWidget"),ke=window.t("Settings"),Oe=window.t("Source code"),Le=window.t("Remove"),We=window.t("More"),Ae=window.t("Error"),He=window.t("Could not get Pine source code."),Be=d.enabled("study_buttons_in_legend"),Pe=d.enabled("show_hide_button_in_legend"),je=d.enabled("property_pages"),De=d.enabled("format_button_in_legend"),ze=d.enabled("delete_button_in_legend");class Ne extends ie{constructor(e,t,i,s,o){super(e,t,i,s,o),this._titles=[new l.a(""),new l.a("")],this._error=new l.a(!1),this._isPineScriptDataSource=new l.a(!1),this._pineAction=null,this._globalVisibility=new l.a(!0),this._createActions();const n=[this._model.model().properties().paneProperties.legendProperties.showSeriesTitle,this._model.model().properties().paneProperties.legendProperties.showStudyTitles];for(const l of n)l.subscribe(this,()=>{this._isTitleHidden.setValue(this._getTitleHiddenValue())});const a=[this._model.model().properties().paneProperties.legendProperties.showSeriesOHLC,this._model.model().properties().paneProperties.legendProperties.showBarChange,this._model.model().properties().paneProperties.legendProperties.showStudyValues];for(const l of a)l.subscribe(this,()=>{this._isValuesHidden.setValue(this._getValuesHiddenValue())});this.update(),Object(ve.onPineDeleted)().subscribe(this,this.update.bind(this)),this._updateAbleShowSourceCode()}destroy(){super.destroy();const e=this._model.model().properties().paneProperties.legendProperties;e.showSeriesTitle.unsubscribeAll(this),e.showStudyTitles.unsubscribeAll(this),e.showSeriesOHLC.unsubscribeAll(this),e.showBarChange.unsubscribeAll(this),e.showStudyValues.unsubscribeAll(this),Object(ve.onPineDeleted)().unsubscribeAll(this),this._onDestroy.fire()}error(){return this._error.readonly()}isPineScriptDataSource(){return this._isPineScriptDataSource.readonly()}updateSource(e){this._source!==e&&(this._values.setValue([]),super.updateSource(e),this._updateAbleShowSourceCode())}onRemoveSource(){this._source.isUserDeletable()&&(this._source.hasChildren()?Object(me.showDeleteStudyTreeConfirm)(this._model.removeSource.bind(this._model,this._source,!1)):this._model.removeSource(this._source,!1),x("Remove sources"))}onShowSourceCode(){if(Object(be.isStudy)(this._source)){const e=this._source.metaInfo(),t=void 0!==e.pine?e.pine.version:"",i=e.scriptIdPart;Promise.resolve(Object(ve.getPineSourceCode)(i,t)).then(e=>{const t=Object(s.ensureDefined)(e),o=we.Version.parse(t.version),l=t.lastVersionMaj?we.Version.parse(t.lastVersionMaj):new we.Version(0,0),n={
scriptSource:t.source,scriptIdPart:i,scriptName:t.scriptName,scriptTitle:t.scriptTitle,version:t.version,isOld:!l.isZero()&&l.major()!==o.major()};void 0!==window.TradingView.bottomWidgetBar&&window.TradingView.bottomWidgetBar.activateScriptEditorTab(n),x("Open source code for pine scripts")},e=>{Te.logError(e),Object(ye.showNoticeDialog)({title:Ae,content:He})})}}setGlobalVisibility(e){this._globalVisibility.setValue(e)}globalVisibility(){return this._globalVisibility.readonly()}getFullTitle(){return this._titles.map(e=>e.value()).join(" ")}_updateValues(){const e=this._source.legendView();if(null===e)return;if(0===e.items().length)return;const t=this._values.value();if(0===t.length){const t=e.items().map(e=>({value:new l.a(e.value()),color:new l.a(Q(e.color())),visible:new l.a(e.visible())}));this._values.setValue(t)}else{const i=e.items();for(let e=0;e<i.length;e++){const s=t[e],o=i[e];s.value.setValue(o.value()),s.color.setValue(Q(o.color())),s.visible.setValue(o.visible())}}}_updateStates(){super._updateStates(),void 0!==this._error&&this._error.setValue(Boolean(this._source.isFailed()))}_getTitleHiddenValue(){return this._isSymbolLikeStudy()?!this._model.model().properties().paneProperties.legendProperties.showSeriesTitle.value():!this._model.model().properties().paneProperties.legendProperties.showStudyTitles.value()}_getValuesHiddenValue(){return!this._hasValues()||(this._isSymbolLikeStudy()?!this._model.model().properties().paneProperties.legendProperties.showSeriesOHLC.value()&&!this._model.model().properties().paneProperties.legendProperties.showBarChange.value():!this._model.model().properties().paneProperties.legendProperties.showStudyValues.value())}_isSymbolLikeStudy(){return this._source instanceof Ve.study_Overlay||this._source instanceof xe.a}_updateAbleShowSourceCode(){if(Object(be.isStudy)(this._source)&&Be&&this._options.canShowSourceCode){const e=this._source.metaInfo(),t=window.TradingView.isExistent(e.pine),i=e.scriptIdPart;t&&Promise.resolve(Object(ve.isAuthToGetPineSourceCode)(i,e.pine&&e.pine.version)).then(e=>{let t=!0;e||(t=!1),this._updateVisibilityPineAction(t)},e=>{Te.logError("Failed isAuthToGetPineSourceCode, reason: "+e)})}}_updateVisibilityPineAction(e){null!==this._pineAction&&(this._pineAction.visible.setValue(e),this._isPineScriptDataSource.setValue(e))}_createActions(){if(!this._options.readOnlyMode){if(this._pineAction={iconMap:new Map([["large",Ee],["small",Ee]]),action:Object(p.c)(this.onShowSourceCode.bind(this)),visible:new l.a(!1),title:new l.a(Oe),dataset:{name:"legend-pine-action"}},Pe){const e={iconMap:new Map([["large",ne],["small",le]]),action:Object(p.c)(this.onToggleDisabled.bind(this)),visible:new l.a(!0),className:m.eye,title:new l.a(this._getEyeTitle()),dataset:{name:"legend-show-hide-action"}};this._actions.push(e),this._disabled.subscribe(()=>{e.title.setValue(this._getEyeTitle())})}je&&De&&(!Object(be.isStudy)(this._source)||new ge.a(this._source.metaInfo()).hasUserEditableOptions())&&this._actions.push({iconMap:new Map([["large",fe],["small",fe]]),
action:Object(p.c)(this.onShowSettings.bind(this)),visible:new l.a(!0),title:new l.a(ke),dataset:{name:"legend-settings-action"}}),(Object(be.isStudy)(this._source)||Object(be.isStudyStub)(this._source))&&Be&&this._options.canShowSourceCode&&this._actions.push(this._pineAction),ze&&this._actions.push({iconMap:new Map([["large",Ce],["small",Me]]),action:Object(p.c)(this.onRemoveSource.bind(this)),visible:new l.a(!0),title:new l.a(Le),dataset:{name:"legend-delete-action"}}),this._actions.push({iconMap:new Map([["large",re],["small",ae]]),action:this._moreActionHandler.bind(this),visible:new l.a(!0),title:new l.a(We),dataset:{name:"legend-more-action"}})}}}var Ie=i("7KDR"),Re=i("5VQP"),Fe=i("x2L+"),Ke=i("2uTr"),Ge=i("MXV9");const Ue=Object(T.isFeatureEnabled)("remove_wrap_text_legend");function Ze(e,t,i){e.setProperty(t,!t.value(),i)}function qe(e,t,i,s,o,l){return function(e,t,i,s,o){const l=[],n=s.get(0);if(void 0!==n){const e=n.get(1);void 0!==e&&e.length>0&&(l.push(...e),l.push(new Ie.Separator))}const a=e.model().properties().paneProperties.legendProperties;l.push(new Ie.Action({checkable:!0,checked:a.showSeriesTitle.value(),label:Ye,statName:"Show Symbol",onExecute:()=>Ze(e,a.showSeriesTitle,"Change Symbol Description Visibility")})),t.showOpenMarketStatus&&l.push(new Ie.Action({checkable:!0,checked:Fe.b.value(),label:Xe,statName:"Show Open market status",onExecute:()=>Ze(e,Fe.b,"Change open market status visibility")}));if(l.push(new Ie.Action({checkable:!0,checked:a.showSeriesOHLC.value(),label:$e,statName:"Show OHLC Values",onExecute:()=>Ze(e,a.showSeriesOHLC,"Change OHLC Values Visibility")})),l.push(new Ie.Action({checkable:!0,checked:a.showBarChange.value(),label:Je,statName:"Show Bar Change Values",onExecute:()=>Ze(e,a.showBarChange,"Change Bar Change Visibility")})),l.push(new Ie.Separator),void 0!==n){const e=n.get(0);void 0!==e&&e.length>0&&(l.push(...e),l.push(new Ie.Separator))}const r=s.get(1);if(void 0!==r){const e=r.get(1);void 0!==e&&e.length>0&&(l.push(...e),l.push(new Ie.Separator))}if(l.push(new Ie.Action({checkable:!0,checked:a.showStudyTitles.value(),label:Qe,statName:"Show Indicator Titles",onExecute:()=>Ze(e,a.showStudyTitles,"Change Indicator Titles Visibility")})),l.push(new Ie.Action({checkable:!0,checked:a.showStudyArguments.value(),label:et,statName:"Show Indicator Arguments",onExecute:()=>Ze(e,a.showStudyArguments,"Change Indicator Arguments Visibility")})),l.push(new Ie.Action({checkable:!0,checked:a.showStudyValues.value(),label:tt,statName:"Show Indicator Values",onExecute:()=>Ze(e,a.showStudyValues,"Change Indicator Values Visibility")})),void 0!==r){const e=r.get(0);void 0!==e&&e.length>0&&(l.push(...e),l.push(new Ie.Separator))}st||Ue||(l.push(new Ie.Separator),l.push(new Ie.Action({checkable:!0,checked:a.wrapText.value(),label:it,statName:"Wrap Text",onExecute:()=>{Ze(e,a.wrapText,"Change wrap text"),x("Change wrap text "+(a.wrapText?"on":"off"))}})));t.settings&&(l.push(new Ie.Separator),l.push(new Ie.Action({label:Object(Ke.appendEllipsis)(window.t("Settings")),icon:Ge,
statName:"Settings...",onExecute:()=>i(X.TabNames.legend)})));return Re.ContextMenuManager.createMenu(l,{},o)}(e,t,i,s,l).then(e=>(e.show(o),e))}const Ye=window.t("Show Symbol"),Xe=window.t("Show Open market status"),$e=window.t("Show OHLC Values"),Je=window.t("Show Bar Change Values"),Qe=window.t("Show Indicator Titles"),et=window.t("Show Indicator Arguments"),tt=window.t("Show Indicator Values"),it=window.t("Wrap text"),st=w.CheckMobile.any();var ot=i("+DwS"),lt=i("HGP3"),nt=i("xOeO"),at=i("z6kS"),rt=i("GOhO"),dt=i("25b6"),ht=i("rh3U");class ut{constructor(e){this.isBlinkingMode=new l.a(!1),this._status=new l.a(null),this._fullTooltip=new l.a(null),this._iconClassNames=new l.a(null),this._visible=new l.a(!1),this._tooltip=new l.a(null),this._icon=new l.a(null),this._className=new l.a(null),this._infoMaps=e,this._size=e.size||"small",this._status.subscribe(this._updateByStatus.bind(this),{callWithLast:!0}),this._className.subscribe(this._updateIconClassName.bind(this))}turnOffBlinkingMode(){}status(){return this._status}tooltip(){return this._tooltip}icon(){return this._icon}className(){return this._className}visible(){return this._visible}size(){return this._size}fullInfo(){return this._fullTooltip}_getTooltip(e){var t,i;return null!==(i=null===(t=this._infoMaps.tooltipMap)||void 0===t?void 0:t.get(e))&&void 0!==i?i:null}_getIcon(e){let t;const i=this._infoMaps.iconMap.get(e);return void 0!==i&&(t=i.get(this._size)),t||null}_getClassName(e){return this._infoMaps.classNameMap.get(e)||null}_getTitle(e){var t,i;return null!==(i=null===(t=this._infoMaps.titleMap)||void 0===t?void 0:t.get(e))&&void 0!==i?i:null}_getTitleColor(e){var t,i;return null!==(i=null===(t=this._infoMaps.titleColorMap)||void 0===t?void 0:t.get(e))&&void 0!==i?i:null}async _getHtml(e){var t,i,s;return null!==(s=null===(i=null===(t=this._infoMaps.htmlMap)||void 0===t?void 0:t.get(e))||void 0===i?void 0:i.map(dt.htmlEscape))&&void 0!==s?s:null}_getAction(e){var t,i;return null!==(i=null===(t=this._infoMaps.actionMap)||void 0===t?void 0:t.get(e))&&void 0!==i?i:null}async _updateFullTooltipByStatus(e){const t=await this._getHtml(e);this._status.value()===e&&this._fullTooltip.setValue([{icon:this._icon.value(),iconClassName:this._iconClassNames.value(),title:this._getTitle(e),titleColor:this._getTitleColor(e),html:t,size:this._size,action:this._getAction(e)}])}_updateByStatus(e){if(null===e)return this._icon.setValue(null),this._tooltip.setValue(null),void this._visible.setValue(!1);this._icon.setValue(this._getIcon(e)),this._className.setValue(this._getClassName(e)),this._tooltip.setValue(this._getTooltip(e)),this._visible.setValue(!0),this._updateFullTooltipByStatus(e)}_updateIconClassName(e){null!==e?this._iconClassNames.setValue([ht.statusItem,e]):this._iconClassNames.setValue(null)}}var ct=i("Vdly");const _t=[];function pt(){return ct.getJSON("tv.alreadyBlinkedStatuses",_t)}const bt=new l.a(pt());function mt(e){const t=ct.getJSON("tv.alreadyBlinkedStatuses",_t);t.includes(e)||(t.push(e),ct.setJSON("tv.alreadyBlinkedStatuses",t),bt.setValue(pt()))}
ct.onSync.subscribe(null,()=>bt.setValue(pt()));const gt=bt;var wt=i("oOPW"),vt=i("xlKU"),yt=i("Cf1E"),St=i("VrrN"),ft=i("VrXG"),Et=i("LIcf"),Mt=i("Uua9"),Ct=i("9Crk"),Vt=i("Tq3g")
;const xt=Object(Se.getLogger)("Chart.LegendWidget"),Tt=new Map([["DelayToRealtime",new Map([["small",St],["large",ft]])],["DelayNoRealtime",new Map([["small",St],["large",ft]])],["TFEXDelayForGuest",new Map([["small",St],["large",ft]])],["MOEXDelayForGuest",new Map([["small",St],["large",ft]])],["CHIXAuDelayForGuest",new Map([["small",St],["large",ft]])],["NGMDelayForGuest",new Map([["small",St],["large",ft]])],["DEForGuest",new Map([["small",St],["large",ft]])],["EOD",new Map([["small",Et],["large",Mt]])],["TickByTick",new Map([["small",Ct],["large",Vt]])],["BATSToRealtime",new Map([["small",Ct],["large",Vt]])],["DelayWithoutMarketAgreement",new Map([["small",St],["large",ft]])]]),kt=new Map([["DelayToRealtime",ht.delay],["DelayNoRealtime",ht.delay],["TFEXDelayForGuest",ht.delay],["MOEXDelayForGuest",ht.delay],["CHIXAuDelayForGuest",ht.delay],["NGMDelayForGuest",ht.delay],["DEForGuest",ht.delay],["EOD",ht.eod],["TickByTick",ht.notAccurate],["BATSToRealtime",ht.notAccurate],["DelayWithoutMarketAgreement",ht.delay]]),Ot=new Map([["DelayToRealtime",lt.colorsPalette["color-delay-mode"]],["DelayNoRealtime",lt.colorsPalette["color-delay-mode"]],["TFEXDelayForGuest",lt.colorsPalette["color-delay-mode"]],["MOEXDelayForGuest",lt.colorsPalette["color-delay-mode"]],["CHIXAuDelayForGuest",lt.colorsPalette["color-delay-mode"]],["NGMDelayForGuest",lt.colorsPalette["color-delay-mode"]],["DEForGuest",lt.colorsPalette["color-delay-mode"]],["EOD",lt.colorsPalette["color-eod-mode"]],["TickByTick",lt.colorsPalette["color-notaccurate-mode"]],["BATSToRealtime",lt.colorsPalette["color-notaccurate-mode"]],["DelayWithoutMarketAgreement",lt.colorsPalette["color-delay-mode"]]]),Lt=window.t("Data is delayed"),Wt=window.t("End of day data"),At=window.t("One update per second"),Ht=window.t("Cboe BZX"),Bt=window.t("{exchange} by {originalExchange}"),Pt=Object(dt.htmlEscape)(window.t("{symbolName} data is delayed by {time} minutes.")),jt=Object(dt.htmlEscape)(window.t("{listedExchange} real-time data is available for free to registered users.")),Dt=Object(dt.htmlEscape)(window.t("To get real-time data for {description}, please buy the real-time data package.")),zt=Object(dt.htmlEscape)(window.t("Real-time data for {description} is not supported right now. We may support it in the future.")),Nt=Object(dt.htmlEscape)(window.t("Data is updated once a day.")),It=Object(dt.htmlEscape)(window.t("Data on our Basic plan is updated once per second, even if there are more updates on the market.")),Rt=Object(dt.htmlEscape)(window.t("Data is updated once per second, even if there are more updates on the market.")),Ft=Object(dt.htmlEscape)(window.t("Paid plans feature faster data updates.")),Kt=Object(dt.htmlEscape)(window.t("Real-time data for {symbolName} is provided by {exchange} exchange.")),Gt=Object(dt.htmlEscape)(window.t("This data is real-time, but it’s slightly different to its official counterpart coming from primary exchanges.")),Ut=Object(dt.htmlEscape)(window.t("This data is real-time, but it’s slightly different to its official counterpart coming from {exchange}.")),Zt=Object(dt.htmlEscape)(window.t("If you'd like {listedExchange} real-time data you'll need to complete an Exchange Agreement. Don't worry, it only takes a few clicks")),qt=window.t("Create a free account"),Yt=window.t("Learn more"),Xt=Object(dt.htmlEscape)(window.t("Fill out Exchange Agreements"))
;class $t extends ut{constructor(e,t,i){super({iconMap:Tt,classNameMap:kt,titleColorMap:Ot,size:t}),this._dataUpdatedMode=new l.a(null).spawn(),this._options=i,this._model=e,this._dataModeBlinkingStatuses=gt.spawn(),this._dataModeBlinkingStatuses.subscribe(this._updateBlinkingMode.bind(this)),this.turnOffBlinkingMode=this._turnOffBlinking.bind(this),this.setModel(e)}destroy(){this._dataUpdatedMode.destroy(),this._dataModeBlinkingStatuses.destroy()}setModel(e){if(this._dataUpdatedMode.destroy(),null===e)return this._model=e,void(this._dataUpdatedMode=new l.a(null).spawn());this._dataUpdatedMode=e.status().spawn(),this._dataUpdatedMode.subscribe(this._updateStatus.bind(this),{callWithLast:!0})}_getTooltip(){const e=this._getShortTexts();return null===e?null:Object.values(e).join(" · ")}async _updateFullTooltipByStatus(){const e=this._dataUpdatedMode.value();if(null===e)return void this._fullTooltip.setValue(null);const t=this._getShortTexts(),i=await this._getHtmls(),s=await this._getActions();if(e!==this._dataUpdatedMode.value())return;const o=[];for(const l of e)o.push({icon:this._getIcon(l),iconClassName:this._iconClassNames.value(),title:t&&t[l],titleColor:this._getTitleColor(l),html:i&&i[l],size:this._size,action:s&&s[l]});this._fullTooltip.setValue(o)}_updateStatus(e){const t=null!==e?e[0]:null;super._updateByStatus(t),this._updateBlinkingMode()}async _getHtmls(){const e=this._dataUpdatedMode.value();if(null===e||null===this._model)return Promise.resolve(null);const t={},i=this._model.symbolName();let s=null,o=null;try{s=await this._model.description(),o=this._model.exchange()}catch(l){xt.logError("Can't get exchange description, reason: "+Object(yt.errorToString)(l))}for(const n of e)if(t[n]=[],["DelayToRealtime","DelayNoRealtime","TFEXDelayForGuest","MOEXDelayForGuest","CHIXAuDelayForGuest","NGMDelayForGuest","DEForGuest","DelayWithoutMarketAgreement"].includes(n)&&(t[n].push(Pt.format({symbolName:i,time:this._model.time().toString()})),this._options.subscriptionFullInfo&&null!==s&&"DelayToRealtime"===n&&t[n].push(Dt.format({description:`<b>${s}</b>`})),null!==s&&"DelayNoRealtime"===n&&t[n].push(zt.format({description:`<b>${s}</b>`})),"DelayWithoutMarketAgreement"===n&&t[n].push(Zt.format({listedExchange:this._model.listedExchange()})),this._options.subscriptionFullInfo&&["TFEXDelayForGuest","MOEXDelayForGuest","CHIXAuDelayForGuest","NGMDelayForGuest","DEForGuest"].includes(n)&&t[n].push(jt.format({listedExchange:this._model.listedExchange()}))),"EOD"===n&&(t[n]=[Nt]),"TickByTick"===n&&(t[n].push(this._options.subscriptionFullInfo?It:Rt),this._options.subscriptionFullInfo&&t[n].push(Ft)),null!==o&&"BATSToRealtime"===n){const e=this._model.listedExchange();t[n].push(Kt.format({symbolName:i,exchange:o}),""!==e?Ut.format({exchange:e}):Gt)}return Object.keys(t).length>0?t:null}async _getActions(){const e=this._dataUpdatedMode.value();if(null===e||null===this._model)return null;const t={};if(this._options.subscriptionFullInfo)for(const s of e){
if(["TFEXDelayForGuest","MOEXDelayForGuest","CHIXAuDelayForGuest","NGMDelayForGuest","DEForGuest"].includes(s)&&(t[s]={text:qt,onClick:()=>{Object(vt.showSignModal)({source:"Data warning indicator"})}}),"DelayWithoutMarketAgreement"===s){const e=this._model.exchange();t[s]={text:Xt,onClick:()=>{const t=new URL("/exchange-agreement/",window.location.origin);t.searchParams.append("exchange",e.toLowerCase()),window.open(t.href,"_blank")}}}if("BATSToRealtime"===s&&(t[s]={text:Yt,onClick:()=>{Object(nt.showSupportDialog)({solutionId:43000473924})}}),"TickByTick"===s||"DelayToRealtime"===s){let e=null,o=null;try{e=await this._model.description(),o=this._model.exchange()}catch(i){xt.logError("Can't get exchange description, reason: "+Object(yt.errorToString)(i))}t[s]={text:Yt,onClick:()=>{null!==this._model&&Object(wt.createGoProDialog)({forceUpgradeBtn:!0,goOnMarkets:!0,customParams:{time:this._model.time(),exchange:o,listedExchange:this._model.listedExchange(),description:e,symbolName:this._model.symbolName(),username:window.user?window.user.username:""},feature:s}).then(()=>{Object(V.trackEvent)("Data Warning","Full description visible",s)})}}}}return Object.keys(t).length>0?t:null}_getShortTexts(){var e;const t=this._dataUpdatedMode.value();if(null===t||null===this._model)return null;const i={};for(const s of t)if(["DelayToRealtime","DelayNoRealtime","TFEXDelayForGuest","MOEXDelayForGuest","DelayWithoutMarketAgreement","NGMDelayForGuest","DEForGuest"].includes(s)&&(i[s]=Lt),"EOD"===s&&(i[s]=Wt),"TickByTick"===s&&(i[s]=At),"BATSToRealtime"===s){const t=null!==(e=this._model.firstReplacedByBatsExchange())&&void 0!==e?e:"";i[s]=""!==t?Bt.format({exchange:t,originalExchange:Ht}):Ht}return Object.keys(i).length>0?i:null}_updateBlinkingMode(){const e=this._dataUpdatedMode.value();if(null===e)return;const t=this._dataModeBlinkingStatuses.value();for(const i of e)if(!t.includes(i))return void this.isBlinkingMode.setValue(!0);this.isBlinkingMode.setValue(!1)}_turnOffBlinking(){const e=this._dataUpdatedMode.value();if(null!==e)for(const t of e)mt(t)}}var Jt=i("JmzL"),Qt=i("M3mX");const ei=window.t("No volume data"),ti=window.t("Study Error"),ii=new Map([[!0,new Map([["small",Jt],["large",Qt]])],[!1,new Map([["small",""],["large",""]])]]),si=new Map([[!0,ht.dataProblemLow],[!1,null]]),oi=new Map([[!0,ti],[!1,null]]),li=new Map([[!0,ti],[!1,null]]),ni=new Map([[!0,lt.colorsPalette["color-data-problem"]],[!1,null]]),ai=new Map([["Pine cannot determine the referencing length of a series. Try using max_bars_back",at.a.PINE_CANNOT_DETERMINE],["Memory limits exceeded",at.a.MEMORY_LIMITS_EXCEEDED]]);function ri(e){return null!==e&&-1!==e.toLowerCase().indexOf("the data vendor doesn't provide volume data for this symbol.")?ei:null}class di extends ut{constructor(e,t,i){super({iconMap:ii,classNameMap:si,tooltipMap:oi,titleMap:li,titleColorMap:ni,size:t}),this._dataSourceErrorStatus=new l.a(null).spawn(),this._lastError=null,this._options=i,this.setSource(e)}destroy(){this._dataSourceErrorStatus.destroy()}setSource(e){
this._dataSourceErrorStatus.destroy(),this._source=e,this._dataSourceErrorStatus=Object(rt.c)(()=>function(e){return e.isFailed()&&!e.isSymbolInvalid()?e.status():null}(e),e.onStatusChanged()),this._dataSourceErrorStatus.subscribe(this._updateStatus.bind(this),{callWithLast:!0})}_getTooltip(e){if(e){const e=ri(this._dataSourceErrorStatus.value());if(null!==e)return e}return super._getTooltip(e)}_getTitle(e){if(e){const e=ri(this._dataSourceErrorStatus.value());if(null!==e)return e}return super._getTitle(e)}async _getHtml(e){return[this._source.status()]}_getAction(e){if(this._options.errorSolution){const e=function(e){for(const t of Array.from(ai.keys()))if(e.includes(t))return ai.get(t)}(this._source.status());return void 0===e?null:{text:Yt,onClick:()=>{Object(nt.showSupportDialog)({solutionId:e})}}}return null}_updateStatus(e){const t=this._status.value();e?(this._status.setValue(!0),t&&this._lastError!==e&&this._updateByStatus(!0)):this._status.setValue(null),this._lastError=e}}i("YFKU");const hi=window.t("Data problem"),ui=new Map([["high",new Map([["small",Jt],["large",Qt]])],["low",new Map([["small",Jt],["large",Qt]])]]),ci=new Map([["high",ht.dataProblemHigh],["low",ht.dataProblemLow]]),_i=new Map([["high",hi],["low",hi]]),pi=new Map([["high",lt.colorsPalette["color-data-problem"]],["low",lt.colorsPalette["color-data-problem"]]]);class bi extends ut{constructor(e,t){super({tooltipMap:_i,iconMap:ui,classNameMap:ci,titleMap:_i,titleColorMap:pi,size:t}),this._dataProblem=new l.a(null).spawn(),this._isDataProblemCritical=new l.a(!1),this.setModel(e)}destroy(){this._dataProblem.destroy()}isDataProblemCritical(){return this._isDataProblemCritical}setModel(e){this._dataProblem.destroy(),null!==e?(this._dataProblem=e.status().spawn(),this._dataProblem.subscribe(this._updateStatus.bind(this),{callWithLast:!0})):this._dataProblem=new l.a(null).spawn()}async _getHtml(e){const t=this._dataProblem.value();return null===t?null:[Object(dt.htmlEscape)(t.text)]}_updateStatus(e){var t;const i=null!==(t=null==e?void 0:e.severity)&&void 0!==t?t:null;this._status.setValue(i),this._isDataProblemCritical.setValue(function(e){return"high"===e}(i))}}class mi extends ut{constructor(e,t){super(t),this._booleanStatus=new l.a(!1).spawn(),this.updateStatus(e)}destroy(){this._booleanStatus.destroy()}updateStatus(e){this._booleanStatus.destroy(),this._booleanStatus=e.spawn(),this._booleanStatus.subscribe(this._updateStatus.bind(this),{callWithLast:!0})}_updateStatus(e){e?this._status.setValue(!0):this._status.setValue(null)}}var gi=i("YGQl"),wi=i("Jjb7");const vi=window.t("Invalid Symbol"),yi=window.t("This symbol doesn't exist, please pick another one."),Si=new Map([[!0,new Map([["small",gi],["large",wi]])],[!1,new Map([["small",""],["large",""]])]]),fi=new Map([[!0,ht.invalidSymbol],[!1,null]]),Ei=new Map([[!0,vi],[!1,null]]),Mi=new Map([[!0,vi],[!1,null]]),Ci=new Map([[!0,lt.colorsPalette["color-invalid-symbol"]],[!1,null]]),Vi=new Map([[!0,[yi]],[!1,null]]),xi=new Map([[!0,null],[!1,null]]);class Ti{constructor(e){
this._el=document.createElement("div"),this._prevCustomClass=null,this._icon=e.icon.spawn(),this._icon.subscribe(this._updateIcon.bind(this),{callWithLast:!0}),this._className=e.className.spawn(),this._className.subscribe(this._updateClassName.bind(this),{callWithLast:!0}),this._visible=e.visible.spawn(),this._visible.subscribe(this._updateVisibility.bind(this),{callWithLast:!0}),this._size=e.size||"small",this._render(e.parentEl),e.isBlinking&&(this._isBlinking=e.isBlinking.spawn(),this._isBlinking.subscribe(this._updateBlinkingMode.bind(this),{callWithLast:!0}),this._turnOffBlinking=e.turnOffBlinking)}destroy(){this._visible.destroy(),this._icon.destroy(),this._isBlinking&&this._isBlinking.destroy(),this._el.remove()}onClick(){this._turnOffBlinking&&this._turnOffBlinking()}visible(){return this._visible}_render(e){this._el.classList.add(ht.statusItem,ht[this._size]),e.appendChild(this._el)}_updateVisibility(e){this._el.classList.toggle("js-hidden",!e)}_updateIcon(e){this._el.innerHTML=e||""}_updateClassName(e){this._prevCustomClass!==e&&(null!==this._prevCustomClass&&this._el.classList.remove(this._prevCustomClass),null!==e&&this._el.classList.add(e),this._prevCustomClass=e)}_updateBlinkingMode(e){this._el.classList.toggle(ht.blinking,e)}}class ki{constructor(e,t,i,s){this.element=document.createElement("div"),this._blinkingSpawns=[],this._iconsRenderers=[];const o=[ht.statuses,"apply-common-tooltip","common-tooltip-wide"];h.a&&o.push(ht.touchMode),this.element.classList.add(...o,ht[e]),this._visibleWidgetsCount=t.spawn(),this._visibleWidgetsCount.subscribe(this._updateSpecialClassAndTooltip.bind(this)),this._tooltips=i.spawn(),this._tooltips.subscribe(this._updateTooltip.bind(this)),this._onClickCallback=s.onClick,this._onClickHandler=this._onClick.bind(this),this.element.addEventListener("click",this._onClickHandler)}destroy(){for(const e of this._iconsRenderers)e.destroy();for(const e of this._blinkingSpawns)e.destroy();this._visibleWidgetsCount.destroy(),this._tooltips.destroy(),this.element.removeEventListener("click",this._onClickHandler),this.element.remove()}addStatusModel(e){this._iconsRenderers.push(new Ti({visible:e.visible,icon:e.model.icon(),className:e.model.className(),size:e.model.size(),parentEl:this.element,isBlinking:e.model.isBlinkingMode,turnOffBlinking:e.model.turnOffBlinkingMode}));const t=e.model.isBlinkingMode.spawn();t.subscribe(this._updateBlinkingMode.bind(this)),this._blinkingSpawns.push(t),this._updateBlinkingMode()}_onClick(e){e.preventDefault();const t=this._iconsRenderers.filter(e=>e.visible().value());for(const l of t)l.onClick();let i=14;t.length>1&&(i-=2);const s=this.element.getBoundingClientRect(),o={x:s.left-i,y:s.bottom+4};this._onClickCallback(o)}_updateTooltip(){this.element.setAttribute("title",this._tooltips.value().join(" · "))}_updateSpecialClassAndTooltip(){const e=this._visibleWidgetsCount.value();this.element.classList.toggle(ht.oneWidgetsVisible,1===e),this.element.classList.toggle(ht.twoWidgetsVisible,2===e),
this.element.classList.toggle(ht.threeWidgetsVisible,3===e),this._updateTooltip()}_updateBlinkingMode(){const e=this._blinkingSpawns.some(e=>e.value());this.element.classList.toggle(ht.blinking,e)}}var Oi=i("kxJy");const Li=window.t("You can turn this data on or off.");class Wi extends ut{constructor(e,t,i){super({tooltipMap:Oi.g,iconMap:Oi.d,classNameMap:Oi.b,titleMap:Oi.f,titleColorMap:Oi.e,htmlMap:Oi.c,actionMap:Oi.a,size:t}),this._marketStatus=new l.a(null).spawn(),this._options=i,this.setModel(e)}destroy(){this._marketStatus.destroy()}setModel(e){this._marketStatus.destroy(),null!==e?(this._marketStatus=e.status().spawn(),this._marketStatus.subscribe(this._updateStatus.bind(this),{callWithLast:!0})):this._marketStatus=new l.a(null).spawn()}async _getHtml(e){const t=await super._getHtml(e);return null!==t&&(this._options.preMarketSolution||this._options.postMarketSolution)&&("pre_market"===e&&this._options.preMarketSolution&&t.push(Li),"post_market"===e&&this._options.postMarketSolution&&t.push(Li)),t}_getAction(e){if(this._options.preMarketSolution||this._options.postMarketSolution){if("pre_market"===e&&this._options.preMarketSolution)return{text:Yt,onClick:()=>{Object(nt.showSupportDialog)({solutionId:at.a.PRE_MARKET})}};if("post_market"===e&&this._options.postMarketSolution)return{text:Yt,onClick:()=>{Object(nt.showSupportDialog)({solutionId:at.a.POST_MARKET})}}}return super._getAction(e)}_updateStatus(e){this._status.setValue(e)}}class Ai{constructor(e,t,i){this.visibleWidgetsCount=new l.a(0),this.errorWidgetIsShown=new l.a(!1),this._size=h.a?"large":"small",this._tooltips=new l.a([]),this._visibilitySpawns=[],this._tooltipSpawns=[],this._statusWidgetInfos=[],this._renderer=new ki(this._size,this.visibleWidgetsCount,this._tooltips,{onClick:this._handleToggleDropdown.bind(this)}),this._symbolInvalidViewModel=null,this._dataSourceErrorStatusViewModel=null,this._marketStatusViewModel=null,this._dataUpdatedModeViewModel=null,this._dataProblemViewModel=null,this._isSymbolInvalid=null,this._dataSourceHasErrorVisible=null,this._studyErrorCanBeShown=new l.a(!1),this._marketStatusCanBeShown=new l.a(!1),this._dataUpdatedModeCanBeShown=new l.a(!1),this._dataProblemCanBeShown=new l.a(!1),this._isDataProblemCritical=null,this._container=document.createElement("div"),this._menuOpened=!1,this._menuPosition=null,this._source=e,this._model=t,this._options=i,this._recreateWidgets(),this._addSubscriptionForSymbolInvalid(),null!==this._dataSourceHasErrorVisible&&(this._dataSourceHasErrorVisible.subscribe(this._updateStatusWidgetsVisibilities.bind(this)),this._dataSourceHasErrorVisible.subscribe(this._updateErrorWidgetIsShown.bind(this))),this._options.dataProblemEnabled&&null!==this._isDataProblemCritical&&this._isDataProblemCritical.subscribe(this._updateStatusWidgetsVisibilities.bind(this));for(const s of this._tooltipSpawns)s.subscribe(this._updateTooltips.bind(this));for(const s of this._visibilitySpawns)s.subscribe(this._updateVisibleWidgetsCount.bind(this)),s.subscribe(this._updateTooltips.bind(this))
;this._updateErrorWidgetIsShown(),this._updateStatusWidgetsVisibilities(),this._updateVisibleWidgetsCount(),this._updateTooltips()}destroy(){var e;this._source.properties().hasChild("symbol")&&this._source.properties().symbol.listeners().unsubscribeAll(this),this._options.sourceStatusesEnabled&&null!==this._isSymbolInvalid&&this._isSymbolInvalid.destroy(),null===(e=this._isDataProblemCritical)||void 0===e||e.destroy();for(const t of this._tooltipSpawns)t.destroy();for(const t of this._visibilitySpawns)t.destroy();this.visibleWidgetsCount.unsubscribe();for(const t of this._statusWidgetInfos)t.model.destroy();this._renderer.destroy()}getElement(){return this._renderer.element}updateSource(e){this._source!==e&&(this._source.properties().hasChild("symbol")&&this._source.properties().symbol.listeners().unsubscribeAll(this),this._source=e,this._recreateWidgets(),this._updateStatusWidgetsVisibilities(),this._updateErrorWidgetIsShown(),this._updateVisibleWidgetsCount(),this._updateTooltips())}_updateStatusWidgetsVisibilities(){const e=this._isForceStatusActive();this._studyErrorCanBeShown.setValue(!e),this._marketStatusCanBeShown.setValue(!e),this._dataUpdatedModeCanBeShown.setValue(!e),this._dataProblemCanBeShown.setValue(!this._isPrimaryWidgetShown())}_isPrimaryWidgetShown(){var e,t;return null!==(t=null===(e=this._isSymbolInvalid)||void 0===e?void 0:e.value())&&void 0!==t&&t}_isForceStatusActive(){var e,t;return this._isPrimaryWidgetShown()||null!==(t=null===(e=this._isDataProblemCritical)||void 0===e?void 0:e.value())&&void 0!==t&&t}_updateVisibleWidgetsCount(){const e=this._statusWidgetInfos.filter(e=>e.visible.value());this.visibleWidgetsCount.setValue(e.length)}_updateTooltips(){const e=[];for(let t=0;t<this._tooltipSpawns.length;t++){if(!this._visibilitySpawns[t].value())continue;const i=this._tooltipSpawns[t].value();null!==i&&i.length>0&&e.push(i)}this._tooltips.setValue(e)}_recreateWidgets(){var e;if(this._options.sourceStatusesEnabled){if(Object(be.isStudy)(this._source)||Object(be.isStudyStub)(this._source)||this._source===this._model.mainSeries()){null===(e=this._isSymbolInvalid)||void 0===e||e.destroy();const t=this._source;if(this._isSymbolInvalid=Object(ot.a)(t.isSymbolInvalid.bind(this._source),t.onStatusChanged()),null===this._symbolInvalidViewModel){this._symbolInvalidViewModel=new mi(this._isSymbolInvalid,{tooltipMap:Ei,iconMap:Si,classNameMap:fi,titleMap:Mi,titleColorMap:Ci,htmlMap:Vi,actionMap:xi,size:this._size});const e=this._symbolInvalidViewModel.visible().spawn();this._visibilitySpawns.push(e),this._tooltipSpawns.push(this._symbolInvalidViewModel.tooltip().spawn());const t={visible:e,model:this._symbolInvalidViewModel};this._statusWidgetInfos.push(t),this._renderer.addStatusModel(t)}else this._symbolInvalidViewModel.updateStatus(this._isSymbolInvalid),this._addSubscriptionForSymbolInvalid()}if(Object(be.isStudy)(this._source)||Object(be.isStudyStub)(this._source))if(null===this._dataSourceErrorStatusViewModel){
this._dataSourceErrorStatusViewModel=new di(this._source,this._size,this._options.sourceStatuses),this._dataSourceHasErrorVisible=Object($.combine)(()=>this._studyErrorCanBeShown.value()&&Object(s.ensureNotNull)(this._dataSourceErrorStatusViewModel).visible().value(),this._studyErrorCanBeShown,this._dataSourceErrorStatusViewModel.visible()),this._visibilitySpawns.push(this._dataSourceHasErrorVisible),this._tooltipSpawns.push(this._dataSourceErrorStatusViewModel.tooltip().spawn());const e={visible:this._dataSourceHasErrorVisible,model:this._dataSourceErrorStatusViewModel};this._statusWidgetInfos.push(e),this._renderer.addStatusModel(e)}else this._dataSourceErrorStatusViewModel.setSource(this._source)}if(this._options.marketStatusEnabled){const e=this._source.marketStatusModel();if(null===this._marketStatusViewModel){this._marketStatusViewModel=new Wi(e,this._size,this._options.marketStatus);const t=Object($.combine)(()=>this._marketStatusCanBeShown.value()&&Object(s.ensureNotNull)(this._marketStatusViewModel).visible().value(),this._marketStatusCanBeShown,this._marketStatusViewModel.visible());this._visibilitySpawns.push(t),this._tooltipSpawns.push(this._marketStatusViewModel.tooltip().spawn());const i={visible:t,model:this._marketStatusViewModel};this._statusWidgetInfos.push(i),this._renderer.addStatusModel(i)}else this._marketStatusViewModel.setModel(e)}if(this._options.dataUpdateModeEnabled){const e=this._source.dataUpdatedModeModel();if(null===this._dataUpdatedModeViewModel){this._dataUpdatedModeViewModel=new $t(e,this._size,this._options.dataUpdateMode);const t=Object($.combine)(()=>this._dataUpdatedModeCanBeShown.value()&&Object(s.ensureNotNull)(this._dataUpdatedModeViewModel).visible().value(),this._dataUpdatedModeCanBeShown,this._dataUpdatedModeViewModel.visible());this._visibilitySpawns.push(t),this._tooltipSpawns.push(this._dataUpdatedModeViewModel.tooltip().spawn());const i={visible:t,model:this._dataUpdatedModeViewModel};this._statusWidgetInfos.push(i),this._renderer.addStatusModel(i)}else this._dataUpdatedModeViewModel.setModel(e)}if(this._options.dataProblemEnabled){const e=this._source.dataProblemModel();if(null===this._dataProblemViewModel){this._dataProblemViewModel=new bi(e,this._size),this._isDataProblemCritical=this._dataProblemViewModel.isDataProblemCritical().spawn();const t=Object($.combine)(()=>this._dataProblemCanBeShown.value()&&Object(s.ensureNotNull)(this._dataProblemViewModel).visible().value(),this._dataProblemCanBeShown,this._dataProblemViewModel.visible());this._visibilitySpawns.push(t),this._tooltipSpawns.push(this._dataProblemViewModel.tooltip().spawn());const i={visible:t,model:this._dataProblemViewModel};this._statusWidgetInfos.push(i),this._renderer.addStatusModel(i)}else this._dataProblemViewModel.setModel(e)}}_addSubscriptionForSymbolInvalid(){this._options.sourceStatusesEnabled&&null!==this._isSymbolInvalid&&(this._isSymbolInvalid.subscribe(this._updateStatusWidgetsVisibilities.bind(this)),this._isSymbolInvalid.subscribe(this._updateErrorWidgetIsShown.bind(this),{callWithLast:!0
}))}_updateErrorWidgetIsShown(){var e,t,i,s;const o=null!==(t=null===(e=this._isSymbolInvalid)||void 0===e?void 0:e.value())&&void 0!==t&&t,l=null!==(s=null===(i=this._dataSourceHasErrorVisible)||void 0===i?void 0:i.value())&&void 0!==s&&s;this.errorWidgetIsShown.setValue(o||l)}_handleToggleDropdown(e){var t;this._menuPosition=e,this._menuOpened=!this._menuOpened,this._menuOpened&&(this._source.properties().hasChild("symbol")&&this._source.properties().symbol.listeners().subscribe(this,this._handleDropdownMenuClose),t="Open full tooltip for statuses: "+this._tooltips.value().join(", "),Object(V.trackEvent)("GUI","Statuses widget's action",t)),this._updateDropdownMenu()}_handleDropdownMenuClose(){this._menuOpened=!1,this._source.properties().hasChild("symbol")&&this._source.properties().symbol.listeners().unsubscribeAll(this),this._updateDropdownMenu()}_updateDropdownMenu(){Promise.all([i.e("vendors"),i.e(5),i.e(582),i.e(4),i.e("full-tooltips-popup")]).then(i.bind(null,"vR7+")).then(e=>{e.render(this._menuOpened,this._container,this._renderer.element,this._statusWidgetInfos,this._handleDropdownMenuClose.bind(this),Object(s.ensureNotNull)(this._menuPosition))})}}var Hi=i("AH3n");const Bi=window.t("Replay mode"),Pi=window.t("You're in Replay mode. You're in Replay mode. You're in Replay mode."),ji=new Map([[!0,new Map([["small",Hi],["large",Hi]])],[!1,new Map([["small",""],["large",""]])]]),Di=new Map([[!0,ht.replayMode],[!1,null]]),zi=new Map([[!0,Bi],[!1,null]]),Ni=new Map([[!0,Bi],[!1,null]]),Ii=new Map([[!0,lt.colorsPalette["color-replay-mode"]],[!1,null]]),Ri=new Map([[!0,[Pi]],[!1,null]]),Fi=new Map([[!0,null],[!1,null]]);class Ki extends Ai{constructor(e,t,i){if(super(e,t,i),this._isInReplay=new l.a(!1).readonly().spawn(),this._isInReplayCanBeShown=null,this._inited=!1,this._options.sourceStatusesEnabled){this._isInReplayCanBeShown=new l.a(!1),this._isInReplay=Object(ot.a)(t.isInReplay.bind(t),t.onInReplayStateChanged());const e=new mi(this._isInReplay,{tooltipMap:zi,iconMap:ji,classNameMap:Di,titleMap:Ni,titleColorMap:Ii,htmlMap:Ri,actionMap:Fi,size:this._size}),i=Object($.combine)(()=>Object(s.ensureNotNull)(this._isInReplayCanBeShown).value()&&Object(s.ensureNotNull)(e).visible().value(),this._isInReplayCanBeShown,e.visible());i.subscribe(this._updateStatusWidgetsVisibilities.bind(this)),i.subscribe(this._updateVisibleWidgetsCount.bind(this)),i.subscribe(this._updateTooltips.bind(this)),this._visibilitySpawns.push(i);const o=e.tooltip().spawn();o.subscribe(this._updateTooltips.bind(this)),this._tooltipSpawns.push(o);const n={visible:i,model:e};this._statusWidgetInfos.push(n),this._renderer.addStatusModel(n),this._inited=!0,this._isInReplay.subscribe(this._updateStatusWidgetsVisibilities.bind(this),{callWithLast:!0})}}destroy(){this._options.sourceStatusesEnabled&&this._isInReplay.destroy(),super.destroy()}_updateStatusWidgetsVisibilities(){var e,t;super._updateStatusWidgetsVisibilities(),
this._options.sourceStatusesEnabled&&this._inited&&Object(s.ensureNotNull)(this._isInReplayCanBeShown).setValue(!super._isPrimaryWidgetShown()&&null!==(t=null===(e=this._isInReplay)||void 0===e?void 0:e.value())&&void 0!==t&&t)}_isPrimaryWidgetShown(){var e,t;return super._isPrimaryWidgetShown()||null!==(t=null===(e=this._isInReplay)||void 0===e?void 0:e.value())&&void 0!==t&&t}}var Gi=i("EsvI"),Ui=i("UXvI");i.d(t,"LegendWidget",(function(){return ts}));const Zi={readOnlyMode:!1,contextMenu:{settings:!0,mainSeries:!0,studies:!0,showOpenMarketStatus:!1},symbolMarkerEnabled:!1,showToggleButton:!0,canShowSourceCode:!1,statusesWidgets:{sourceStatusesEnabled:!1,sourceStatuses:{errorSolution:!0},marketStatusEnabled:!1,marketStatus:{preMarketSolution:!0,postMarketSolution:!0},dataUpdateModeEnabled:!1,dataUpdateMode:{subscriptionFullInfo:!0},dataProblemEnabled:!1}},qi=d.enabled("hide_legend_by_default"),Yi=d.enabled("fundamental_widget"),Xi=d.enabled("legend_context_menu"),$i=Object(T.isFeatureEnabled)("lower_legend_collapser"),Ji=Object(T.isFeatureEnabled)("remove_wrap_text_legend"),Qi=$i?.8:.9,es=2*parseInt(m.marginlegendhoriz);class ts{constructor(e,t,i,s,o,a){this._mainSeriesViewModel=null,this._dataSourceViewModels=[],this._visibleDataSourceCount=new l.a(0),this._themedColor=new l.a(""),this._mainSeriesRowHidden=null,this._dataSourceRowsHidden=[],this._customWidgetsVisibilities=[],this._allLegendHidden=new l.a(!1),this._studiesLegendHidden=new l.a(!1),this._customWidgetsHeights=[],this._onLegendVisibilityToggled=null,this._availableHeight=0,this._collapsedDataSourcesCount=new l.a(0),this._collapsedDataSourcesTitle=new l.a(""),this._mainSeriesStatusWidget=null,this._dataSourcesStatusesWidgets=[],this._size=null,this._customLegendWidgetsFactoriesMap=new Map,this._customLegendWidgetsMap=new Map,this._margin=0,this._model=e,this._paneWidget=t,this._options=Object(n.merge)(Object(n.clone)(Zi),o),this._callbacks=a,this._mainSeriesViewModelsOptions={readOnlyMode:this._options.readOnlyMode,symbolMarkerEnabled:this._options.symbolMarkerEnabled},this._dataSourceViewModelsOptions=Object.assign(Object.assign({},this._mainSeriesViewModelsOptions),{canShowSourceCode:this._options.canShowSourceCode}),this._backgroundThemeName=i;const r=this._showLegendCalculatedProperty();if(this._isDataSourcesCollapsed=new l.a(r.value()),r.subscribe(this,()=>{this._isDataSourcesCollapsed.setValue(r.value())}),qi&&!ct.getBool("legend.isVisibilityToggled")){const e=this._showLegendOriginalProperty();this._onLegendVisibilityToggled=this._setLegendVisibilityToggled.bind(this),e.setValue(!1),e.subscribe(this,this._onLegendVisibilityToggled)}const d=new l.a(this._getCustomTextColorValue());this._model.model().properties().scalesProperties.textColor.subscribe(this,()=>{d.setValue(this._getCustomTextColorValue())});const h=this._model.model().properties().paneProperties.legendProperties.showBackground,u=new l.a(h.value());h.subscribe(this,()=>{u.setValue(h.value())})
;const c=this._model.model().properties().paneProperties.legendProperties.backgroundTransparency,_=new l.a(c.value());if(c.subscribe(this,()=>{_.setValue(c.value())}),Ji)this._wrapText=new l.a(!1);else{const e=this._model.model().properties().paneProperties.legendProperties.wrapText;this._wrapText=new l.a(e.value()),e.subscribe(this,()=>{this._wrapText.setValue(e.value()),this._updateCollapsedSourcesMode()})}this._hideNotMainSources=s.spawn(),this._hideNotMainSources.subscribe(this._updateLegendVisibilities.bind(this)),this._isPaneMain=new l.a(this._getIsPaneMainValue()),this._updateCollapsedSourcesModeThrottle=Object(Ui.default)(this._updateCollapsedSourcesMode.bind(this),100),this._renderer=new G({withActions:!this._options.readOnlyMode,showToggleButton:this._options.showToggleButton,isStudiesLegendHidden:this._studiesLegendHidden.readonly(),isAllLegendHidden:this._allLegendHidden.readonly(),customTextColor:d.readonly(),themedColor:this._themedColor.readonly(),showBackground:u.readonly(),backgroundTransparency:_.readonly(),wrapText:this._wrapText.readonly(),collapsedDataSourcesCount:this._collapsedDataSourcesCount.readonly(),collapsedDataSourcesTitle:this._collapsedDataSourcesTitle.readonly(),showLegendWidgetContextMenu:this.onShowLegendWidgetContextMenu.bind(this)},{visibleDataSourceCount:this._visibleDataSourceCount.readonly(),isDataSourcesCollapsed:this._isDataSourcesCollapsed.readonly(),showObjectsTree:this._isPaneMain.readonly(),onCollapseDataSources:this.onCollapseDataSources.bind(this),onShowObjectsTreeDialog:this._callbacks.showObjectsTreeDialog})}destroy(){this._hideNotMainSources.destroy(),null!==this._mainSeriesViewModel&&this._destroyMainDataSource();for(const e of this._dataSourceViewModels)e.destroy();for(const e of this._dataSourcesStatusesWidgets)e.destroy();this._clearSubscriptions();for(const e of Array.from(this._customLegendWidgetsMap.keys()))this._destroyCustomWidgetFromLayerBlock(e);this._customLegendWidgetsMap.clear(),this._renderer.destroy(),delete this._renderer,this._showLegendCalculatedProperty().unsubscribeAll(this),this._showLegendOriginalProperty().unsubscribeAll(this),this._model.model().properties().scalesProperties.textColor.unsubscribeAll(this),this._model.model().properties().paneProperties.legendProperties.showBackground.unsubscribeAll(this),this._model.model().properties().paneProperties.legendProperties.backgroundTransparency.unsubscribeAll(this),Ji||this._model.model().properties().paneProperties.legendProperties.wrapText.unsubscribeAll(this)}addCustomWidgetToLegend(e,t){const i=this._customLegendWidgetsFactoriesMap.get(t.block)||new Map,s=i.get(t.position)||[];s.push(e),i.set(t.position,s),this._customLegendWidgetsFactoriesMap.set(t.block,i),this.updateLayout(),this._updateCustomWidgetModeBySize()}onShowLegendWidgetContextMenu(e,t){if(this._options.readOnlyMode||!Xi)return Promise.resolve(null);x("Show legend context menu");const i=new Map;for(const o of Array.from(this._customLegendWidgetsMap.keys())){
const e=Object(s.ensureDefined)(this._customLegendWidgetsMap.get(o)),t=new Map;for(const i of Array.from(e.keys())){const o=Object(s.ensureDefined)(e.get(i)),l=t.get(i)||[];for(const e of o)l.push(...e.contextMenuActions());t.set(i,l)}i.set(o,t)}return qe(this._model,this._options.contextMenu,this._callbacks.showGeneralChartProperties,i,e,t)}onCollapseDataSources(){const e=this._showLegendOriginalProperty();e.setValue(!e.value())}updateLayout(){const e=this._paneWidget.state().sourcesByGroup().all().filter(e=>null!==e.statusView());if(0===e.length)return;const t=this._model.mainSeries(),i=e.indexOf(t);i>-1?(e.splice(i,1),Yi||null!==this._mainSeriesViewModel||(this._mainSeriesViewModel=new pe(this._model,t,this._mainSeriesViewModelsOptions,this._callbacks,this._options.contextMenu),this._mainSeriesStatusWidget=new Ki(t,this._model.model(),this._options.statusesWidgets),this._renderer.addMainDataSource(this._mainSeriesViewModel,this._mainSeriesStatusWidget)),this._addCustomWidgetForLayerBlock(0)):null!==this._mainSeriesViewModel&&(this._destroyMainDataSource(),this._destroyCustomWidgetFromLayerBlock(0));const o=[],l=[],n=this._dataSourceViewModels.length;if(0===n)for(let s=e.length-1;s>=0;s--)o.push(new Ne(this._model,e[s],this._dataSourceViewModelsOptions,this._callbacks,this._options.contextMenu)),l.push(new Ai(e[s],this._model.model(),this._options.statusesWidgets));else{let t=0;for(let i=e.length-1;i>=0;i--)this._dataSourceViewModels[t]?(this._dataSourceViewModels[t].updateSource(e[i]),this._dataSourcesStatusesWidgets[t].updateSource(e[i])):(o.push(new Ne(this._model,e[i],this._dataSourceViewModelsOptions,this._callbacks,this._options.contextMenu)),l.push(new Ai(e[i],this._model.model(),this._options.statusesWidgets))),t++;for(;this._dataSourceViewModels.length>t;)Object(s.ensureDefined)(this._dataSourceViewModels.pop()).destroy();for(;this._dataSourcesStatusesWidgets.length>t;)Object(s.ensureDefined)(this._dataSourcesStatusesWidgets.pop()).destroy()}0!==o.length&&(this._renderer.addDataSources(o,l),this._dataSourceViewModels.push(...o),this._dataSourcesStatusesWidgets.push(...l)),n!==this._dataSourceViewModels.length&&this._updateCollapsedSourcesMode(),this._dataSourceViewModels.length>0?this._addCustomWidgetForLayerBlock(1):this._destroyCustomWidgetFromLayerBlock(1),this._recreateSubscriptions(),this._isPaneMain.setValue(this._getIsPaneMainValue()),this.update(),this._updateWidgetModeByWidth()}update(){null!==this._mainSeriesViewModel&&this._mainSeriesViewModel.update();for(const e of this._dataSourceViewModels)e.update()}updateThemedColors(e){null===e&&(e=Object(Gi.getStdThemedValue)("chartProperties.paneProperties.background",this._backgroundThemeName.value())),this._themedColor.setValue(e||"")}firstTitle(){return this._renderer.firstTitle()}getElement(){return this._renderer.getElement()}addMargin(e){if(this._margin===e)return;this._margin=e;this._renderer.getElement().style.maxWidth=0===this._margin?"":`calc(100% - ${this._margin+es}px)`,this._updateWidgetModeBySize()}updateWidgetModeBySize(e){this._size=e,
this._updateWidgetModeBySize()}_updateWidgetModeBySize(){this._updateWidgetModeByWidth(),this._updateWidgetModeByHeight(),this._updateCustomWidgetModeBySize()}_updateWidgetModeByWidth(){null!==this._size&&this._renderer.updateMode(this._availableWidth())}_updateWidgetModeByHeight(){null!==this._size&&(this._availableHeight=Qi*this._size.h,this._updateCollapsedSourcesModeThrottle())}_updateCustomWidgetModeBySize(){if(null===this._size)return;const e=new a.Size(this._availableWidth(),this._size.h);for(const t of Array.from(this._customLegendWidgetsMap.values()))for(const i of Array.from(t.values()))for(const t of i)t.updateWidgetModeBySize(e)}_destroyMainDataSource(){Object(s.ensureNotNull)(this._mainSeriesStatusWidget).destroy(),this._mainSeriesStatusWidget=null,Object(s.ensureNotNull)(this._mainSeriesViewModel).destroy(),this._mainSeriesViewModel=null}_updateCollapsedSourcesMode(){const e=this._dataSourceViewModels.length;if(!this._wrapText.value()&&this._availableHeight>0&&e>2){const t=this._renderer.getMainSourceHeight(),i=this._renderer.getDataSourceHeight(),s=this._getCustomWidgetsHeight();if(null!==t&&null!==i){const o=Math.floor((this._availableHeight-t-s)/i),l=Math.max(o,2)-1;if(e>l+1){let t="";for(let i=0;i<e;i++){const e=i<l;this._dataSourceViewModels[i].setGlobalVisibility(e),e||(t+=`${0===t.length?"":", "}${this._dataSourceViewModels[i].getFullTitle()}`)}return this._collapsedDataSourcesTitle.setValue(t),void this._collapsedDataSourcesCount.setValue(e-l)}}}for(const t of this._dataSourceViewModels)t.setGlobalVisibility(!0);this._collapsedDataSourcesCount.setValue(0),this._collapsedDataSourcesTitle.setValue("")}_getCustomWidgetsHeight(){let e=0;for(const t of Array.from(this._customLegendWidgetsMap.values()))for(const i of Array.from(t.values()))for(const t of i)e+=t.height().value();return e}_getCustomTextColorValue(){const e=this._model.model().properties().scalesProperties.textColor.value();return Object(Gi.isStdThemedDefaultValue)("chartProperties.scalesProperties.textColor",e,Object(Gi.getCurrentTheme)().name)?null:e}_clearSubscriptions(){null!==this._mainSeriesRowHidden&&(this._mainSeriesRowHidden.destroy(),this._mainSeriesRowHidden=null);for(const e of this._dataSourceRowsHidden)e.destroy();this._dataSourceRowsHidden=[];for(const e of this._customWidgetsVisibilities)e.destroy();this._customWidgetsVisibilities=[];for(const e of this._customWidgetsHeights)e.destroy();this._customWidgetsHeights=[]}_recreateSubscriptions(){this._clearSubscriptions(),null!==this._mainSeriesViewModel&&(this._mainSeriesRowHidden=this._mainSeriesViewModel.isRowHidden().spawn(),this._mainSeriesRowHidden.subscribe(this._updateLegendVisibilities.bind(this)));for(const e of this._dataSourceViewModels){const t=e.isRowHidden().spawn();this._dataSourceRowsHidden.push(t),t.subscribe(this._updateVisibleDataSourceCount.bind(this)),t.subscribe(this._updateLegendVisibilities.bind(this))}for(const e of Array.from(this._customLegendWidgetsMap.values()))for(const t of Array.from(e.values()))for(const e of t){const t=e.visibility().spawn()
;this._customWidgetsVisibilities.push(t),t.subscribe(this._updateLegendVisibilities.bind(this));const i=e.height().spawn();this._customWidgetsHeights.push(i),i.subscribe(this._updateCollapsedSourcesMode.bind(this))}this._updateVisibleDataSourceCount(),this._updateLegendVisibilities()}_updateLegendVisibilities(){const e=this._dataSourceRowsHidden.every(e=>e.value()),t=this._hideNotMainSources.value()||e;this._studiesLegendHidden.setValue(t);const i=null===this._mainSeriesRowHidden||this._mainSeriesRowHidden.value(),s=this._customWidgetsVisibilities.some(e=>e.value());this._allLegendHidden.setValue(e&&i&&!s)}_updateVisibleDataSourceCount(){const e=this._dataSourceRowsHidden.filter(e=>!e.value()).length;this._visibleDataSourceCount.setValue(e)}_setLegendVisibilityToggled(){ct.setValue("legend.isVisibilityToggled",!0);this._showLegendOriginalProperty().unsubscribe(this,Object(s.ensureNotNull)(this._onLegendVisibilityToggled))}_getIsPaneMainValue(){return this._paneWidget.containsMainSeries()}_showLegendCalculatedProperty(){return $i?this._model.model().showLegend():this._showLegendOriginalProperty()}_showLegendOriginalProperty(){return this._model.model().properties().paneProperties.legendProperties.showLegend}_addCustomWidgetForLayerBlock(e){const t=this._customLegendWidgetsFactoriesMap.get(e);if(void 0===t)return;const i=this._customLegendWidgetsMap.get(e)||new Map;let s=!1;for(const o of Array.from(t.keys())){const l=i.get(o)||[],n=t.get(o)||[];for(let t=l.length;t<n.length;t++){const i=n[t](this._model.model(),this._backgroundThemeName);0===e&&0===o&&i.setGlobalVisibility(this._hideNotMainSources.opposite()),l.push(i),this._renderer.addCustomWidget(i,{block:e,position:o}),s=!0}s&&i.set(o,l)}s&&this._customLegendWidgetsMap.set(e,i)}_destroyCustomWidgetFromLayerBlock(e){const t=this._customLegendWidgetsMap.get(e);if(void 0!==t){for(const e of Array.from(t.values()))for(const t of e)t.destroy();t.clear(),this._customLegendWidgetsMap.delete(e)}}_availableWidth(){return null===this._size?0:this._size.w-this._margin-es}}},sHQ4:function(e,t,i){e.exports={wrap:"wrap-164vy-kj",positionBottom:"positionBottom-164vy-kj",backdrop:"backdrop-164vy-kj",drawer:"drawer-164vy-kj",positionLeft:"positionLeft-164vy-kj"}},vWJB:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 4" width="16" height="4" fill="none"><circle stroke="currentColor" cx="2" cy="2" r="1.5"/><circle stroke="currentColor" cx="8" cy="2" r="1.5"/><circle stroke="currentColor" cx="14" cy="2" r="1.5"/></svg>'},vYP1:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M8.54.84a.8.8 0 0 1 .92 0l7.5 5.25a.8.8 0 0 1 0 1.32l-7.5 5.25a.8.8 0 0 1-.92 0L1.04 7.4a.8.8 0 0 1 0-1.32L8.54.84zM2.9 6.75L9 11.02l6.1-4.27L9 2.48 2.9 6.75z"/><path fill="currentColor" d="M.84 10.8a.8.8 0 0 1 1.12-.2L9 15.51l7.04-4.93a.8.8 0 0 1 .92 1.32l-7.5 5.25a.8.8 0 0 1-.92 0l-7.5-5.25a.8.8 0 0 1-.2-1.12z"/></svg>'},vg09:function(e,t){
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14" width="14" height="14"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M7 2v10M2 7h10"/></svg>'},wZiV:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 2 30 24" width="30" height="24" fill="none"><circle stroke="currentColor" stroke-width="1.15" cx="8.08" cy="14" r="1.73"/><circle stroke="currentColor" stroke-width="1.15" cx="15" cy="14" r="1.73"/><circle stroke="currentColor" stroke-width="1.15" cx="21.92" cy="14" r="1.73"/></svg>'},xlKU:function(e,t,i){"use strict";i.r(t),i.d(t,"showSignModal",(function(){return o})),i.d(t,"isSignModalOpen",(function(){return l}));let s=()=>!1;async function o(e){const t=await Promise.all([i.e("vendors"),i.e(18),i.e("dialogs-core"),i.e(24),i.e(32),i.e(33),i.e(69),i.e(280),i.e(392),i.e(454),i.e(17),i.e(30),i.e(162),i.e(253),i.e("signin-dialog")]).then(i.bind(null,"oGcn"));return s=t.isSignModalOpen,t.showSignModal(e)}function l(){return s()}},z4c1:function(e,t){
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 22" width="24" height="22" fill="none"><g class="normal-eye"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M17.9948 7.91366C16.6965 6.48549 14.6975 5 11.9999 5C9.30225 5 7.30322 6.48549 6.00488 7.91366C6.00488 7.91366 4 10 4 11C4 12 6.00488 14.0863 6.00488 14.0863C7.30322 15.5145 9.30225 17 11.9999 17C14.6975 17 16.6965 15.5145 17.9948 14.0863C17.9948 14.0863 20 12 20 11C20 10 17.9948 7.91366 17.9948 7.91366ZM6.74482 13.4137C7.94648 14.7355 9.69746 16 11.9999 16C14.3022 16 16.0532 14.7355 17.2549 13.4137C17.2549 13.4137 19 11.5 19 11C19 10.5 17.2549 8.58634 17.2549 8.58634C16.0532 7.26451 14.3022 6 11.9999 6C9.69746 6 7.94648 7.26451 6.74482 8.58634C6.74482 8.58634 5 10.5 5 11C5 11.5 6.74482 13.4137 6.74482 13.4137Z"/><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M12 13C13.1046 13 14 12.1046 14 11C14 9.89543 13.1046 9 12 9C10.8954 9 10 9.89543 10 11C10 12.1046 10.8954 13 12 13ZM12 14C13.6569 14 15 12.6569 15 11C15 9.34315 13.6569 8 12 8C10.3431 8 9 9.34315 9 11C9 12.6569 10.3431 14 12 14Z"/></g><g class="crossed-eye"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M8.8503 16.2712C9.76531 16.7135 10.8152 17 11.9999 17C14.6975 17 16.6965 15.5145 17.9948 14.0863C17.9948 14.0863 20 12 20 11C20 10 17.9948 7.91366 17.9948 7.91366C17.8729 7.77954 17.7448 7.64491 17.6105 7.51105L16.9035 8.2181C17.0254 8.33968 17.1425 8.46276 17.2549 8.58634C17.2549 8.58634 19 10.5 19 11C19 11.5 17.2549 13.4137 17.2549 13.4137C16.0532 14.7355 14.3022 16 11.9999 16C11.1218 16 10.324 15.8161 9.60627 15.5153L8.8503 16.2712ZM7.09663 13.7823C6.97455 13.6606 6.85728 13.5374 6.74482 13.4137C6.74482 13.4137 5 11.5 5 11C5 10.5 6.74482 8.58634 6.74482 8.58634C7.94648 7.26451 9.69746 6 11.9999 6C12.8781 6 13.6761 6.18398 14.394 6.48495L15.1499 5.729C14.2348 5.28657 13.1847 5 11.9999 5C9.30225 5 7.30322 6.48549 6.00488 7.91366C6.00488 7.91366 4 10 4 11C4 12 6.00488 14.0863 6.00488 14.0863C6.12693 14.2206 6.25516 14.3553 6.38959 14.4893L7.09663 13.7823Z"/><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M11.2231 13.8984C11.4709 13.9647 11.7313 14 12 14C13.6569 14 15 12.6569 15 11C15 10.7313 14.9647 10.4709 14.8984 10.2231L13.9961 11.1254C13.934 12.1301 13.1301 12.934 12.1254 12.9961L11.2231 13.8984ZM11.8751 9.00384C10.87 9.06578 10.0658 9.87001 10.0038 10.8751L9.10166 11.7772C9.03535 11.5294 9 11.2688 9 11C9 9.34315 10.3431 8 12 8C12.2688 8 12.5294 8.03535 12.7772 8.10166L11.8751 9.00384Z"/><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M5.64648 16.6465L17.6465 4.64648L18.3536 5.35359L6.35359 17.3536L5.64648 16.6465Z"/></g><g class="loading-eye"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M17.9948 7.91366C16.6965 6.48549 14.6975 5 11.9999 5C9.30225 5 7.30322 6.48549 6.00488 7.91366C6.00488 7.91366 4 10 4 11C4 12 6.00488 14.0863 6.00488 14.0863C7.30322 15.5145 9.30225 17 11.9999 17C14.6975 17 16.6965 15.5145 17.9948 14.0863C17.9948 14.0863 20 12 20 11C20 10 17.9948 7.91366 17.9948 7.91366ZM6.74482 13.4137C7.94648 14.7355 9.69746 16 11.9999 16C14.3022 16 16.0532 14.7355 17.2549 13.4137C17.2549 13.4137 19 11.5 19 11C19 10.5 17.2549 8.58634 17.2549 8.58634C16.0532 7.26451 14.3022 6 11.9999 6C9.69746 6 7.94648 7.26451 6.74482 8.58634C6.74482 8.58634 5 10.5 5 11C5 11.5 6.74482 13.4137 6.74482 13.4137Z"/></g><g class="animated-loading-eye"><path stroke="currentColor" stroke-linecap="round" d="M14.5 11C14.5 9.61929 13.3807 8.5 12 8.5C10.6193 8.5 9.5 9.61929 9.5 11C9.5 12.3807 10.6193 13.5 12 13.5"/></g></svg>'
}}]);